nohup: 忽略输入
srun: job 3522769 queued and waiting for resources
srun: job 3522769 has been allocated resources
srun: Job 3522769 scheduled successfully!
Current QUOTA_TYPE is [reserved], which means the job has occupied quota in RESERVED_TOTAL under your partition.
Current PHX_PRIORITY is normal

/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/launch.py:178: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/launch.py:178: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[W socket.cpp:401] [c10d] The server socket has failed to bind to [::]:8591 (errno: 98 - Address already in use).
/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/launch.py:178: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/launch.py:178: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[W socket.cpp:401] [c10d] The server socket has failed to bind to [::]:8591 (errno: 98 - Address already in use).
[W socket.cpp:401] [c10d] The server socket has failed to bind to [::]:8591 (errno: 98 - Address already in use).
[W socket.cpp:401] [c10d] The server socket has failed to bind to 0.0.0.0:8591 (errno: 98 - Address already in use).
[E socket.cpp:435] [c10d] The server socket has failed to listen on any local network address.
[W socket.cpp:401] [c10d] The server socket has failed to bind to 0.0.0.0:8591 (errno: 98 - Address already in use).
[E socket.cpp:435] [c10d] The server socket has failed to listen on any local network address.
[W socket.cpp:401] [c10d] The server socket has failed to bind to 0.0.0.0:8591 (errno: 98 - Address already in use).
[E socket.cpp:435] [c10d] The server socket has failed to listen on any local network address.
Traceback (most recent call last):
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/launch.py", line 193, in <module>
    main()
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/launch.py", line 189, in main
    launch(args)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/launch.py", line 174, in launch
    run(args)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 236, in launch_agent
    result = agent.run()
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/metrics/api.py", line 125, in wrapper
    result = f(*args, **kwargs)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/agent/server/api.py", line 709, in run
    result = self._invoke_run(role)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/agent/server/api.py", line 844, in _invoke_run
    self._initialize_workers(self._worker_group)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/metrics/api.py", line 125, in wrapper
    result = f(*args, **kwargs)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/agent/server/api.py", line 678, in _initialize_workers
    self._rendezvous(worker_group)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/metrics/api.py", line 125, in wrapper
    result = f(*args, **kwargs)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/agent/server/api.py", line 538, in _rendezvous
    store, group_rank, group_world_size = spec.rdzv_handler.next_rendezvous()
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/rendezvous/static_tcp_rendezvous.py", line 55, in next_rendezvous
    self._store = TCPStore(  # type: ignore[call-arg]
RuntimeError: The server socket has failed to listen on any local network address. The server socket has failed to bind to [::]:8591 (errno: 98 - Address already in use). The server socket has failed to bind to 0.0.0.0:8591 (errno: 98 - Address already in use).
Traceback (most recent call last):
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/launch.py", line 193, in <module>
    main()
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/launch.py", line 189, in main
    launch(args)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/launch.py", line 174, in launch
    run(args)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 236, in launch_agent
    result = agent.run()
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/metrics/api.py", line 125, in wrapper
    result = f(*args, **kwargs)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/agent/server/api.py", line 709, in run
    result = self._invoke_run(role)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/agent/server/api.py", line 844, in _invoke_run
    self._initialize_workers(self._worker_group)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/metrics/api.py", line 125, in wrapper
    result = f(*args, **kwargs)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/agent/server/api.py", line 678, in _initialize_workers
    self._rendezvous(worker_group)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/metrics/api.py", line 125, in wrapper
    result = f(*args, **kwargs)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/agent/server/api.py", line 538, in _rendezvous
    store, group_rank, group_world_size = spec.rdzv_handler.next_rendezvous()
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/rendezvous/static_tcp_rendezvous.py", line 55, in next_rendezvous
    self._store = TCPStore(  # type: ignore[call-arg]
RuntimeError: The server socket has failed to listen on any local network address. The server socket has failed to bind to [::]:8591 (errno: 98 - Address already in use). The server socket has failed to bind to 0.0.0.0:8591 (errno: 98 - Address already in use).
Traceback (most recent call last):
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/launch.py", line 193, in <module>
    main()
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/launch.py", line 189, in main
    launch(args)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/launch.py", line 174, in launch
    run(args)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 236, in launch_agent
    result = agent.run()
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/metrics/api.py", line 125, in wrapper
    result = f(*args, **kwargs)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/agent/server/api.py", line 709, in run
    result = self._invoke_run(role)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/agent/server/api.py", line 844, in _invoke_run
    self._initialize_workers(self._worker_group)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/metrics/api.py", line 125, in wrapper
    result = f(*args, **kwargs)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/agent/server/api.py", line 678, in _initialize_workers
    self._rendezvous(worker_group)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/metrics/api.py", line 125, in wrapper
    result = f(*args, **kwargs)
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/agent/server/api.py", line 538, in _rendezvous
    store, group_rank, group_world_size = spec.rdzv_handler.next_rendezvous()
  File "/mnt/petrelfs/lijiaxing1/anaconda3/envs/control/lib/python3.8/site-packages/torch/distributed/elastic/rendezvous/static_tcp_rendezvous.py", line 55, in next_rendezvous
    self._store = TCPStore(  # type: ignore[call-arg]
RuntimeError: The server socket has failed to listen on any local network address. The server socket has failed to bind to [::]:8591 (errno: 98 - Address already in use). The server socket has failed to bind to 0.0.0.0:8591 (errno: 98 - Address already in use).
srun: error: SH-IDC1-10-140-24-30: tasks 0-2: Exited with exit code 1
Loading vision model config from cn_clip/clip/model_configs/ViT-H-14.json
Loading text model config from cn_clip/clip/model_configs/RoBERTa-wwm-ext-large-chinese.json
Loading vision model config from cn_clip/clip/model_configs/ViT-H-14.json
Loading text model config from cn_clip/clip/model_configs/RoBERTa-wwm-ext-large-chinese.json
Loading vision model config from cn_clip/clip/model_configs/ViT-H-14.json
Loading text model config from cn_clip/clip/model_configs/RoBERTa-wwm-ext-large-chinese.json
Loading vision model config from cn_clip/clip/model_configs/ViT-H-14.json
Loading text model config from cn_clip/clip/model_configs/RoBERTa-wwm-ext-large-chinese.json
2024-06-01,20:24:06 | INFO | Rank 3 | train LMDB file contains 129380 images and 250314 pairs.
2024-06-01,20:24:06 | INFO | Rank 0 | train LMDB file contains 129380 images and 250314 pairs.
2024-06-01,20:24:06 | INFO | Rank 1 | train LMDB file contains 129380 images and 250314 pairs.
2024-06-01,20:24:06 | INFO | Rank 2 | train LMDB file contains 129380 images and 250314 pairs.
2024-06-01,20:24:06 | INFO | Rank 1 | val LMDB file contains 29806 images and 30588 pairs.
2024-06-01,20:24:06 | INFO | Rank 1 | Use GPU: 1 for training
2024-06-01,20:24:06 | INFO | Rank 3 | val LMDB file contains 29806 images and 30588 pairs.
2024-06-01,20:24:06 | INFO | Rank 3 | Use GPU: 3 for training
2024-06-01,20:24:06 | INFO | Rank 1 | => begin to load checkpoint '/mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/epoch1.pt'
2024-06-01,20:24:06 | INFO | Rank 3 | => begin to load checkpoint '/mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/epoch1.pt'
2024-06-01,20:24:06 | INFO | Rank 0 | val LMDB file contains 29806 images and 30588 pairs.
2024-06-01,20:24:06 | INFO | Rank 0 | Params:
2024-06-01,20:24:06 | INFO | Rank 2 | val LMDB file contains 29806 images and 30588 pairs.
2024-06-01,20:24:06 | INFO | Rank 2 | Use GPU: 2 for training
2024-06-01,20:24:06 | INFO | Rank 2 | => begin to load checkpoint '/mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/epoch1.pt'
2024-06-01,20:24:06 | INFO | Rank 0 |   accum_freq: 1
2024-06-01,20:24:06 | INFO | Rank 0 |   aggregate: True
2024-06-01,20:24:06 | INFO | Rank 0 |   batch_size: 64
2024-06-01,20:24:06 | INFO | Rank 0 |   bert_weight_path: None
2024-06-01,20:24:06 | INFO | Rank 0 |   beta1: 0.9
2024-06-01,20:24:06 | INFO | Rank 0 |   beta2: 0.98
2024-06-01,20:24:06 | INFO | Rank 0 |   checkpoint_path: /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints
2024-06-01,20:24:06 | INFO | Rank 0 |   clip_weight_path: None
2024-06-01,20:24:06 | INFO | Rank 0 |   context_length: 52
2024-06-01,20:24:06 | INFO | Rank 0 |   debug: False
2024-06-01,20:24:06 | INFO | Rank 0 |   device: cuda:0
2024-06-01,20:24:06 | INFO | Rank 0 |   distllation: False
2024-06-01,20:24:06 | INFO | Rank 0 |   eps: 1e-06
2024-06-01,20:24:06 | INFO | Rank 0 |   freeze_vision: False
2024-06-01,20:24:06 | INFO | Rank 0 |   gather_with_grad: False
2024-06-01,20:24:06 | INFO | Rank 0 |   grad_checkpointing: False
2024-06-01,20:24:06 | INFO | Rank 0 |   kd_loss_weight: 0.5
2024-06-01,20:24:06 | INFO | Rank 0 |   local_device_rank: 0
2024-06-01,20:24:06 | INFO | Rank 0 |   log_interval: 10
2024-06-01,20:24:06 | INFO | Rank 0 |   log_level: 20
2024-06-01,20:24:06 | INFO | Rank 0 |   log_path: /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/out_2024-06-01-12-23-55.log
2024-06-01,20:24:06 | INFO | Rank 0 |   logs: /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/
2024-06-01,20:24:06 | INFO | Rank 0 |   lr: 2e-06
2024-06-01,20:24:06 | INFO | Rank 0 |   mask_ratio: 0.25
2024-06-01,20:24:06 | INFO | Rank 0 |   max_epochs: 10
2024-06-01,20:24:06 | INFO | Rank 0 |   max_steps: 9780
2024-06-01,20:24:06 | INFO | Rank 0 |   name: li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu
2024-06-01,20:24:06 | INFO | Rank 0 |   num_workers: 4
2024-06-01,20:24:06 | INFO | Rank 0 |   precision: amp
2024-06-01,20:24:06 | INFO | Rank 0 |   rank: 0
2024-06-01,20:24:06 | INFO | Rank 0 |   report_training_batch_acc: True
2024-06-01,20:24:06 | INFO | Rank 0 |   reset_data_offset: True
2024-06-01,20:24:06 | INFO | Rank 0 |   reset_optimizer: True
2024-06-01,20:24:06 | INFO | Rank 0 |   resume: /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/epoch1.pt
2024-06-01,20:24:06 | INFO | Rank 0 |   save_epoch_frequency: 1
2024-06-01,20:24:06 | INFO | Rank 0 |   save_step_frequency: 999999
2024-06-01,20:24:06 | INFO | Rank 0 |   seed: 123
2024-06-01,20:24:06 | INFO | Rank 0 |   skip_aggregate: False
2024-06-01,20:24:06 | INFO | Rank 0 |   skip_scheduler: False
2024-06-01,20:24:06 | INFO | Rank 0 |   teacher_model_name: None
2024-06-01,20:24:06 | INFO | Rank 0 |   text_model: RoBERTa-wwm-ext-large-chinese
2024-06-01,20:24:06 | INFO | Rank 0 |   train_data: /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/datasets/Multimodal_Retrieval/lmdb/train
2024-06-01,20:24:06 | INFO | Rank 0 |   use_augment: True
2024-06-01,20:24:06 | INFO | Rank 0 |   use_bn_sync: False
2024-06-01,20:24:06 | INFO | Rank 0 |   use_flash_attention: False
2024-06-01,20:24:06 | INFO | Rank 0 |   val_data: /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/datasets/Multimodal_Retrieval/lmdb/valid
2024-06-01,20:24:06 | INFO | Rank 0 |   valid_batch_size: 64
2024-06-01,20:24:06 | INFO | Rank 0 |   valid_epoch_interval: 1
2024-06-01,20:24:06 | INFO | Rank 0 |   valid_num_workers: 1
2024-06-01,20:24:06 | INFO | Rank 0 |   valid_step_interval: 100
2024-06-01,20:24:06 | INFO | Rank 0 |   vision_model: ViT-H-14
2024-06-01,20:24:06 | INFO | Rank 0 |   warmup: 100
2024-06-01,20:24:06 | INFO | Rank 0 |   wd: 0.001
2024-06-01,20:24:06 | INFO | Rank 0 |   world_size: 4
2024-06-01,20:24:06 | INFO | Rank 0 | Use GPU: 0 for training
2024-06-01,20:24:06 | INFO | Rank 0 | => begin to load checkpoint '/mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/epoch1.pt'
2024-06-01,20:24:22 | INFO | Rank 2 | => loaded checkpoint '/mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/epoch1.pt' (epoch 1 @ 0 steps)
2024-06-01,20:24:22 | INFO | Rank 2 | Start epoch 1
2024-06-01,20:24:22 | INFO | Rank 1 | => loaded checkpoint '/mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/epoch1.pt' (epoch 1 @ 0 steps)
2024-06-01,20:24:22 | INFO | Rank 1 | Start epoch 1
2024-06-01,20:24:23 | INFO | Rank 0 | => loaded checkpoint '/mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/epoch1.pt' (epoch 1 @ 0 steps)
2024-06-01,20:24:23 | INFO | Rank 3 | => loaded checkpoint '/mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/epoch1.pt' (epoch 1 @ 0 steps)
2024-06-01,20:24:23 | INFO | Rank 3 | Start epoch 1
2024-06-01,20:24:29 | INFO | Rank 0 | Reducer buckets have been rebuilt in this iteration.
2024-06-01,20:24:29 | INFO | Rank 1 | Reducer buckets have been rebuilt in this iteration.
2024-06-01,20:24:29 | INFO | Rank 2 | Reducer buckets have been rebuilt in this iteration.
2024-06-01,20:24:29 | INFO | Rank 3 | Reducer buckets have been rebuilt in this iteration.
2024-06-01,20:24:38 | INFO | Rank 0 | Global Steps: 10/9780 | Train Epoch: 1 [2560/250368 (1%)] | Loss: 0.631536 | Image2Text Acc: 80.47 | Text2Image Acc: 79.69 | Data Time: 0.025s | Batch Time: 0.906s | LR: 0.000000 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:24:47 | INFO | Rank 0 | Global Steps: 20/9780 | Train Epoch: 1 [5120/250368 (2%)] | Loss: 0.677368 | Image2Text Acc: 76.95 | Text2Image Acc: 82.03 | Data Time: 0.024s | Batch Time: 0.910s | LR: 0.000000 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:24:56 | INFO | Rank 0 | Global Steps: 30/9780 | Train Epoch: 1 [7680/250368 (3%)] | Loss: 0.516080 | Image2Text Acc: 85.94 | Text2Image Acc: 83.20 | Data Time: 0.026s | Batch Time: 0.899s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:25:05 | INFO | Rank 0 | Global Steps: 40/9780 | Train Epoch: 1 [10240/250368 (4%)] | Loss: 0.663923 | Image2Text Acc: 80.86 | Text2Image Acc: 82.42 | Data Time: 0.027s | Batch Time: 0.902s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:25:14 | INFO | Rank 0 | Global Steps: 50/9780 | Train Epoch: 1 [12800/250368 (5%)] | Loss: 0.603297 | Image2Text Acc: 83.59 | Text2Image Acc: 81.64 | Data Time: 0.026s | Batch Time: 0.913s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:25:23 | INFO | Rank 0 | Global Steps: 60/9780 | Train Epoch: 1 [15360/250368 (6%)] | Loss: 0.534754 | Image2Text Acc: 85.55 | Text2Image Acc: 86.33 | Data Time: 0.026s | Batch Time: 0.906s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:25:32 | INFO | Rank 0 | Global Steps: 70/9780 | Train Epoch: 1 [17920/250368 (7%)] | Loss: 0.532816 | Image2Text Acc: 85.94 | Text2Image Acc: 86.33 | Data Time: 0.026s | Batch Time: 0.897s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:25:41 | INFO | Rank 0 | Global Steps: 80/9780 | Train Epoch: 1 [20480/250368 (8%)] | Loss: 0.498834 | Image2Text Acc: 85.16 | Text2Image Acc: 85.55 | Data Time: 0.024s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:25:50 | INFO | Rank 0 | Global Steps: 90/9780 | Train Epoch: 1 [23040/250368 (9%)] | Loss: 0.534076 | Image2Text Acc: 84.38 | Text2Image Acc: 84.38 | Data Time: 0.030s | Batch Time: 0.914s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:25:59 | INFO | Rank 2 | Begin to eval on validation set (epoch 1 @ 100 steps)...
2024-06-01,20:25:59 | INFO | Rank 3 | Begin to eval on validation set (epoch 1 @ 100 steps)...
2024-06-01,20:25:59 | INFO | Rank 1 | Begin to eval on validation set (epoch 1 @ 100 steps)...
2024-06-01,20:25:59 | INFO | Rank 0 | Global Steps: 100/9780 | Train Epoch: 1 [25600/250368 (10%)] | Loss: 0.459642 | Image2Text Acc: 84.38 | Text2Image Acc: 85.55 | Data Time: 0.026s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:25:59 | INFO | Rank 0 | Begin to eval on validation set (epoch 1 @ 100 steps)...
2024-06-01,20:28:25 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,20:28:25 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,20:28:25 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,20:28:26 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,20:28:55 | INFO | Rank 3 | Validation Result (epoch 1 @ 100 steps) | Valid Loss: 0.185202 | Image2Text Acc: 94.42 | Text2Image Acc: 93.86 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,20:28:55 | INFO | Rank 2 | Validation Result (epoch 1 @ 100 steps) | Valid Loss: 0.185202 | Image2Text Acc: 94.42 | Text2Image Acc: 93.86 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,20:28:55 | INFO | Rank 1 | Validation Result (epoch 1 @ 100 steps) | Valid Loss: 0.185202 | Image2Text Acc: 94.42 | Text2Image Acc: 93.86 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,20:28:55 | INFO | Rank 0 | Validation Result (epoch 1 @ 100 steps) | Valid Loss: 0.185202 | Image2Text Acc: 94.42 | Text2Image Acc: 93.86 | logit_scale: 4.605 | Valid Batch Size: 64
0.1852019727230072 0.2
0.1852019727230072 0.2
0.1852019727230072 0.2
0.1852019727230072 0.2
2024-06-01,20:30:40 | INFO | Rank 0 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 99 steps)
2024-06-01,20:30:41 | INFO | Rank 2 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 99 steps)
2024-06-01,20:30:41 | INFO | Rank 1 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 99 steps)
2024-06-01,20:30:42 | INFO | Rank 3 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 99 steps)
2024-06-01,20:30:51 | INFO | Rank 0 | Global Steps: 110/9780 | Train Epoch: 1 [28160/250368 (11%)] | Loss: 0.676488 | Image2Text Acc: 77.34 | Text2Image Acc: 79.69 | Data Time: 0.026s | Batch Time: 0.902s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:31:00 | INFO | Rank 0 | Global Steps: 120/9780 | Train Epoch: 1 [30720/250368 (12%)] | Loss: 0.503198 | Image2Text Acc: 86.72 | Text2Image Acc: 83.20 | Data Time: 0.039s | Batch Time: 0.916s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:31:09 | INFO | Rank 0 | Global Steps: 130/9780 | Train Epoch: 1 [33280/250368 (13%)] | Loss: 0.599263 | Image2Text Acc: 82.03 | Text2Image Acc: 82.42 | Data Time: 0.025s | Batch Time: 0.916s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:31:18 | INFO | Rank 0 | Global Steps: 140/9780 | Train Epoch: 1 [35840/250368 (14%)] | Loss: 0.562015 | Image2Text Acc: 84.77 | Text2Image Acc: 83.20 | Data Time: 0.025s | Batch Time: 0.916s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:31:28 | INFO | Rank 0 | Global Steps: 150/9780 | Train Epoch: 1 [38400/250368 (15%)] | Loss: 0.654527 | Image2Text Acc: 82.81 | Text2Image Acc: 82.42 | Data Time: 0.025s | Batch Time: 0.902s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:31:37 | INFO | Rank 0 | Global Steps: 160/9780 | Train Epoch: 1 [40960/250368 (16%)] | Loss: 0.493701 | Image2Text Acc: 86.33 | Text2Image Acc: 85.55 | Data Time: 0.026s | Batch Time: 0.914s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:31:46 | INFO | Rank 0 | Global Steps: 170/9780 | Train Epoch: 1 [43520/250368 (17%)] | Loss: 0.403364 | Image2Text Acc: 88.67 | Text2Image Acc: 85.94 | Data Time: 0.024s | Batch Time: 0.907s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:31:55 | INFO | Rank 0 | Global Steps: 180/9780 | Train Epoch: 1 [46080/250368 (18%)] | Loss: 0.570700 | Image2Text Acc: 83.98 | Text2Image Acc: 84.38 | Data Time: 0.030s | Batch Time: 0.907s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:32:04 | INFO | Rank 0 | Global Steps: 190/9780 | Train Epoch: 1 [48640/250368 (19%)] | Loss: 0.510667 | Image2Text Acc: 87.11 | Text2Image Acc: 87.11 | Data Time: 0.025s | Batch Time: 0.932s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:32:13 | INFO | Rank 2 | Begin to eval on validation set (epoch 1 @ 200 steps)...
2024-06-01,20:32:13 | INFO | Rank 3 | Begin to eval on validation set (epoch 1 @ 200 steps)...
2024-06-01,20:32:13 | INFO | Rank 1 | Begin to eval on validation set (epoch 1 @ 200 steps)...
2024-06-01,20:32:13 | INFO | Rank 0 | Global Steps: 200/9780 | Train Epoch: 1 [51200/250368 (20%)] | Loss: 0.580708 | Image2Text Acc: 81.25 | Text2Image Acc: 81.25 | Data Time: 0.041s | Batch Time: 0.922s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:32:13 | INFO | Rank 0 | Begin to eval on validation set (epoch 1 @ 200 steps)...
2024-06-01,20:34:38 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,20:34:38 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,20:34:38 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,20:34:39 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,20:35:08 | INFO | Rank 2 | Validation Result (epoch 1 @ 200 steps) | Valid Loss: 0.187016 | Image2Text Acc: 94.42 | Text2Image Acc: 93.83 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,20:35:08 | INFO | Rank 1 | Validation Result (epoch 1 @ 200 steps) | Valid Loss: 0.187016 | Image2Text Acc: 94.42 | Text2Image Acc: 93.83 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,20:35:08 | INFO | Rank 3 | Validation Result (epoch 1 @ 200 steps) | Valid Loss: 0.187016 | Image2Text Acc: 94.42 | Text2Image Acc: 93.83 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,20:35:08 | INFO | Rank 0 | Validation Result (epoch 1 @ 200 steps) | Valid Loss: 0.187016 | Image2Text Acc: 94.42 | Text2Image Acc: 93.83 | logit_scale: 4.605 | Valid Batch Size: 64
0.18701587617397308 0.1852019727230072
0.18701587617397308 0.1852019727230072
0.18701587617397308 0.1852019727230072
0.18701587617397308 0.1852019727230072
2024-06-01,20:35:18 | INFO | Rank 0 | Global Steps: 210/9780 | Train Epoch: 1 [53760/250368 (21%)] | Loss: 0.652169 | Image2Text Acc: 80.47 | Text2Image Acc: 78.91 | Data Time: 0.028s | Batch Time: 0.908s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:35:27 | INFO | Rank 0 | Global Steps: 220/9780 | Train Epoch: 1 [56320/250368 (22%)] | Loss: 0.429597 | Image2Text Acc: 87.50 | Text2Image Acc: 85.94 | Data Time: 0.028s | Batch Time: 0.917s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:35:36 | INFO | Rank 0 | Global Steps: 230/9780 | Train Epoch: 1 [58880/250368 (24%)] | Loss: 0.562848 | Image2Text Acc: 80.86 | Text2Image Acc: 85.16 | Data Time: 0.034s | Batch Time: 0.913s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:35:45 | INFO | Rank 0 | Global Steps: 240/9780 | Train Epoch: 1 [61440/250368 (25%)] | Loss: 0.621519 | Image2Text Acc: 82.03 | Text2Image Acc: 83.98 | Data Time: 0.024s | Batch Time: 0.932s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:35:54 | INFO | Rank 0 | Global Steps: 250/9780 | Train Epoch: 1 [64000/250368 (26%)] | Loss: 0.464858 | Image2Text Acc: 85.94 | Text2Image Acc: 86.33 | Data Time: 0.027s | Batch Time: 0.907s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:36:03 | INFO | Rank 0 | Global Steps: 260/9780 | Train Epoch: 1 [66560/250368 (27%)] | Loss: 0.552727 | Image2Text Acc: 85.94 | Text2Image Acc: 86.33 | Data Time: 0.027s | Batch Time: 0.908s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:36:12 | INFO | Rank 0 | Global Steps: 270/9780 | Train Epoch: 1 [69120/250368 (28%)] | Loss: 0.485418 | Image2Text Acc: 84.77 | Text2Image Acc: 84.77 | Data Time: 0.025s | Batch Time: 0.909s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:36:21 | INFO | Rank 0 | Global Steps: 280/9780 | Train Epoch: 1 [71680/250368 (29%)] | Loss: 0.482596 | Image2Text Acc: 86.33 | Text2Image Acc: 87.11 | Data Time: 0.025s | Batch Time: 0.914s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:36:31 | INFO | Rank 0 | Global Steps: 290/9780 | Train Epoch: 1 [74240/250368 (30%)] | Loss: 0.600099 | Image2Text Acc: 83.59 | Text2Image Acc: 83.20 | Data Time: 0.028s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:36:40 | INFO | Rank 1 | Begin to eval on validation set (epoch 1 @ 300 steps)...
2024-06-01,20:36:40 | INFO | Rank 2 | Begin to eval on validation set (epoch 1 @ 300 steps)...
2024-06-01,20:36:40 | INFO | Rank 3 | Begin to eval on validation set (epoch 1 @ 300 steps)...
2024-06-01,20:36:40 | INFO | Rank 0 | Global Steps: 300/9780 | Train Epoch: 1 [76800/250368 (31%)] | Loss: 0.627864 | Image2Text Acc: 80.86 | Text2Image Acc: 83.20 | Data Time: 0.024s | Batch Time: 0.921s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:36:40 | INFO | Rank 0 | Begin to eval on validation set (epoch 1 @ 300 steps)...
2024-06-01,20:39:05 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,20:39:05 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,20:39:05 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,20:39:06 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,20:39:35 | INFO | Rank 1 | Validation Result (epoch 1 @ 300 steps) | Valid Loss: 0.185550 | Image2Text Acc: 94.42 | Text2Image Acc: 93.92 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,20:39:35 | INFO | Rank 3 | Validation Result (epoch 1 @ 300 steps) | Valid Loss: 0.185550 | Image2Text Acc: 94.42 | Text2Image Acc: 93.92 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,20:39:35 | INFO | Rank 2 | Validation Result (epoch 1 @ 300 steps) | Valid Loss: 0.185550 | Image2Text Acc: 94.42 | Text2Image Acc: 93.92 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,20:39:35 | INFO | Rank 0 | Validation Result (epoch 1 @ 300 steps) | Valid Loss: 0.185550 | Image2Text Acc: 94.42 | Text2Image Acc: 93.92 | logit_scale: 4.605 | Valid Batch Size: 64
0.18555034697055817 0.1852019727230072
0.18555034697055817 0.1852019727230072
0.18555034697055817 0.1852019727230072
0.18555034697055817 0.1852019727230072
2024-06-01,20:39:44 | INFO | Rank 0 | Global Steps: 310/9780 | Train Epoch: 1 [79360/250368 (32%)] | Loss: 0.475948 | Image2Text Acc: 87.11 | Text2Image Acc: 88.28 | Data Time: 0.027s | Batch Time: 0.907s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:39:54 | INFO | Rank 0 | Global Steps: 320/9780 | Train Epoch: 1 [81920/250368 (33%)] | Loss: 0.587594 | Image2Text Acc: 82.81 | Text2Image Acc: 81.64 | Data Time: 0.027s | Batch Time: 0.915s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:40:03 | INFO | Rank 0 | Global Steps: 330/9780 | Train Epoch: 1 [84480/250368 (34%)] | Loss: 0.567726 | Image2Text Acc: 85.16 | Text2Image Acc: 84.77 | Data Time: 0.028s | Batch Time: 0.904s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:40:12 | INFO | Rank 0 | Global Steps: 340/9780 | Train Epoch: 1 [87040/250368 (35%)] | Loss: 0.612829 | Image2Text Acc: 83.98 | Text2Image Acc: 82.03 | Data Time: 0.029s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:40:21 | INFO | Rank 0 | Global Steps: 350/9780 | Train Epoch: 1 [89600/250368 (36%)] | Loss: 0.689200 | Image2Text Acc: 81.25 | Text2Image Acc: 82.42 | Data Time: 0.026s | Batch Time: 0.914s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:40:30 | INFO | Rank 0 | Global Steps: 360/9780 | Train Epoch: 1 [92160/250368 (37%)] | Loss: 0.673655 | Image2Text Acc: 77.34 | Text2Image Acc: 80.08 | Data Time: 0.026s | Batch Time: 0.918s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:40:39 | INFO | Rank 0 | Global Steps: 370/9780 | Train Epoch: 1 [94720/250368 (38%)] | Loss: 0.460394 | Image2Text Acc: 85.16 | Text2Image Acc: 84.77 | Data Time: 0.027s | Batch Time: 0.902s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:40:48 | INFO | Rank 0 | Global Steps: 380/9780 | Train Epoch: 1 [97280/250368 (39%)] | Loss: 0.584953 | Image2Text Acc: 81.25 | Text2Image Acc: 81.64 | Data Time: 0.029s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:40:57 | INFO | Rank 0 | Global Steps: 390/9780 | Train Epoch: 1 [99840/250368 (40%)] | Loss: 0.526567 | Image2Text Acc: 84.77 | Text2Image Acc: 83.59 | Data Time: 0.030s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:41:06 | INFO | Rank 2 | Begin to eval on validation set (epoch 1 @ 400 steps)...
2024-06-01,20:41:06 | INFO | Rank 3 | Begin to eval on validation set (epoch 1 @ 400 steps)...
2024-06-01,20:41:06 | INFO | Rank 1 | Begin to eval on validation set (epoch 1 @ 400 steps)...
2024-06-01,20:41:06 | INFO | Rank 0 | Global Steps: 400/9780 | Train Epoch: 1 [102400/250368 (41%)] | Loss: 0.520913 | Image2Text Acc: 83.98 | Text2Image Acc: 85.55 | Data Time: 0.026s | Batch Time: 0.913s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:41:06 | INFO | Rank 0 | Begin to eval on validation set (epoch 1 @ 400 steps)...
2024-06-01,20:43:31 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,20:43:32 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,20:43:32 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,20:43:32 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,20:44:02 | INFO | Rank 3 | Validation Result (epoch 1 @ 400 steps) | Valid Loss: 0.184887 | Image2Text Acc: 94.51 | Text2Image Acc: 93.95 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,20:44:02 | INFO | Rank 1 | Validation Result (epoch 1 @ 400 steps) | Valid Loss: 0.184887 | Image2Text Acc: 94.51 | Text2Image Acc: 93.95 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,20:44:02 | INFO | Rank 2 | Validation Result (epoch 1 @ 400 steps) | Valid Loss: 0.184887 | Image2Text Acc: 94.51 | Text2Image Acc: 93.95 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,20:44:02 | INFO | Rank 0 | Validation Result (epoch 1 @ 400 steps) | Valid Loss: 0.184887 | Image2Text Acc: 94.51 | Text2Image Acc: 93.95 | logit_scale: 4.605 | Valid Batch Size: 64
0.18488726019859314 0.1852019727230072
0.18488726019859314 0.1852019727230072
0.18488726019859314 0.1852019727230072
0.18488726019859314 0.1852019727230072
2024-06-01,20:45:46 | INFO | Rank 0 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 399 steps)
2024-06-01,20:45:46 | INFO | Rank 2 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 399 steps)
2024-06-01,20:45:47 | INFO | Rank 1 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 399 steps)
2024-06-01,20:45:48 | INFO | Rank 3 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 399 steps)
2024-06-01,20:45:57 | INFO | Rank 0 | Global Steps: 410/9780 | Train Epoch: 1 [104960/250368 (42%)] | Loss: 0.558013 | Image2Text Acc: 86.33 | Text2Image Acc: 86.33 | Data Time: 0.036s | Batch Time: 0.935s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:46:06 | INFO | Rank 0 | Global Steps: 420/9780 | Train Epoch: 1 [107520/250368 (43%)] | Loss: 0.630176 | Image2Text Acc: 81.25 | Text2Image Acc: 82.42 | Data Time: 0.024s | Batch Time: 0.921s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:46:15 | INFO | Rank 0 | Global Steps: 430/9780 | Train Epoch: 1 [110080/250368 (44%)] | Loss: 0.546727 | Image2Text Acc: 82.81 | Text2Image Acc: 84.38 | Data Time: 0.028s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:46:24 | INFO | Rank 0 | Global Steps: 440/9780 | Train Epoch: 1 [112640/250368 (45%)] | Loss: 0.693212 | Image2Text Acc: 76.95 | Text2Image Acc: 81.25 | Data Time: 0.034s | Batch Time: 0.915s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:46:34 | INFO | Rank 0 | Global Steps: 450/9780 | Train Epoch: 1 [115200/250368 (46%)] | Loss: 0.473474 | Image2Text Acc: 84.38 | Text2Image Acc: 85.94 | Data Time: 0.037s | Batch Time: 0.916s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:46:43 | INFO | Rank 0 | Global Steps: 460/9780 | Train Epoch: 1 [117760/250368 (47%)] | Loss: 0.444493 | Image2Text Acc: 85.94 | Text2Image Acc: 87.89 | Data Time: 0.031s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:46:52 | INFO | Rank 0 | Global Steps: 470/9780 | Train Epoch: 1 [120320/250368 (48%)] | Loss: 0.508903 | Image2Text Acc: 83.59 | Text2Image Acc: 81.25 | Data Time: 0.044s | Batch Time: 0.929s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:47:01 | INFO | Rank 0 | Global Steps: 480/9780 | Train Epoch: 1 [122880/250368 (49%)] | Loss: 0.520567 | Image2Text Acc: 85.55 | Text2Image Acc: 83.98 | Data Time: 0.025s | Batch Time: 0.923s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:47:10 | INFO | Rank 0 | Global Steps: 490/9780 | Train Epoch: 1 [125440/250368 (50%)] | Loss: 0.528310 | Image2Text Acc: 84.38 | Text2Image Acc: 83.20 | Data Time: 0.035s | Batch Time: 0.913s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:47:19 | INFO | Rank 3 | Begin to eval on validation set (epoch 1 @ 500 steps)...
2024-06-01,20:47:19 | INFO | Rank 2 | Begin to eval on validation set (epoch 1 @ 500 steps)...
2024-06-01,20:47:19 | INFO | Rank 1 | Begin to eval on validation set (epoch 1 @ 500 steps)...
2024-06-01,20:47:19 | INFO | Rank 0 | Global Steps: 500/9780 | Train Epoch: 1 [128000/250368 (51%)] | Loss: 0.584270 | Image2Text Acc: 82.03 | Text2Image Acc: 81.64 | Data Time: 0.024s | Batch Time: 0.907s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:47:19 | INFO | Rank 0 | Begin to eval on validation set (epoch 1 @ 500 steps)...
2024-06-01,20:49:44 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,20:49:45 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,20:49:45 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,20:49:45 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,20:50:15 | INFO | Rank 3 | Validation Result (epoch 1 @ 500 steps) | Valid Loss: 0.184854 | Image2Text Acc: 94.48 | Text2Image Acc: 93.85 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,20:50:15 | INFO | Rank 2 | Validation Result (epoch 1 @ 500 steps) | Valid Loss: 0.184854 | Image2Text Acc: 94.48 | Text2Image Acc: 93.85 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,20:50:15 | INFO | Rank 1 | Validation Result (epoch 1 @ 500 steps) | Valid Loss: 0.184854 | Image2Text Acc: 94.48 | Text2Image Acc: 93.85 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,20:50:15 | INFO | Rank 0 | Validation Result (epoch 1 @ 500 steps) | Valid Loss: 0.184854 | Image2Text Acc: 94.48 | Text2Image Acc: 93.85 | logit_scale: 4.605 | Valid Batch Size: 64
0.18485401570796967 0.18488726019859314
0.18485401570796967 0.18488726019859314
0.18485401570796967 0.18488726019859314
0.18485401570796967 0.18488726019859314
2024-06-01,20:52:02 | INFO | Rank 3 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 499 steps)
2024-06-01,20:52:03 | INFO | Rank 2 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 499 steps)
2024-06-01,20:52:03 | INFO | Rank 1 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 499 steps)
2024-06-01,20:52:03 | INFO | Rank 0 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 499 steps)
2024-06-01,20:52:12 | INFO | Rank 0 | Global Steps: 510/9780 | Train Epoch: 1 [130560/250368 (52%)] | Loss: 0.468477 | Image2Text Acc: 86.72 | Text2Image Acc: 83.59 | Data Time: 0.030s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:52:21 | INFO | Rank 0 | Global Steps: 520/9780 | Train Epoch: 1 [133120/250368 (53%)] | Loss: 0.459503 | Image2Text Acc: 86.33 | Text2Image Acc: 86.33 | Data Time: 0.030s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:52:31 | INFO | Rank 0 | Global Steps: 530/9780 | Train Epoch: 1 [135680/250368 (54%)] | Loss: 0.423958 | Image2Text Acc: 87.89 | Text2Image Acc: 87.50 | Data Time: 0.027s | Batch Time: 0.908s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:52:40 | INFO | Rank 0 | Global Steps: 540/9780 | Train Epoch: 1 [138240/250368 (55%)] | Loss: 0.407387 | Image2Text Acc: 88.67 | Text2Image Acc: 87.50 | Data Time: 0.025s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:52:49 | INFO | Rank 0 | Global Steps: 550/9780 | Train Epoch: 1 [140800/250368 (56%)] | Loss: 0.425331 | Image2Text Acc: 85.55 | Text2Image Acc: 87.11 | Data Time: 0.040s | Batch Time: 0.914s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:52:58 | INFO | Rank 0 | Global Steps: 560/9780 | Train Epoch: 1 [143360/250368 (57%)] | Loss: 0.460880 | Image2Text Acc: 87.11 | Text2Image Acc: 87.89 | Data Time: 0.025s | Batch Time: 0.917s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:53:07 | INFO | Rank 0 | Global Steps: 570/9780 | Train Epoch: 1 [145920/250368 (58%)] | Loss: 0.479350 | Image2Text Acc: 86.33 | Text2Image Acc: 86.72 | Data Time: 0.027s | Batch Time: 0.909s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:53:16 | INFO | Rank 0 | Global Steps: 580/9780 | Train Epoch: 1 [148480/250368 (59%)] | Loss: 0.630807 | Image2Text Acc: 81.25 | Text2Image Acc: 82.81 | Data Time: 0.025s | Batch Time: 0.926s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:53:25 | INFO | Rank 0 | Global Steps: 590/9780 | Train Epoch: 1 [151040/250368 (60%)] | Loss: 0.736185 | Image2Text Acc: 78.52 | Text2Image Acc: 79.30 | Data Time: 0.026s | Batch Time: 0.902s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:53:35 | INFO | Rank 3 | Begin to eval on validation set (epoch 1 @ 600 steps)...
2024-06-01,20:53:35 | INFO | Rank 2 | Begin to eval on validation set (epoch 1 @ 600 steps)...
2024-06-01,20:53:35 | INFO | Rank 1 | Begin to eval on validation set (epoch 1 @ 600 steps)...
2024-06-01,20:53:35 | INFO | Rank 0 | Global Steps: 600/9780 | Train Epoch: 1 [153600/250368 (61%)] | Loss: 0.522362 | Image2Text Acc: 85.16 | Text2Image Acc: 84.38 | Data Time: 0.028s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:53:35 | INFO | Rank 0 | Begin to eval on validation set (epoch 1 @ 600 steps)...
2024-06-01,20:56:00 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,20:56:00 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,20:56:00 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,20:56:01 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,20:56:30 | INFO | Rank 3 | Validation Result (epoch 1 @ 600 steps) | Valid Loss: 0.183392 | Image2Text Acc: 94.55 | Text2Image Acc: 93.91 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,20:56:30 | INFO | Rank 2 | Validation Result (epoch 1 @ 600 steps) | Valid Loss: 0.183392 | Image2Text Acc: 94.55 | Text2Image Acc: 93.91 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,20:56:30 | INFO | Rank 1 | Validation Result (epoch 1 @ 600 steps) | Valid Loss: 0.183392 | Image2Text Acc: 94.55 | Text2Image Acc: 93.91 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,20:56:30 | INFO | Rank 0 | Validation Result (epoch 1 @ 600 steps) | Valid Loss: 0.183392 | Image2Text Acc: 94.55 | Text2Image Acc: 93.91 | logit_scale: 4.605 | Valid Batch Size: 64
0.1833922266960144 0.18485401570796967
0.1833922266960144 0.18485401570796967
0.1833922266960144 0.18485401570796967
0.1833922266960144 0.18485401570796967
2024-06-01,20:58:17 | INFO | Rank 2 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 599 steps)
2024-06-01,20:58:18 | INFO | Rank 1 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 599 steps)
2024-06-01,20:58:18 | INFO | Rank 0 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 599 steps)
2024-06-01,20:58:19 | INFO | Rank 3 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 599 steps)
2024-06-01,20:58:28 | INFO | Rank 0 | Global Steps: 610/9780 | Train Epoch: 1 [156160/250368 (62%)] | Loss: 0.443692 | Image2Text Acc: 88.28 | Text2Image Acc: 87.11 | Data Time: 0.029s | Batch Time: 0.906s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:58:37 | INFO | Rank 0 | Global Steps: 620/9780 | Train Epoch: 1 [158720/250368 (63%)] | Loss: 0.487320 | Image2Text Acc: 85.55 | Text2Image Acc: 84.38 | Data Time: 0.028s | Batch Time: 0.917s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:58:46 | INFO | Rank 0 | Global Steps: 630/9780 | Train Epoch: 1 [161280/250368 (64%)] | Loss: 0.467030 | Image2Text Acc: 85.94 | Text2Image Acc: 87.50 | Data Time: 0.028s | Batch Time: 0.914s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:58:55 | INFO | Rank 0 | Global Steps: 640/9780 | Train Epoch: 1 [163840/250368 (65%)] | Loss: 0.496123 | Image2Text Acc: 83.59 | Text2Image Acc: 87.11 | Data Time: 0.033s | Batch Time: 0.914s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:59:04 | INFO | Rank 0 | Global Steps: 650/9780 | Train Epoch: 1 [166400/250368 (66%)] | Loss: 0.506417 | Image2Text Acc: 85.55 | Text2Image Acc: 86.72 | Data Time: 0.024s | Batch Time: 0.899s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:59:14 | INFO | Rank 0 | Global Steps: 660/9780 | Train Epoch: 1 [168960/250368 (67%)] | Loss: 0.591002 | Image2Text Acc: 83.59 | Text2Image Acc: 84.38 | Data Time: 0.035s | Batch Time: 0.929s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:59:23 | INFO | Rank 0 | Global Steps: 670/9780 | Train Epoch: 1 [171520/250368 (69%)] | Loss: 0.482143 | Image2Text Acc: 83.98 | Text2Image Acc: 81.25 | Data Time: 0.026s | Batch Time: 0.926s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:59:32 | INFO | Rank 0 | Global Steps: 680/9780 | Train Epoch: 1 [174080/250368 (70%)] | Loss: 0.684462 | Image2Text Acc: 80.86 | Text2Image Acc: 81.25 | Data Time: 0.039s | Batch Time: 0.930s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:59:41 | INFO | Rank 0 | Global Steps: 690/9780 | Train Epoch: 1 [176640/250368 (71%)] | Loss: 0.447838 | Image2Text Acc: 85.94 | Text2Image Acc: 86.72 | Data Time: 0.028s | Batch Time: 0.908s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:59:50 | INFO | Rank 3 | Begin to eval on validation set (epoch 1 @ 700 steps)...
2024-06-01,20:59:50 | INFO | Rank 1 | Begin to eval on validation set (epoch 1 @ 700 steps)...
2024-06-01,20:59:50 | INFO | Rank 2 | Begin to eval on validation set (epoch 1 @ 700 steps)...
2024-06-01,20:59:50 | INFO | Rank 0 | Global Steps: 700/9780 | Train Epoch: 1 [179200/250368 (72%)] | Loss: 0.515924 | Image2Text Acc: 83.98 | Text2Image Acc: 83.20 | Data Time: 0.028s | Batch Time: 0.916s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,20:59:50 | INFO | Rank 0 | Begin to eval on validation set (epoch 1 @ 700 steps)...
2024-06-01,21:02:15 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,21:02:16 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,21:02:16 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,21:02:16 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,21:02:46 | INFO | Rank 3 | Validation Result (epoch 1 @ 700 steps) | Valid Loss: 0.183483 | Image2Text Acc: 94.55 | Text2Image Acc: 93.95 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:02:46 | INFO | Rank 1 | Validation Result (epoch 1 @ 700 steps) | Valid Loss: 0.183483 | Image2Text Acc: 94.55 | Text2Image Acc: 93.95 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:02:46 | INFO | Rank 2 | Validation Result (epoch 1 @ 700 steps) | Valid Loss: 0.183483 | Image2Text Acc: 94.55 | Text2Image Acc: 93.95 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:02:46 | INFO | Rank 0 | Validation Result (epoch 1 @ 700 steps) | Valid Loss: 0.183483 | Image2Text Acc: 94.55 | Text2Image Acc: 93.95 | logit_scale: 4.605 | Valid Batch Size: 64
0.18348295986652374 0.1833922266960144
0.18348295986652374 0.1833922266960144
0.18348295986652374 0.1833922266960144
0.18348295986652374 0.1833922266960144
2024-06-01,21:02:55 | INFO | Rank 0 | Global Steps: 710/9780 | Train Epoch: 1 [181760/250368 (73%)] | Loss: 0.575414 | Image2Text Acc: 82.81 | Text2Image Acc: 83.98 | Data Time: 0.028s | Batch Time: 0.904s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:03:04 | INFO | Rank 0 | Global Steps: 720/9780 | Train Epoch: 1 [184320/250368 (74%)] | Loss: 0.480686 | Image2Text Acc: 86.33 | Text2Image Acc: 87.50 | Data Time: 0.028s | Batch Time: 0.913s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:03:14 | INFO | Rank 0 | Global Steps: 730/9780 | Train Epoch: 1 [186880/250368 (75%)] | Loss: 0.582221 | Image2Text Acc: 83.98 | Text2Image Acc: 83.20 | Data Time: 0.036s | Batch Time: 0.914s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:03:23 | INFO | Rank 0 | Global Steps: 740/9780 | Train Epoch: 1 [189440/250368 (76%)] | Loss: 0.586116 | Image2Text Acc: 83.20 | Text2Image Acc: 83.98 | Data Time: 0.026s | Batch Time: 0.921s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:03:32 | INFO | Rank 0 | Global Steps: 750/9780 | Train Epoch: 1 [192000/250368 (77%)] | Loss: 0.431325 | Image2Text Acc: 86.72 | Text2Image Acc: 85.16 | Data Time: 0.028s | Batch Time: 0.915s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:03:41 | INFO | Rank 0 | Global Steps: 760/9780 | Train Epoch: 1 [194560/250368 (78%)] | Loss: 0.637894 | Image2Text Acc: 78.52 | Text2Image Acc: 81.25 | Data Time: 0.026s | Batch Time: 0.914s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:03:50 | INFO | Rank 0 | Global Steps: 770/9780 | Train Epoch: 1 [197120/250368 (79%)] | Loss: 0.670324 | Image2Text Acc: 78.91 | Text2Image Acc: 83.20 | Data Time: 0.029s | Batch Time: 0.909s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:03:59 | INFO | Rank 0 | Global Steps: 780/9780 | Train Epoch: 1 [199680/250368 (80%)] | Loss: 0.491888 | Image2Text Acc: 84.38 | Text2Image Acc: 85.16 | Data Time: 0.024s | Batch Time: 0.909s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:04:08 | INFO | Rank 0 | Global Steps: 790/9780 | Train Epoch: 1 [202240/250368 (81%)] | Loss: 0.503055 | Image2Text Acc: 88.28 | Text2Image Acc: 85.55 | Data Time: 0.029s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:04:18 | INFO | Rank 3 | Begin to eval on validation set (epoch 1 @ 800 steps)...
2024-06-01,21:04:18 | INFO | Rank 1 | Begin to eval on validation set (epoch 1 @ 800 steps)...
2024-06-01,21:04:18 | INFO | Rank 2 | Begin to eval on validation set (epoch 1 @ 800 steps)...
2024-06-01,21:04:18 | INFO | Rank 0 | Global Steps: 800/9780 | Train Epoch: 1 [204800/250368 (82%)] | Loss: 0.368989 | Image2Text Acc: 89.06 | Text2Image Acc: 89.45 | Data Time: 0.028s | Batch Time: 0.916s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:04:18 | INFO | Rank 0 | Begin to eval on validation set (epoch 1 @ 800 steps)...
2024-06-01,21:06:43 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,21:06:43 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,21:06:43 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,21:06:44 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,21:07:14 | INFO | Rank 1 | Validation Result (epoch 1 @ 800 steps) | Valid Loss: 0.182973 | Image2Text Acc: 94.50 | Text2Image Acc: 93.97 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:07:14 | INFO | Rank 3 | Validation Result (epoch 1 @ 800 steps) | Valid Loss: 0.182973 | Image2Text Acc: 94.50 | Text2Image Acc: 93.97 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:07:14 | INFO | Rank 2 | Validation Result (epoch 1 @ 800 steps) | Valid Loss: 0.182973 | Image2Text Acc: 94.50 | Text2Image Acc: 93.97 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:07:14 | INFO | Rank 0 | Validation Result (epoch 1 @ 800 steps) | Valid Loss: 0.182973 | Image2Text Acc: 94.50 | Text2Image Acc: 93.97 | logit_scale: 4.605 | Valid Batch Size: 64
0.18297286331653595 0.1833922266960144
0.18297286331653595 0.1833922266960144
0.18297286331653595 0.1833922266960144
0.18297286331653595 0.1833922266960144
2024-06-01,21:08:59 | INFO | Rank 1 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 799 steps)
2024-06-01,21:09:00 | INFO | Rank 2 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 799 steps)
2024-06-01,21:09:00 | INFO | Rank 0 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 799 steps)
2024-06-01,21:09:02 | INFO | Rank 3 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 799 steps)
2024-06-01,21:09:11 | INFO | Rank 0 | Global Steps: 810/9780 | Train Epoch: 1 [207360/250368 (83%)] | Loss: 0.571862 | Image2Text Acc: 83.98 | Text2Image Acc: 82.42 | Data Time: 0.031s | Batch Time: 0.915s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:09:20 | INFO | Rank 0 | Global Steps: 820/9780 | Train Epoch: 1 [209920/250368 (84%)] | Loss: 0.486610 | Image2Text Acc: 85.55 | Text2Image Acc: 84.77 | Data Time: 0.031s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:09:29 | INFO | Rank 0 | Global Steps: 830/9780 | Train Epoch: 1 [212480/250368 (85%)] | Loss: 0.464560 | Image2Text Acc: 87.11 | Text2Image Acc: 84.77 | Data Time: 0.028s | Batch Time: 0.915s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:09:38 | INFO | Rank 0 | Global Steps: 840/9780 | Train Epoch: 1 [215040/250368 (86%)] | Loss: 0.477106 | Image2Text Acc: 82.81 | Text2Image Acc: 82.03 | Data Time: 0.027s | Batch Time: 0.917s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:09:47 | INFO | Rank 0 | Global Steps: 850/9780 | Train Epoch: 1 [217600/250368 (87%)] | Loss: 0.473064 | Image2Text Acc: 86.33 | Text2Image Acc: 85.55 | Data Time: 0.029s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:09:57 | INFO | Rank 0 | Global Steps: 860/9780 | Train Epoch: 1 [220160/250368 (88%)] | Loss: 0.572409 | Image2Text Acc: 82.81 | Text2Image Acc: 82.42 | Data Time: 0.026s | Batch Time: 0.915s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:10:06 | INFO | Rank 0 | Global Steps: 870/9780 | Train Epoch: 1 [222720/250368 (89%)] | Loss: 0.533659 | Image2Text Acc: 81.25 | Text2Image Acc: 84.77 | Data Time: 0.030s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:10:15 | INFO | Rank 0 | Global Steps: 880/9780 | Train Epoch: 1 [225280/250368 (90%)] | Loss: 0.473385 | Image2Text Acc: 88.28 | Text2Image Acc: 87.50 | Data Time: 0.039s | Batch Time: 0.916s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:10:24 | INFO | Rank 0 | Global Steps: 890/9780 | Train Epoch: 1 [227840/250368 (91%)] | Loss: 0.388406 | Image2Text Acc: 88.28 | Text2Image Acc: 89.06 | Data Time: 0.025s | Batch Time: 0.921s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:10:33 | INFO | Rank 3 | Begin to eval on validation set (epoch 1 @ 900 steps)...
2024-06-01,21:10:33 | INFO | Rank 1 | Begin to eval on validation set (epoch 1 @ 900 steps)...
2024-06-01,21:10:33 | INFO | Rank 2 | Begin to eval on validation set (epoch 1 @ 900 steps)...
2024-06-01,21:10:33 | INFO | Rank 0 | Global Steps: 900/9780 | Train Epoch: 1 [230400/250368 (92%)] | Loss: 0.507292 | Image2Text Acc: 85.16 | Text2Image Acc: 85.94 | Data Time: 0.027s | Batch Time: 0.916s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:10:33 | INFO | Rank 0 | Begin to eval on validation set (epoch 1 @ 900 steps)...
2024-06-01,21:12:58 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,21:12:59 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,21:12:59 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,21:12:59 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,21:13:29 | INFO | Rank 1 | Validation Result (epoch 1 @ 900 steps) | Valid Loss: 0.180399 | Image2Text Acc: 94.63 | Text2Image Acc: 94.03 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:13:29 | INFO | Rank 3 | Validation Result (epoch 1 @ 900 steps) | Valid Loss: 0.180399 | Image2Text Acc: 94.63 | Text2Image Acc: 94.03 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:13:29 | INFO | Rank 2 | Validation Result (epoch 1 @ 900 steps) | Valid Loss: 0.180399 | Image2Text Acc: 94.63 | Text2Image Acc: 94.03 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:13:29 | INFO | Rank 0 | Validation Result (epoch 1 @ 900 steps) | Valid Loss: 0.180399 | Image2Text Acc: 94.63 | Text2Image Acc: 94.03 | logit_scale: 4.605 | Valid Batch Size: 64
0.18039903044700623 0.18297286331653595
0.18039903044700623 0.18297286331653595
0.18039903044700623 0.18297286331653595
0.18039903044700623 0.18297286331653595
2024-06-01,21:15:17 | INFO | Rank 0 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 899 steps)
2024-06-01,21:15:18 | INFO | Rank 3 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 899 steps)
2024-06-01,21:15:19 | INFO | Rank 1 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 899 steps)
2024-06-01,21:15:20 | INFO | Rank 2 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 1 @ 899 steps)
2024-06-01,21:15:29 | INFO | Rank 0 | Global Steps: 910/9780 | Train Epoch: 1 [232960/250368 (93%)] | Loss: 0.534629 | Image2Text Acc: 83.98 | Text2Image Acc: 82.81 | Data Time: 0.027s | Batch Time: 0.902s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:15:38 | INFO | Rank 0 | Global Steps: 920/9780 | Train Epoch: 1 [235520/250368 (94%)] | Loss: 0.507604 | Image2Text Acc: 84.38 | Text2Image Acc: 85.16 | Data Time: 0.029s | Batch Time: 0.915s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:15:47 | INFO | Rank 0 | Global Steps: 930/9780 | Train Epoch: 1 [238080/250368 (95%)] | Loss: 0.395382 | Image2Text Acc: 89.45 | Text2Image Acc: 87.50 | Data Time: 0.030s | Batch Time: 0.908s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:15:57 | INFO | Rank 0 | Global Steps: 940/9780 | Train Epoch: 1 [240640/250368 (96%)] | Loss: 0.541290 | Image2Text Acc: 84.77 | Text2Image Acc: 80.08 | Data Time: 0.039s | Batch Time: 0.930s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:16:06 | INFO | Rank 0 | Global Steps: 950/9780 | Train Epoch: 1 [243200/250368 (97%)] | Loss: 0.545013 | Image2Text Acc: 83.98 | Text2Image Acc: 82.42 | Data Time: 0.038s | Batch Time: 0.917s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:16:15 | INFO | Rank 0 | Global Steps: 960/9780 | Train Epoch: 1 [245760/250368 (98%)] | Loss: 0.556105 | Image2Text Acc: 84.77 | Text2Image Acc: 84.38 | Data Time: 0.031s | Batch Time: 0.917s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:16:24 | INFO | Rank 0 | Global Steps: 970/9780 | Train Epoch: 1 [248320/250368 (99%)] | Loss: 0.532394 | Image2Text Acc: 86.33 | Text2Image Acc: 85.55 | Data Time: 0.031s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:16:32 | INFO | Rank 2 | Begin to eval on validation set (epoch 1 @ 978 steps)...
2024-06-01,21:16:32 | INFO | Rank 1 | Begin to eval on validation set (epoch 1 @ 978 steps)...
2024-06-01,21:16:32 | INFO | Rank 3 | Begin to eval on validation set (epoch 1 @ 978 steps)...
2024-06-01,21:16:32 | INFO | Rank 0 | Begin to eval on validation set (epoch 1 @ 978 steps)...
2024-06-01,21:18:57 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,21:18:57 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,21:18:58 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,21:18:58 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,21:19:27 | INFO | Rank 3 | Validation Result (epoch 1 @ 978 steps) | Valid Loss: 0.180869 | Image2Text Acc: 94.65 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:19:27 | INFO | Rank 1 | Validation Result (epoch 1 @ 978 steps) | Valid Loss: 0.180869 | Image2Text Acc: 94.65 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:19:27 | INFO | Rank 2 | Validation Result (epoch 1 @ 978 steps) | Valid Loss: 0.180869 | Image2Text Acc: 94.65 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:19:27 | INFO | Rank 0 | Validation Result (epoch 1 @ 978 steps) | Valid Loss: 0.180869 | Image2Text Acc: 94.65 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:19:28 | INFO | Rank 3 | train LMDB file contains 129380 images and 250314 pairs.
2024-06-01,21:19:28 | INFO | Rank 0 | train LMDB file contains 129380 images and 250314 pairs.
2024-06-01,21:19:28 | INFO | Rank 1 | train LMDB file contains 129380 images and 250314 pairs.
2024-06-01,21:19:28 | INFO | Rank 2 | train LMDB file contains 129380 images and 250314 pairs.
2024-06-01,21:19:28 | INFO | Rank 2 | val LMDB file contains 29806 images and 30588 pairs.
2024-06-01,21:19:28 | INFO | Rank 1 | val LMDB file contains 29806 images and 30588 pairs.
2024-06-01,21:19:28 | INFO | Rank 3 | val LMDB file contains 29806 images and 30588 pairs.
2024-06-01,21:19:28 | INFO | Rank 3 | Start epoch 2
2024-06-01,21:19:28 | INFO | Rank 2 | Start epoch 2
2024-06-01,21:19:28 | INFO | Rank 1 | Start epoch 2
2024-06-01,21:19:28 | INFO | Rank 0 | val LMDB file contains 29806 images and 30588 pairs.
2024-06-01,21:20:11 | INFO | Rank 0 | Saved checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/epoch1.pt (epoch 1 @ 978 steps) (writing took 43.404284715652466 seconds)
2024-06-01,21:20:52 | INFO | Rank 0 | Saved checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/epoch_latest.pt (epoch 1 @ 978 steps) (writing took 40.345479011535645 seconds)
2024-06-01,21:20:54 | INFO | Rank 0 | Global Steps: 980/9780 | Train Epoch: 2 [512/250368 (0%)] | Loss: 0.481476 | Image2Text Acc: 85.16 | Text2Image Acc: 84.77 | Data Time: 0.026s | Batch Time: 0.916s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:21:04 | INFO | Rank 0 | Global Steps: 990/9780 | Train Epoch: 2 [3072/250368 (1%)] | Loss: 0.478930 | Image2Text Acc: 83.98 | Text2Image Acc: 83.98 | Data Time: 0.027s | Batch Time: 0.905s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:21:13 | INFO | Rank 3 | Begin to eval on validation set (epoch 2 @ 1000 steps)...
2024-06-01,21:21:13 | INFO | Rank 1 | Begin to eval on validation set (epoch 2 @ 1000 steps)...
2024-06-01,21:21:13 | INFO | Rank 2 | Begin to eval on validation set (epoch 2 @ 1000 steps)...
2024-06-01,21:21:13 | INFO | Rank 0 | Global Steps: 1000/9780 | Train Epoch: 2 [5632/250368 (2%)] | Loss: 0.362694 | Image2Text Acc: 88.28 | Text2Image Acc: 85.94 | Data Time: 0.035s | Batch Time: 0.919s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:21:13 | INFO | Rank 0 | Begin to eval on validation set (epoch 2 @ 1000 steps)...
2024-06-01,21:23:38 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,21:23:38 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,21:23:38 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,21:23:39 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,21:24:09 | INFO | Rank 2 | Validation Result (epoch 2 @ 1000 steps) | Valid Loss: 0.182614 | Image2Text Acc: 94.63 | Text2Image Acc: 93.92 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:24:09 | INFO | Rank 1 | Validation Result (epoch 2 @ 1000 steps) | Valid Loss: 0.182614 | Image2Text Acc: 94.63 | Text2Image Acc: 93.92 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:24:09 | INFO | Rank 3 | Validation Result (epoch 2 @ 1000 steps) | Valid Loss: 0.182614 | Image2Text Acc: 94.63 | Text2Image Acc: 93.92 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:24:09 | INFO | Rank 0 | Validation Result (epoch 2 @ 1000 steps) | Valid Loss: 0.182614 | Image2Text Acc: 94.63 | Text2Image Acc: 93.92 | logit_scale: 4.605 | Valid Batch Size: 64
0.18261419236660004 0.18039903044700623
0.18261419236660004 0.18039903044700623
0.18261419236660004 0.18039903044700623
0.18261419236660004 0.18039903044700623
2024-06-01,21:24:18 | INFO | Rank 0 | Global Steps: 1010/9780 | Train Epoch: 2 [8192/250368 (3%)] | Loss: 0.428507 | Image2Text Acc: 87.50 | Text2Image Acc: 86.72 | Data Time: 0.035s | Batch Time: 0.919s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:24:27 | INFO | Rank 0 | Global Steps: 1020/9780 | Train Epoch: 2 [10752/250368 (4%)] | Loss: 0.558724 | Image2Text Acc: 82.81 | Text2Image Acc: 80.86 | Data Time: 0.037s | Batch Time: 0.918s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:24:37 | INFO | Rank 0 | Global Steps: 1030/9780 | Train Epoch: 2 [13312/250368 (5%)] | Loss: 0.430867 | Image2Text Acc: 84.38 | Text2Image Acc: 86.33 | Data Time: 0.044s | Batch Time: 0.927s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:24:46 | INFO | Rank 0 | Global Steps: 1040/9780 | Train Epoch: 2 [15872/250368 (6%)] | Loss: 0.483857 | Image2Text Acc: 84.38 | Text2Image Acc: 85.16 | Data Time: 0.039s | Batch Time: 0.918s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:24:55 | INFO | Rank 0 | Global Steps: 1050/9780 | Train Epoch: 2 [18432/250368 (7%)] | Loss: 0.490800 | Image2Text Acc: 83.20 | Text2Image Acc: 85.94 | Data Time: 0.033s | Batch Time: 0.925s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:25:04 | INFO | Rank 0 | Global Steps: 1060/9780 | Train Epoch: 2 [20992/250368 (8%)] | Loss: 0.496238 | Image2Text Acc: 83.98 | Text2Image Acc: 84.38 | Data Time: 0.032s | Batch Time: 0.909s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:25:13 | INFO | Rank 0 | Global Steps: 1070/9780 | Train Epoch: 2 [23552/250368 (9%)] | Loss: 0.516553 | Image2Text Acc: 85.94 | Text2Image Acc: 82.81 | Data Time: 0.035s | Batch Time: 0.915s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:25:22 | INFO | Rank 0 | Global Steps: 1080/9780 | Train Epoch: 2 [26112/250368 (10%)] | Loss: 0.464399 | Image2Text Acc: 84.38 | Text2Image Acc: 86.72 | Data Time: 0.034s | Batch Time: 0.922s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:25:32 | INFO | Rank 0 | Global Steps: 1090/9780 | Train Epoch: 2 [28672/250368 (11%)] | Loss: 0.427798 | Image2Text Acc: 85.16 | Text2Image Acc: 84.38 | Data Time: 0.033s | Batch Time: 0.906s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:25:41 | INFO | Rank 3 | Begin to eval on validation set (epoch 2 @ 1100 steps)...
2024-06-01,21:25:41 | INFO | Rank 1 | Begin to eval on validation set (epoch 2 @ 1100 steps)...
2024-06-01,21:25:41 | INFO | Rank 2 | Begin to eval on validation set (epoch 2 @ 1100 steps)...
2024-06-01,21:25:41 | INFO | Rank 0 | Global Steps: 1100/9780 | Train Epoch: 2 [31232/250368 (12%)] | Loss: 0.470371 | Image2Text Acc: 87.11 | Text2Image Acc: 84.77 | Data Time: 0.035s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:25:41 | INFO | Rank 0 | Begin to eval on validation set (epoch 2 @ 1100 steps)...
2024-06-01,21:28:06 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,21:28:06 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,21:28:06 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,21:28:07 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,21:28:37 | INFO | Rank 3 | Validation Result (epoch 2 @ 1100 steps) | Valid Loss: 0.183142 | Image2Text Acc: 94.50 | Text2Image Acc: 94.01 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:28:37 | INFO | Rank 2 | Validation Result (epoch 2 @ 1100 steps) | Valid Loss: 0.183142 | Image2Text Acc: 94.50 | Text2Image Acc: 94.01 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:28:37 | INFO | Rank 1 | Validation Result (epoch 2 @ 1100 steps) | Valid Loss: 0.183142 | Image2Text Acc: 94.50 | Text2Image Acc: 94.01 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:28:37 | INFO | Rank 0 | Validation Result (epoch 2 @ 1100 steps) | Valid Loss: 0.183142 | Image2Text Acc: 94.50 | Text2Image Acc: 94.01 | logit_scale: 4.605 | Valid Batch Size: 64
0.18314234912395477 0.18039903044700623
0.18314234912395477 0.18039903044700623
0.18314234912395477 0.18039903044700623
0.18314234912395477 0.18039903044700623
2024-06-01,21:28:46 | INFO | Rank 0 | Global Steps: 1110/9780 | Train Epoch: 2 [33792/250368 (13%)] | Loss: 0.480803 | Image2Text Acc: 85.55 | Text2Image Acc: 87.11 | Data Time: 0.036s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:28:55 | INFO | Rank 0 | Global Steps: 1120/9780 | Train Epoch: 2 [36352/250368 (15%)] | Loss: 0.467160 | Image2Text Acc: 84.77 | Text2Image Acc: 82.81 | Data Time: 0.035s | Batch Time: 0.913s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:29:05 | INFO | Rank 0 | Global Steps: 1130/9780 | Train Epoch: 2 [38912/250368 (16%)] | Loss: 0.510533 | Image2Text Acc: 82.81 | Text2Image Acc: 83.98 | Data Time: 0.037s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:29:14 | INFO | Rank 0 | Global Steps: 1140/9780 | Train Epoch: 2 [41472/250368 (17%)] | Loss: 0.464984 | Image2Text Acc: 87.11 | Text2Image Acc: 87.89 | Data Time: 0.034s | Batch Time: 0.916s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:29:23 | INFO | Rank 0 | Global Steps: 1150/9780 | Train Epoch: 2 [44032/250368 (18%)] | Loss: 0.442415 | Image2Text Acc: 84.77 | Text2Image Acc: 86.33 | Data Time: 0.038s | Batch Time: 0.917s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:29:32 | INFO | Rank 0 | Global Steps: 1160/9780 | Train Epoch: 2 [46592/250368 (19%)] | Loss: 0.493737 | Image2Text Acc: 87.11 | Text2Image Acc: 85.16 | Data Time: 0.032s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:29:41 | INFO | Rank 0 | Global Steps: 1170/9780 | Train Epoch: 2 [49152/250368 (20%)] | Loss: 0.510279 | Image2Text Acc: 84.77 | Text2Image Acc: 86.33 | Data Time: 0.033s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:29:50 | INFO | Rank 0 | Global Steps: 1180/9780 | Train Epoch: 2 [51712/250368 (21%)] | Loss: 0.512428 | Image2Text Acc: 84.38 | Text2Image Acc: 83.59 | Data Time: 0.037s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:29:59 | INFO | Rank 0 | Global Steps: 1190/9780 | Train Epoch: 2 [54272/250368 (22%)] | Loss: 0.454316 | Image2Text Acc: 85.55 | Text2Image Acc: 84.77 | Data Time: 0.035s | Batch Time: 0.917s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:30:09 | INFO | Rank 2 | Begin to eval on validation set (epoch 2 @ 1200 steps)...
2024-06-01,21:30:09 | INFO | Rank 3 | Begin to eval on validation set (epoch 2 @ 1200 steps)...
2024-06-01,21:30:09 | INFO | Rank 1 | Begin to eval on validation set (epoch 2 @ 1200 steps)...
2024-06-01,21:30:09 | INFO | Rank 0 | Global Steps: 1200/9780 | Train Epoch: 2 [56832/250368 (23%)] | Loss: 0.427838 | Image2Text Acc: 87.11 | Text2Image Acc: 87.11 | Data Time: 0.034s | Batch Time: 0.913s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:30:09 | INFO | Rank 0 | Begin to eval on validation set (epoch 2 @ 1200 steps)...
2024-06-01,21:32:34 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,21:32:34 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,21:32:34 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,21:32:35 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,21:33:05 | INFO | Rank 1 | Validation Result (epoch 2 @ 1200 steps) | Valid Loss: 0.183875 | Image2Text Acc: 94.53 | Text2Image Acc: 93.99 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:33:05 | INFO | Rank 3 | Validation Result (epoch 2 @ 1200 steps) | Valid Loss: 0.183875 | Image2Text Acc: 94.53 | Text2Image Acc: 93.99 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:33:05 | INFO | Rank 2 | Validation Result (epoch 2 @ 1200 steps) | Valid Loss: 0.183875 | Image2Text Acc: 94.53 | Text2Image Acc: 93.99 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:33:05 | INFO | Rank 0 | Validation Result (epoch 2 @ 1200 steps) | Valid Loss: 0.183875 | Image2Text Acc: 94.53 | Text2Image Acc: 93.99 | logit_scale: 4.605 | Valid Batch Size: 64
0.1838751882314682 0.18039903044700623
0.1838751882314682 0.18039903044700623
0.1838751882314682 0.18039903044700623
0.1838751882314682 0.18039903044700623
2024-06-01,21:33:14 | INFO | Rank 0 | Global Steps: 1210/9780 | Train Epoch: 2 [59392/250368 (24%)] | Loss: 0.381602 | Image2Text Acc: 87.11 | Text2Image Acc: 89.06 | Data Time: 0.032s | Batch Time: 0.906s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:33:23 | INFO | Rank 0 | Global Steps: 1220/9780 | Train Epoch: 2 [61952/250368 (25%)] | Loss: 0.408579 | Image2Text Acc: 87.89 | Text2Image Acc: 85.94 | Data Time: 0.039s | Batch Time: 0.935s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:33:32 | INFO | Rank 0 | Global Steps: 1230/9780 | Train Epoch: 2 [64512/250368 (26%)] | Loss: 0.413209 | Image2Text Acc: 87.11 | Text2Image Acc: 87.89 | Data Time: 0.034s | Batch Time: 0.907s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:33:42 | INFO | Rank 0 | Global Steps: 1240/9780 | Train Epoch: 2 [67072/250368 (27%)] | Loss: 0.536745 | Image2Text Acc: 82.03 | Text2Image Acc: 85.55 | Data Time: 0.035s | Batch Time: 0.917s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:33:51 | INFO | Rank 0 | Global Steps: 1250/9780 | Train Epoch: 2 [69632/250368 (28%)] | Loss: 0.367133 | Image2Text Acc: 88.28 | Text2Image Acc: 86.72 | Data Time: 0.037s | Batch Time: 0.915s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:34:00 | INFO | Rank 0 | Global Steps: 1260/9780 | Train Epoch: 2 [72192/250368 (29%)] | Loss: 0.491647 | Image2Text Acc: 84.77 | Text2Image Acc: 85.55 | Data Time: 0.036s | Batch Time: 0.914s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:34:09 | INFO | Rank 0 | Global Steps: 1270/9780 | Train Epoch: 2 [74752/250368 (30%)] | Loss: 0.508067 | Image2Text Acc: 86.72 | Text2Image Acc: 85.55 | Data Time: 0.042s | Batch Time: 0.916s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:34:18 | INFO | Rank 0 | Global Steps: 1280/9780 | Train Epoch: 2 [77312/250368 (31%)] | Loss: 0.421543 | Image2Text Acc: 88.67 | Text2Image Acc: 87.50 | Data Time: 0.038s | Batch Time: 0.913s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:34:28 | INFO | Rank 0 | Global Steps: 1290/9780 | Train Epoch: 2 [79872/250368 (32%)] | Loss: 0.448300 | Image2Text Acc: 84.38 | Text2Image Acc: 85.55 | Data Time: 0.036s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:34:37 | INFO | Rank 3 | Begin to eval on validation set (epoch 2 @ 1300 steps)...
2024-06-01,21:34:37 | INFO | Rank 2 | Begin to eval on validation set (epoch 2 @ 1300 steps)...
2024-06-01,21:34:37 | INFO | Rank 1 | Begin to eval on validation set (epoch 2 @ 1300 steps)...
2024-06-01,21:34:37 | INFO | Rank 0 | Global Steps: 1300/9780 | Train Epoch: 2 [82432/250368 (33%)] | Loss: 0.447694 | Image2Text Acc: 86.72 | Text2Image Acc: 87.89 | Data Time: 0.030s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:34:37 | INFO | Rank 0 | Begin to eval on validation set (epoch 2 @ 1300 steps)...
2024-06-01,21:37:02 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,21:37:02 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,21:37:02 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,21:37:03 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,21:37:33 | INFO | Rank 3 | Validation Result (epoch 2 @ 1300 steps) | Valid Loss: 0.183337 | Image2Text Acc: 94.53 | Text2Image Acc: 94.05 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:37:33 | INFO | Rank 1 | Validation Result (epoch 2 @ 1300 steps) | Valid Loss: 0.183337 | Image2Text Acc: 94.53 | Text2Image Acc: 94.05 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:37:33 | INFO | Rank 2 | Validation Result (epoch 2 @ 1300 steps) | Valid Loss: 0.183337 | Image2Text Acc: 94.53 | Text2Image Acc: 94.05 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:37:33 | INFO | Rank 0 | Validation Result (epoch 2 @ 1300 steps) | Valid Loss: 0.183337 | Image2Text Acc: 94.53 | Text2Image Acc: 94.05 | logit_scale: 4.605 | Valid Batch Size: 64
0.1833365112543106 0.18039903044700623
0.1833365112543106 0.18039903044700623
0.1833365112543106 0.18039903044700623
0.1833365112543106 0.18039903044700623
2024-06-01,21:37:42 | INFO | Rank 0 | Global Steps: 1310/9780 | Train Epoch: 2 [84992/250368 (34%)] | Loss: 0.413424 | Image2Text Acc: 87.50 | Text2Image Acc: 88.28 | Data Time: 0.036s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:37:51 | INFO | Rank 0 | Global Steps: 1320/9780 | Train Epoch: 2 [87552/250368 (35%)] | Loss: 0.421527 | Image2Text Acc: 87.50 | Text2Image Acc: 83.98 | Data Time: 0.035s | Batch Time: 0.925s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:38:00 | INFO | Rank 0 | Global Steps: 1330/9780 | Train Epoch: 2 [90112/250368 (36%)] | Loss: 0.400584 | Image2Text Acc: 88.28 | Text2Image Acc: 87.50 | Data Time: 0.031s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:38:10 | INFO | Rank 0 | Global Steps: 1340/9780 | Train Epoch: 2 [92672/250368 (37%)] | Loss: 0.570046 | Image2Text Acc: 86.33 | Text2Image Acc: 83.20 | Data Time: 0.036s | Batch Time: 0.916s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:38:19 | INFO | Rank 0 | Global Steps: 1350/9780 | Train Epoch: 2 [95232/250368 (38%)] | Loss: 0.368425 | Image2Text Acc: 87.89 | Text2Image Acc: 89.84 | Data Time: 0.033s | Batch Time: 0.926s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:38:28 | INFO | Rank 0 | Global Steps: 1360/9780 | Train Epoch: 2 [97792/250368 (39%)] | Loss: 0.442164 | Image2Text Acc: 86.72 | Text2Image Acc: 84.38 | Data Time: 0.044s | Batch Time: 0.924s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:38:37 | INFO | Rank 0 | Global Steps: 1370/9780 | Train Epoch: 2 [100352/250368 (40%)] | Loss: 0.488597 | Image2Text Acc: 83.98 | Text2Image Acc: 85.55 | Data Time: 0.035s | Batch Time: 0.907s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:38:46 | INFO | Rank 0 | Global Steps: 1380/9780 | Train Epoch: 2 [102912/250368 (41%)] | Loss: 0.533502 | Image2Text Acc: 82.03 | Text2Image Acc: 85.94 | Data Time: 0.031s | Batch Time: 0.909s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:38:55 | INFO | Rank 0 | Global Steps: 1390/9780 | Train Epoch: 2 [105472/250368 (42%)] | Loss: 0.517572 | Image2Text Acc: 83.98 | Text2Image Acc: 85.94 | Data Time: 0.032s | Batch Time: 0.914s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:39:05 | INFO | Rank 2 | Begin to eval on validation set (epoch 2 @ 1400 steps)...
2024-06-01,21:39:05 | INFO | Rank 3 | Begin to eval on validation set (epoch 2 @ 1400 steps)...
2024-06-01,21:39:05 | INFO | Rank 1 | Begin to eval on validation set (epoch 2 @ 1400 steps)...
2024-06-01,21:39:05 | INFO | Rank 0 | Global Steps: 1400/9780 | Train Epoch: 2 [108032/250368 (43%)] | Loss: 0.564005 | Image2Text Acc: 83.20 | Text2Image Acc: 82.03 | Data Time: 0.036s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:39:05 | INFO | Rank 0 | Begin to eval on validation set (epoch 2 @ 1400 steps)...
2024-06-01,21:41:30 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,21:41:30 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,21:41:30 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,21:41:31 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,21:42:01 | INFO | Rank 2 | Validation Result (epoch 2 @ 1400 steps) | Valid Loss: 0.182052 | Image2Text Acc: 94.57 | Text2Image Acc: 94.07 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:42:01 | INFO | Rank 1 | Validation Result (epoch 2 @ 1400 steps) | Valid Loss: 0.182052 | Image2Text Acc: 94.57 | Text2Image Acc: 94.07 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:42:01 | INFO | Rank 3 | Validation Result (epoch 2 @ 1400 steps) | Valid Loss: 0.182052 | Image2Text Acc: 94.57 | Text2Image Acc: 94.07 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:42:01 | INFO | Rank 0 | Validation Result (epoch 2 @ 1400 steps) | Valid Loss: 0.182052 | Image2Text Acc: 94.57 | Text2Image Acc: 94.07 | logit_scale: 4.605 | Valid Batch Size: 64
0.18205204606056213 0.18039903044700623
0.18205204606056213 0.18039903044700623
0.18205204606056213 0.18039903044700623
0.18205204606056213 0.18039903044700623
2024-06-01,21:42:10 | INFO | Rank 0 | Global Steps: 1410/9780 | Train Epoch: 2 [110592/250368 (44%)] | Loss: 0.372243 | Image2Text Acc: 86.33 | Text2Image Acc: 88.67 | Data Time: 0.037s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:42:19 | INFO | Rank 0 | Global Steps: 1420/9780 | Train Epoch: 2 [113152/250368 (45%)] | Loss: 0.493670 | Image2Text Acc: 84.38 | Text2Image Acc: 85.55 | Data Time: 0.033s | Batch Time: 0.922s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:42:28 | INFO | Rank 0 | Global Steps: 1430/9780 | Train Epoch: 2 [115712/250368 (46%)] | Loss: 0.464262 | Image2Text Acc: 85.55 | Text2Image Acc: 85.55 | Data Time: 0.035s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:42:37 | INFO | Rank 0 | Global Steps: 1440/9780 | Train Epoch: 2 [118272/250368 (47%)] | Loss: 0.621343 | Image2Text Acc: 83.98 | Text2Image Acc: 82.03 | Data Time: 0.031s | Batch Time: 0.913s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:42:47 | INFO | Rank 0 | Global Steps: 1450/9780 | Train Epoch: 2 [120832/250368 (48%)] | Loss: 0.594984 | Image2Text Acc: 83.98 | Text2Image Acc: 81.25 | Data Time: 0.033s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:42:56 | INFO | Rank 0 | Global Steps: 1460/9780 | Train Epoch: 2 [123392/250368 (49%)] | Loss: 0.565877 | Image2Text Acc: 83.20 | Text2Image Acc: 85.94 | Data Time: 0.032s | Batch Time: 0.915s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:43:05 | INFO | Rank 0 | Global Steps: 1470/9780 | Train Epoch: 2 [125952/250368 (50%)] | Loss: 0.532108 | Image2Text Acc: 85.16 | Text2Image Acc: 85.16 | Data Time: 0.035s | Batch Time: 0.915s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:43:14 | INFO | Rank 0 | Global Steps: 1480/9780 | Train Epoch: 2 [128512/250368 (51%)] | Loss: 0.488818 | Image2Text Acc: 87.89 | Text2Image Acc: 85.55 | Data Time: 0.031s | Batch Time: 0.918s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:43:23 | INFO | Rank 0 | Global Steps: 1490/9780 | Train Epoch: 2 [131072/250368 (52%)] | Loss: 0.473130 | Image2Text Acc: 87.50 | Text2Image Acc: 87.50 | Data Time: 0.039s | Batch Time: 0.931s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:43:32 | INFO | Rank 2 | Begin to eval on validation set (epoch 2 @ 1500 steps)...
2024-06-01,21:43:32 | INFO | Rank 1 | Begin to eval on validation set (epoch 2 @ 1500 steps)...
2024-06-01,21:43:32 | INFO | Rank 3 | Begin to eval on validation set (epoch 2 @ 1500 steps)...
2024-06-01,21:43:32 | INFO | Rank 0 | Global Steps: 1500/9780 | Train Epoch: 2 [133632/250368 (53%)] | Loss: 0.452579 | Image2Text Acc: 85.55 | Text2Image Acc: 87.50 | Data Time: 0.034s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:43:32 | INFO | Rank 0 | Begin to eval on validation set (epoch 2 @ 1500 steps)...
2024-06-01,21:45:58 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,21:45:58 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,21:45:58 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,21:45:59 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,21:46:28 | INFO | Rank 3 | Validation Result (epoch 2 @ 1500 steps) | Valid Loss: 0.180047 | Image2Text Acc: 94.60 | Text2Image Acc: 94.06 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:46:28 | INFO | Rank 2 | Validation Result (epoch 2 @ 1500 steps) | Valid Loss: 0.180047 | Image2Text Acc: 94.60 | Text2Image Acc: 94.06 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:46:28 | INFO | Rank 1 | Validation Result (epoch 2 @ 1500 steps) | Valid Loss: 0.180047 | Image2Text Acc: 94.60 | Text2Image Acc: 94.06 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:46:28 | INFO | Rank 0 | Validation Result (epoch 2 @ 1500 steps) | Valid Loss: 0.180047 | Image2Text Acc: 94.60 | Text2Image Acc: 94.06 | logit_scale: 4.605 | Valid Batch Size: 64
0.18004728853702545 0.18039903044700623
0.18004728853702545 0.18039903044700623
0.18004728853702545 0.18039903044700623
0.18004728853702545 0.18039903044700623
2024-06-01,21:48:15 | INFO | Rank 1 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 2 @ 1499 steps)
2024-06-01,21:48:16 | INFO | Rank 2 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 2 @ 1499 steps)
2024-06-01,21:48:16 | INFO | Rank 3 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 2 @ 1499 steps)
2024-06-01,21:48:18 | INFO | Rank 0 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 2 @ 1499 steps)
2024-06-01,21:48:28 | INFO | Rank 0 | Global Steps: 1510/9780 | Train Epoch: 2 [136192/250368 (54%)] | Loss: 0.463286 | Image2Text Acc: 84.38 | Text2Image Acc: 83.59 | Data Time: 0.031s | Batch Time: 0.919s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:48:37 | INFO | Rank 0 | Global Steps: 1520/9780 | Train Epoch: 2 [138752/250368 (55%)] | Loss: 0.413983 | Image2Text Acc: 87.50 | Text2Image Acc: 85.94 | Data Time: 0.029s | Batch Time: 0.923s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:48:46 | INFO | Rank 0 | Global Steps: 1530/9780 | Train Epoch: 2 [141312/250368 (56%)] | Loss: 0.512865 | Image2Text Acc: 84.77 | Text2Image Acc: 85.94 | Data Time: 0.038s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:48:55 | INFO | Rank 0 | Global Steps: 1540/9780 | Train Epoch: 2 [143872/250368 (57%)] | Loss: 0.561168 | Image2Text Acc: 85.55 | Text2Image Acc: 84.77 | Data Time: 0.036s | Batch Time: 0.924s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:49:04 | INFO | Rank 0 | Global Steps: 1550/9780 | Train Epoch: 2 [146432/250368 (58%)] | Loss: 0.473248 | Image2Text Acc: 84.77 | Text2Image Acc: 86.33 | Data Time: 0.033s | Batch Time: 0.920s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:49:14 | INFO | Rank 0 | Global Steps: 1560/9780 | Train Epoch: 2 [148992/250368 (60%)] | Loss: 0.609563 | Image2Text Acc: 82.42 | Text2Image Acc: 82.42 | Data Time: 0.036s | Batch Time: 0.918s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:49:23 | INFO | Rank 0 | Global Steps: 1570/9780 | Train Epoch: 2 [151552/250368 (61%)] | Loss: 0.476107 | Image2Text Acc: 87.11 | Text2Image Acc: 83.59 | Data Time: 0.037s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:49:32 | INFO | Rank 0 | Global Steps: 1580/9780 | Train Epoch: 2 [154112/250368 (62%)] | Loss: 0.533867 | Image2Text Acc: 82.03 | Text2Image Acc: 85.94 | Data Time: 0.034s | Batch Time: 0.909s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:49:41 | INFO | Rank 0 | Global Steps: 1590/9780 | Train Epoch: 2 [156672/250368 (63%)] | Loss: 0.520037 | Image2Text Acc: 83.20 | Text2Image Acc: 83.20 | Data Time: 0.032s | Batch Time: 0.909s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:49:50 | INFO | Rank 2 | Begin to eval on validation set (epoch 2 @ 1600 steps)...
2024-06-01,21:49:50 | INFO | Rank 1 | Begin to eval on validation set (epoch 2 @ 1600 steps)...
2024-06-01,21:49:50 | INFO | Rank 3 | Begin to eval on validation set (epoch 2 @ 1600 steps)...
2024-06-01,21:49:50 | INFO | Rank 0 | Global Steps: 1600/9780 | Train Epoch: 2 [159232/250368 (64%)] | Loss: 0.500014 | Image2Text Acc: 83.98 | Text2Image Acc: 83.59 | Data Time: 0.038s | Batch Time: 0.918s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:49:50 | INFO | Rank 0 | Begin to eval on validation set (epoch 2 @ 1600 steps)...
2024-06-01,21:52:15 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,21:52:15 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,21:52:16 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,21:52:16 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,21:52:46 | INFO | Rank 3 | Validation Result (epoch 2 @ 1600 steps) | Valid Loss: 0.180900 | Image2Text Acc: 94.69 | Text2Image Acc: 94.03 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:52:46 | INFO | Rank 1 | Validation Result (epoch 2 @ 1600 steps) | Valid Loss: 0.180900 | Image2Text Acc: 94.69 | Text2Image Acc: 94.03 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:52:46 | INFO | Rank 2 | Validation Result (epoch 2 @ 1600 steps) | Valid Loss: 0.180900 | Image2Text Acc: 94.69 | Text2Image Acc: 94.03 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:52:46 | INFO | Rank 0 | Validation Result (epoch 2 @ 1600 steps) | Valid Loss: 0.180900 | Image2Text Acc: 94.69 | Text2Image Acc: 94.03 | logit_scale: 4.605 | Valid Batch Size: 64
0.18090017139911652 0.18004728853702545
0.18090017139911652 0.18004728853702545
0.18090017139911652 0.18004728853702545
0.18090017139911652 0.18004728853702545
2024-06-01,21:52:56 | INFO | Rank 0 | Global Steps: 1610/9780 | Train Epoch: 2 [161792/250368 (65%)] | Loss: 0.430632 | Image2Text Acc: 87.89 | Text2Image Acc: 87.89 | Data Time: 0.029s | Batch Time: 0.913s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:53:05 | INFO | Rank 0 | Global Steps: 1620/9780 | Train Epoch: 2 [164352/250368 (66%)] | Loss: 0.499865 | Image2Text Acc: 85.94 | Text2Image Acc: 83.98 | Data Time: 0.035s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:53:14 | INFO | Rank 0 | Global Steps: 1630/9780 | Train Epoch: 2 [166912/250368 (67%)] | Loss: 0.355929 | Image2Text Acc: 87.50 | Text2Image Acc: 89.06 | Data Time: 0.034s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:53:23 | INFO | Rank 0 | Global Steps: 1640/9780 | Train Epoch: 2 [169472/250368 (68%)] | Loss: 0.425170 | Image2Text Acc: 87.11 | Text2Image Acc: 86.33 | Data Time: 0.044s | Batch Time: 0.918s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:53:32 | INFO | Rank 0 | Global Steps: 1650/9780 | Train Epoch: 2 [172032/250368 (69%)] | Loss: 0.573883 | Image2Text Acc: 83.20 | Text2Image Acc: 81.25 | Data Time: 0.035s | Batch Time: 0.915s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:53:41 | INFO | Rank 0 | Global Steps: 1660/9780 | Train Epoch: 2 [174592/250368 (70%)] | Loss: 0.451253 | Image2Text Acc: 86.72 | Text2Image Acc: 85.94 | Data Time: 0.033s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:53:50 | INFO | Rank 0 | Global Steps: 1670/9780 | Train Epoch: 2 [177152/250368 (71%)] | Loss: 0.457174 | Image2Text Acc: 87.89 | Text2Image Acc: 87.50 | Data Time: 0.035s | Batch Time: 0.918s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:54:00 | INFO | Rank 0 | Global Steps: 1680/9780 | Train Epoch: 2 [179712/250368 (72%)] | Loss: 0.446576 | Image2Text Acc: 83.98 | Text2Image Acc: 87.89 | Data Time: 0.032s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:54:09 | INFO | Rank 0 | Global Steps: 1690/9780 | Train Epoch: 2 [182272/250368 (73%)] | Loss: 0.470934 | Image2Text Acc: 85.16 | Text2Image Acc: 84.77 | Data Time: 0.032s | Batch Time: 0.907s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:54:18 | INFO | Rank 2 | Begin to eval on validation set (epoch 2 @ 1700 steps)...
2024-06-01,21:54:18 | INFO | Rank 3 | Begin to eval on validation set (epoch 2 @ 1700 steps)...
2024-06-01,21:54:18 | INFO | Rank 1 | Begin to eval on validation set (epoch 2 @ 1700 steps)...
2024-06-01,21:54:18 | INFO | Rank 0 | Global Steps: 1700/9780 | Train Epoch: 2 [184832/250368 (74%)] | Loss: 0.513871 | Image2Text Acc: 87.50 | Text2Image Acc: 84.77 | Data Time: 0.042s | Batch Time: 0.917s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:54:18 | INFO | Rank 0 | Begin to eval on validation set (epoch 2 @ 1700 steps)...
2024-06-01,21:56:43 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,21:56:44 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,21:56:44 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,21:56:44 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,21:57:14 | INFO | Rank 2 | Validation Result (epoch 2 @ 1700 steps) | Valid Loss: 0.181047 | Image2Text Acc: 94.65 | Text2Image Acc: 94.10 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:57:14 | INFO | Rank 1 | Validation Result (epoch 2 @ 1700 steps) | Valid Loss: 0.181047 | Image2Text Acc: 94.65 | Text2Image Acc: 94.10 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:57:14 | INFO | Rank 3 | Validation Result (epoch 2 @ 1700 steps) | Valid Loss: 0.181047 | Image2Text Acc: 94.65 | Text2Image Acc: 94.10 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,21:57:14 | INFO | Rank 0 | Validation Result (epoch 2 @ 1700 steps) | Valid Loss: 0.181047 | Image2Text Acc: 94.65 | Text2Image Acc: 94.10 | logit_scale: 4.605 | Valid Batch Size: 64
0.1810467541217804 0.18004728853702545
0.1810467541217804 0.18004728853702545
0.1810467541217804 0.18004728853702545
0.1810467541217804 0.18004728853702545
2024-06-01,21:57:23 | INFO | Rank 0 | Global Steps: 1710/9780 | Train Epoch: 2 [187392/250368 (75%)] | Loss: 0.509791 | Image2Text Acc: 84.77 | Text2Image Acc: 85.16 | Data Time: 0.038s | Batch Time: 0.922s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:57:33 | INFO | Rank 0 | Global Steps: 1720/9780 | Train Epoch: 2 [189952/250368 (76%)] | Loss: 0.508308 | Image2Text Acc: 85.16 | Text2Image Acc: 85.55 | Data Time: 0.031s | Batch Time: 0.913s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:57:42 | INFO | Rank 0 | Global Steps: 1730/9780 | Train Epoch: 2 [192512/250368 (77%)] | Loss: 0.427074 | Image2Text Acc: 87.89 | Text2Image Acc: 84.77 | Data Time: 0.031s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:57:51 | INFO | Rank 0 | Global Steps: 1740/9780 | Train Epoch: 2 [195072/250368 (78%)] | Loss: 0.412098 | Image2Text Acc: 88.28 | Text2Image Acc: 88.28 | Data Time: 0.044s | Batch Time: 0.927s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:58:00 | INFO | Rank 0 | Global Steps: 1750/9780 | Train Epoch: 2 [197632/250368 (79%)] | Loss: 0.398985 | Image2Text Acc: 87.50 | Text2Image Acc: 90.23 | Data Time: 0.030s | Batch Time: 0.916s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:58:09 | INFO | Rank 0 | Global Steps: 1760/9780 | Train Epoch: 2 [200192/250368 (80%)] | Loss: 0.403304 | Image2Text Acc: 87.50 | Text2Image Acc: 87.50 | Data Time: 0.034s | Batch Time: 0.909s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:58:18 | INFO | Rank 0 | Global Steps: 1770/9780 | Train Epoch: 2 [202752/250368 (81%)] | Loss: 0.509172 | Image2Text Acc: 86.33 | Text2Image Acc: 85.55 | Data Time: 0.033s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:58:28 | INFO | Rank 0 | Global Steps: 1780/9780 | Train Epoch: 2 [205312/250368 (82%)] | Loss: 0.374274 | Image2Text Acc: 87.50 | Text2Image Acc: 87.11 | Data Time: 0.036s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:58:37 | INFO | Rank 0 | Global Steps: 1790/9780 | Train Epoch: 2 [207872/250368 (83%)] | Loss: 0.356328 | Image2Text Acc: 88.67 | Text2Image Acc: 89.06 | Data Time: 0.032s | Batch Time: 0.913s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:58:46 | INFO | Rank 2 | Begin to eval on validation set (epoch 2 @ 1800 steps)...
2024-06-01,21:58:46 | INFO | Rank 1 | Begin to eval on validation set (epoch 2 @ 1800 steps)...
2024-06-01,21:58:46 | INFO | Rank 3 | Begin to eval on validation set (epoch 2 @ 1800 steps)...
2024-06-01,21:58:46 | INFO | Rank 0 | Global Steps: 1800/9780 | Train Epoch: 2 [210432/250368 (84%)] | Loss: 0.479834 | Image2Text Acc: 83.98 | Text2Image Acc: 85.94 | Data Time: 0.036s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,21:58:46 | INFO | Rank 0 | Begin to eval on validation set (epoch 2 @ 1800 steps)...
2024-06-01,22:01:11 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,22:01:11 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,22:01:12 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,22:01:12 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,22:01:42 | INFO | Rank 3 | Validation Result (epoch 2 @ 1800 steps) | Valid Loss: 0.179121 | Image2Text Acc: 94.69 | Text2Image Acc: 94.12 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:01:42 | INFO | Rank 2 | Validation Result (epoch 2 @ 1800 steps) | Valid Loss: 0.179121 | Image2Text Acc: 94.69 | Text2Image Acc: 94.12 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:01:42 | INFO | Rank 1 | Validation Result (epoch 2 @ 1800 steps) | Valid Loss: 0.179121 | Image2Text Acc: 94.69 | Text2Image Acc: 94.12 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:01:42 | INFO | Rank 0 | Validation Result (epoch 2 @ 1800 steps) | Valid Loss: 0.179121 | Image2Text Acc: 94.69 | Text2Image Acc: 94.12 | logit_scale: 4.605 | Valid Batch Size: 64
0.17912136018276215 0.18004728853702545
0.17912136018276215 0.18004728853702545
0.17912136018276215 0.18004728853702545
0.17912136018276215 0.18004728853702545
2024-06-01,22:03:29 | INFO | Rank 1 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 2 @ 1799 steps)
2024-06-01,22:03:31 | INFO | Rank 2 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 2 @ 1799 steps)
2024-06-01,22:03:31 | INFO | Rank 3 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 2 @ 1799 steps)
2024-06-01,22:03:33 | INFO | Rank 0 | Saved best checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/best.pt (epoch 2 @ 1799 steps)
2024-06-01,22:03:42 | INFO | Rank 0 | Global Steps: 1810/9780 | Train Epoch: 2 [212992/250368 (85%)] | Loss: 0.458652 | Image2Text Acc: 86.33 | Text2Image Acc: 85.94 | Data Time: 0.031s | Batch Time: 0.931s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:03:51 | INFO | Rank 0 | Global Steps: 1820/9780 | Train Epoch: 2 [215552/250368 (86%)] | Loss: 0.442290 | Image2Text Acc: 85.55 | Text2Image Acc: 86.72 | Data Time: 0.034s | Batch Time: 0.919s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:04:01 | INFO | Rank 0 | Global Steps: 1830/9780 | Train Epoch: 2 [218112/250368 (87%)] | Loss: 0.480733 | Image2Text Acc: 89.06 | Text2Image Acc: 86.33 | Data Time: 0.035s | Batch Time: 0.917s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:04:10 | INFO | Rank 0 | Global Steps: 1840/9780 | Train Epoch: 2 [220672/250368 (88%)] | Loss: 0.490959 | Image2Text Acc: 84.38 | Text2Image Acc: 85.16 | Data Time: 0.037s | Batch Time: 0.915s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:04:19 | INFO | Rank 0 | Global Steps: 1850/9780 | Train Epoch: 2 [223232/250368 (89%)] | Loss: 0.412504 | Image2Text Acc: 85.94 | Text2Image Acc: 87.50 | Data Time: 0.032s | Batch Time: 0.915s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:04:28 | INFO | Rank 0 | Global Steps: 1860/9780 | Train Epoch: 2 [225792/250368 (90%)] | Loss: 0.404420 | Image2Text Acc: 87.50 | Text2Image Acc: 87.89 | Data Time: 0.029s | Batch Time: 0.903s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:04:37 | INFO | Rank 0 | Global Steps: 1870/9780 | Train Epoch: 2 [228352/250368 (91%)] | Loss: 0.336658 | Image2Text Acc: 89.45 | Text2Image Acc: 88.28 | Data Time: 0.033s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:04:47 | INFO | Rank 0 | Global Steps: 1880/9780 | Train Epoch: 2 [230912/250368 (92%)] | Loss: 0.479567 | Image2Text Acc: 85.16 | Text2Image Acc: 85.16 | Data Time: 0.040s | Batch Time: 0.927s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:04:56 | INFO | Rank 0 | Global Steps: 1890/9780 | Train Epoch: 2 [233472/250368 (93%)] | Loss: 0.446262 | Image2Text Acc: 88.67 | Text2Image Acc: 84.77 | Data Time: 0.029s | Batch Time: 0.921s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:05:05 | INFO | Rank 3 | Begin to eval on validation set (epoch 2 @ 1900 steps)...
2024-06-01,22:05:05 | INFO | Rank 1 | Begin to eval on validation set (epoch 2 @ 1900 steps)...
2024-06-01,22:05:05 | INFO | Rank 2 | Begin to eval on validation set (epoch 2 @ 1900 steps)...
2024-06-01,22:05:05 | INFO | Rank 0 | Global Steps: 1900/9780 | Train Epoch: 2 [236032/250368 (94%)] | Loss: 0.444095 | Image2Text Acc: 86.33 | Text2Image Acc: 83.59 | Data Time: 0.035s | Batch Time: 0.918s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:05:05 | INFO | Rank 0 | Begin to eval on validation set (epoch 2 @ 1900 steps)...
2024-06-01,22:07:30 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,22:07:30 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,22:07:30 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,22:07:31 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,22:08:01 | INFO | Rank 3 | Validation Result (epoch 2 @ 1900 steps) | Valid Loss: 0.181300 | Image2Text Acc: 94.67 | Text2Image Acc: 94.10 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:08:01 | INFO | Rank 1 | Validation Result (epoch 2 @ 1900 steps) | Valid Loss: 0.181300 | Image2Text Acc: 94.67 | Text2Image Acc: 94.10 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:08:01 | INFO | Rank 2 | Validation Result (epoch 2 @ 1900 steps) | Valid Loss: 0.181300 | Image2Text Acc: 94.67 | Text2Image Acc: 94.10 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:08:01 | INFO | Rank 0 | Validation Result (epoch 2 @ 1900 steps) | Valid Loss: 0.181300 | Image2Text Acc: 94.67 | Text2Image Acc: 94.10 | logit_scale: 4.605 | Valid Batch Size: 64
0.18130025267601013 0.17912136018276215
0.18130025267601013 0.17912136018276215
0.18130025267601013 0.17912136018276215
0.18130025267601013 0.17912136018276215
2024-06-01,22:08:10 | INFO | Rank 0 | Global Steps: 1910/9780 | Train Epoch: 2 [238592/250368 (95%)] | Loss: 0.616914 | Image2Text Acc: 82.03 | Text2Image Acc: 80.86 | Data Time: 0.032s | Batch Time: 0.918s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:08:19 | INFO | Rank 0 | Global Steps: 1920/9780 | Train Epoch: 2 [241152/250368 (96%)] | Loss: 0.531389 | Image2Text Acc: 84.77 | Text2Image Acc: 83.59 | Data Time: 0.030s | Batch Time: 0.915s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:08:28 | INFO | Rank 0 | Global Steps: 1930/9780 | Train Epoch: 2 [243712/250368 (97%)] | Loss: 0.393539 | Image2Text Acc: 86.72 | Text2Image Acc: 88.67 | Data Time: 0.031s | Batch Time: 0.905s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:08:38 | INFO | Rank 0 | Global Steps: 1940/9780 | Train Epoch: 2 [246272/250368 (98%)] | Loss: 0.735548 | Image2Text Acc: 83.20 | Text2Image Acc: 78.52 | Data Time: 0.036s | Batch Time: 0.908s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:08:47 | INFO | Rank 0 | Global Steps: 1950/9780 | Train Epoch: 2 [248832/250368 (99%)] | Loss: 0.514133 | Image2Text Acc: 84.77 | Text2Image Acc: 81.64 | Data Time: 0.031s | Batch Time: 0.916s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:08:53 | INFO | Rank 2 | Begin to eval on validation set (epoch 2 @ 1956 steps)...
2024-06-01,22:08:53 | INFO | Rank 3 | Begin to eval on validation set (epoch 2 @ 1956 steps)...
2024-06-01,22:08:53 | INFO | Rank 1 | Begin to eval on validation set (epoch 2 @ 1956 steps)...
2024-06-01,22:08:53 | INFO | Rank 0 | Begin to eval on validation set (epoch 2 @ 1956 steps)...
2024-06-01,22:11:18 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,22:11:18 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,22:11:18 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,22:11:19 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,22:11:49 | INFO | Rank 3 | Validation Result (epoch 2 @ 1956 steps) | Valid Loss: 0.181084 | Image2Text Acc: 94.63 | Text2Image Acc: 94.09 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:11:49 | INFO | Rank 1 | Validation Result (epoch 2 @ 1956 steps) | Valid Loss: 0.181084 | Image2Text Acc: 94.63 | Text2Image Acc: 94.09 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:11:49 | INFO | Rank 2 | Validation Result (epoch 2 @ 1956 steps) | Valid Loss: 0.181084 | Image2Text Acc: 94.63 | Text2Image Acc: 94.09 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:11:49 | INFO | Rank 0 | Validation Result (epoch 2 @ 1956 steps) | Valid Loss: 0.181084 | Image2Text Acc: 94.63 | Text2Image Acc: 94.09 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:11:49 | INFO | Rank 3 | train LMDB file contains 129380 images and 250314 pairs.
2024-06-01,22:11:49 | INFO | Rank 1 | train LMDB file contains 129380 images and 250314 pairs.
2024-06-01,22:11:49 | INFO | Rank 2 | train LMDB file contains 129380 images and 250314 pairs.
2024-06-01,22:11:49 | INFO | Rank 0 | train LMDB file contains 129380 images and 250314 pairs.
2024-06-01,22:11:49 | INFO | Rank 2 | val LMDB file contains 29806 images and 30588 pairs.
2024-06-01,22:11:49 | INFO | Rank 1 | val LMDB file contains 29806 images and 30588 pairs.
2024-06-01,22:11:49 | INFO | Rank 0 | val LMDB file contains 29806 images and 30588 pairs.
2024-06-01,22:11:49 | INFO | Rank 3 | val LMDB file contains 29806 images and 30588 pairs.
2024-06-01,22:11:49 | INFO | Rank 2 | Start epoch 3
2024-06-01,22:11:49 | INFO | Rank 1 | Start epoch 3
2024-06-01,22:11:49 | INFO | Rank 3 | Start epoch 3
2024-06-01,22:12:32 | INFO | Rank 0 | Saved checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/epoch2.pt (epoch 2 @ 1956 steps) (writing took 42.236459732055664 seconds)
2024-06-01,22:13:13 | INFO | Rank 0 | Saved checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/epoch_latest.pt (epoch 2 @ 1956 steps) (writing took 41.50518560409546 seconds)
2024-06-01,22:13:18 | INFO | Rank 0 | Global Steps: 1960/9780 | Train Epoch: 3 [1024/250368 (0%)] | Loss: 0.410743 | Image2Text Acc: 86.33 | Text2Image Acc: 87.89 | Data Time: 0.036s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:13:27 | INFO | Rank 0 | Global Steps: 1970/9780 | Train Epoch: 3 [3584/250368 (1%)] | Loss: 0.340839 | Image2Text Acc: 89.84 | Text2Image Acc: 88.67 | Data Time: 0.028s | Batch Time: 0.908s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:13:36 | INFO | Rank 0 | Global Steps: 1980/9780 | Train Epoch: 3 [6144/250368 (2%)] | Loss: 0.370327 | Image2Text Acc: 89.06 | Text2Image Acc: 89.45 | Data Time: 0.031s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:13:45 | INFO | Rank 0 | Global Steps: 1990/9780 | Train Epoch: 3 [8704/250368 (3%)] | Loss: 0.355258 | Image2Text Acc: 89.84 | Text2Image Acc: 89.06 | Data Time: 0.030s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:13:54 | INFO | Rank 2 | Begin to eval on validation set (epoch 3 @ 2000 steps)...
2024-06-01,22:13:54 | INFO | Rank 1 | Begin to eval on validation set (epoch 3 @ 2000 steps)...
2024-06-01,22:13:54 | INFO | Rank 3 | Begin to eval on validation set (epoch 3 @ 2000 steps)...
2024-06-01,22:13:54 | INFO | Rank 0 | Global Steps: 2000/9780 | Train Epoch: 3 [11264/250368 (4%)] | Loss: 0.407608 | Image2Text Acc: 88.28 | Text2Image Acc: 85.16 | Data Time: 0.031s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:13:54 | INFO | Rank 0 | Begin to eval on validation set (epoch 3 @ 2000 steps)...
2024-06-01,22:16:20 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,22:16:20 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,22:16:20 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,22:16:20 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,22:16:50 | INFO | Rank 1 | Validation Result (epoch 3 @ 2000 steps) | Valid Loss: 0.182370 | Image2Text Acc: 94.71 | Text2Image Acc: 94.05 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:16:50 | INFO | Rank 2 | Validation Result (epoch 3 @ 2000 steps) | Valid Loss: 0.182370 | Image2Text Acc: 94.71 | Text2Image Acc: 94.05 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:16:50 | INFO | Rank 3 | Validation Result (epoch 3 @ 2000 steps) | Valid Loss: 0.182370 | Image2Text Acc: 94.71 | Text2Image Acc: 94.05 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:16:50 | INFO | Rank 0 | Validation Result (epoch 3 @ 2000 steps) | Valid Loss: 0.182370 | Image2Text Acc: 94.71 | Text2Image Acc: 94.05 | logit_scale: 4.605 | Valid Batch Size: 64
0.18236954510211945 0.17912136018276215
0.18236954510211945 0.17912136018276215
0.18236954510211945 0.17912136018276215
0.18236954510211945 0.17912136018276215
2024-06-01,22:16:59 | INFO | Rank 0 | Global Steps: 2010/9780 | Train Epoch: 3 [13824/250368 (6%)] | Loss: 0.510933 | Image2Text Acc: 85.16 | Text2Image Acc: 85.94 | Data Time: 0.030s | Batch Time: 0.914s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:17:09 | INFO | Rank 0 | Global Steps: 2020/9780 | Train Epoch: 3 [16384/250368 (7%)] | Loss: 0.451494 | Image2Text Acc: 84.77 | Text2Image Acc: 87.11 | Data Time: 0.034s | Batch Time: 0.913s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:17:18 | INFO | Rank 0 | Global Steps: 2030/9780 | Train Epoch: 3 [18944/250368 (8%)] | Loss: 0.445961 | Image2Text Acc: 85.94 | Text2Image Acc: 87.89 | Data Time: 0.029s | Batch Time: 0.904s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:17:27 | INFO | Rank 0 | Global Steps: 2040/9780 | Train Epoch: 3 [21504/250368 (9%)] | Loss: 0.416486 | Image2Text Acc: 87.11 | Text2Image Acc: 85.55 | Data Time: 0.028s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:17:36 | INFO | Rank 0 | Global Steps: 2050/9780 | Train Epoch: 3 [24064/250368 (10%)] | Loss: 0.395821 | Image2Text Acc: 88.67 | Text2Image Acc: 85.16 | Data Time: 0.032s | Batch Time: 0.908s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:17:45 | INFO | Rank 0 | Global Steps: 2060/9780 | Train Epoch: 3 [26624/250368 (11%)] | Loss: 0.463446 | Image2Text Acc: 85.16 | Text2Image Acc: 89.06 | Data Time: 0.031s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:17:54 | INFO | Rank 0 | Global Steps: 2070/9780 | Train Epoch: 3 [29184/250368 (12%)] | Loss: 0.279859 | Image2Text Acc: 91.02 | Text2Image Acc: 89.06 | Data Time: 0.029s | Batch Time: 0.921s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:18:03 | INFO | Rank 0 | Global Steps: 2080/9780 | Train Epoch: 3 [31744/250368 (13%)] | Loss: 0.419364 | Image2Text Acc: 86.72 | Text2Image Acc: 87.50 | Data Time: 0.028s | Batch Time: 0.906s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:18:13 | INFO | Rank 0 | Global Steps: 2090/9780 | Train Epoch: 3 [34304/250368 (14%)] | Loss: 0.383829 | Image2Text Acc: 87.50 | Text2Image Acc: 88.67 | Data Time: 0.027s | Batch Time: 0.904s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:18:22 | INFO | Rank 2 | Begin to eval on validation set (epoch 3 @ 2100 steps)...
2024-06-01,22:18:22 | INFO | Rank 1 | Begin to eval on validation set (epoch 3 @ 2100 steps)...
2024-06-01,22:18:22 | INFO | Rank 3 | Begin to eval on validation set (epoch 3 @ 2100 steps)...
2024-06-01,22:18:22 | INFO | Rank 0 | Global Steps: 2100/9780 | Train Epoch: 3 [36864/250368 (15%)] | Loss: 0.401607 | Image2Text Acc: 89.45 | Text2Image Acc: 87.50 | Data Time: 0.032s | Batch Time: 0.923s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:18:22 | INFO | Rank 0 | Begin to eval on validation set (epoch 3 @ 2100 steps)...
2024-06-01,22:20:47 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,22:20:47 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,22:20:47 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,22:20:47 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,22:21:17 | INFO | Rank 3 | Validation Result (epoch 3 @ 2100 steps) | Valid Loss: 0.183943 | Image2Text Acc: 94.65 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:21:17 | INFO | Rank 1 | Validation Result (epoch 3 @ 2100 steps) | Valid Loss: 0.183943 | Image2Text Acc: 94.65 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:21:17 | INFO | Rank 2 | Validation Result (epoch 3 @ 2100 steps) | Valid Loss: 0.183943 | Image2Text Acc: 94.65 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:21:17 | INFO | Rank 0 | Validation Result (epoch 3 @ 2100 steps) | Valid Loss: 0.183943 | Image2Text Acc: 94.65 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
0.18394270539283752 0.17912136018276215
0.18394270539283752 0.17912136018276215
0.18394270539283752 0.17912136018276215
0.18394270539283752 0.17912136018276215
2024-06-01,22:21:26 | INFO | Rank 0 | Global Steps: 2110/9780 | Train Epoch: 3 [39424/250368 (16%)] | Loss: 0.396632 | Image2Text Acc: 87.89 | Text2Image Acc: 86.72 | Data Time: 0.027s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:21:35 | INFO | Rank 0 | Global Steps: 2120/9780 | Train Epoch: 3 [41984/250368 (17%)] | Loss: 0.527296 | Image2Text Acc: 83.98 | Text2Image Acc: 81.64 | Data Time: 0.034s | Batch Time: 0.917s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:21:45 | INFO | Rank 0 | Global Steps: 2130/9780 | Train Epoch: 3 [44544/250368 (18%)] | Loss: 0.443453 | Image2Text Acc: 87.11 | Text2Image Acc: 87.11 | Data Time: 0.029s | Batch Time: 0.903s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:21:54 | INFO | Rank 0 | Global Steps: 2140/9780 | Train Epoch: 3 [47104/250368 (19%)] | Loss: 0.381289 | Image2Text Acc: 89.45 | Text2Image Acc: 89.06 | Data Time: 0.028s | Batch Time: 0.920s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:22:03 | INFO | Rank 0 | Global Steps: 2150/9780 | Train Epoch: 3 [49664/250368 (20%)] | Loss: 0.378782 | Image2Text Acc: 87.11 | Text2Image Acc: 85.94 | Data Time: 0.030s | Batch Time: 0.905s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:22:12 | INFO | Rank 0 | Global Steps: 2160/9780 | Train Epoch: 3 [52224/250368 (21%)] | Loss: 0.401799 | Image2Text Acc: 85.55 | Text2Image Acc: 87.50 | Data Time: 0.028s | Batch Time: 0.913s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:22:21 | INFO | Rank 0 | Global Steps: 2170/9780 | Train Epoch: 3 [54784/250368 (22%)] | Loss: 0.441521 | Image2Text Acc: 86.72 | Text2Image Acc: 85.16 | Data Time: 0.027s | Batch Time: 0.915s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:22:30 | INFO | Rank 0 | Global Steps: 2180/9780 | Train Epoch: 3 [57344/250368 (23%)] | Loss: 0.326994 | Image2Text Acc: 90.62 | Text2Image Acc: 88.28 | Data Time: 0.030s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:22:39 | INFO | Rank 0 | Global Steps: 2190/9780 | Train Epoch: 3 [59904/250368 (24%)] | Loss: 0.388583 | Image2Text Acc: 89.45 | Text2Image Acc: 89.06 | Data Time: 0.032s | Batch Time: 0.923s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:22:49 | INFO | Rank 1 | Begin to eval on validation set (epoch 3 @ 2200 steps)...
2024-06-01,22:22:49 | INFO | Rank 3 | Begin to eval on validation set (epoch 3 @ 2200 steps)...
2024-06-01,22:22:49 | INFO | Rank 2 | Begin to eval on validation set (epoch 3 @ 2200 steps)...
2024-06-01,22:22:49 | INFO | Rank 0 | Global Steps: 2200/9780 | Train Epoch: 3 [62464/250368 (25%)] | Loss: 0.493406 | Image2Text Acc: 86.33 | Text2Image Acc: 83.59 | Data Time: 0.028s | Batch Time: 0.924s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:22:49 | INFO | Rank 0 | Begin to eval on validation set (epoch 3 @ 2200 steps)...
2024-06-01,22:25:14 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,22:25:14 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,22:25:14 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,22:25:15 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,22:25:44 | INFO | Rank 1 | Validation Result (epoch 3 @ 2200 steps) | Valid Loss: 0.184209 | Image2Text Acc: 94.69 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:25:44 | INFO | Rank 2 | Validation Result (epoch 3 @ 2200 steps) | Valid Loss: 0.184209 | Image2Text Acc: 94.69 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:25:44 | INFO | Rank 3 | Validation Result (epoch 3 @ 2200 steps) | Valid Loss: 0.184209 | Image2Text Acc: 94.69 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:25:44 | INFO | Rank 0 | Validation Result (epoch 3 @ 2200 steps) | Valid Loss: 0.184209 | Image2Text Acc: 94.69 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
0.1842089146375656 0.17912136018276215
0.1842089146375656 0.17912136018276215
0.1842089146375656 0.17912136018276215
0.1842089146375656 0.17912136018276215
2024-06-01,22:25:54 | INFO | Rank 0 | Global Steps: 2210/9780 | Train Epoch: 3 [65024/250368 (26%)] | Loss: 0.310850 | Image2Text Acc: 92.97 | Text2Image Acc: 89.84 | Data Time: 0.032s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:26:03 | INFO | Rank 0 | Global Steps: 2220/9780 | Train Epoch: 3 [67584/250368 (27%)] | Loss: 0.341319 | Image2Text Acc: 90.23 | Text2Image Acc: 91.80 | Data Time: 0.027s | Batch Time: 0.909s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:26:12 | INFO | Rank 0 | Global Steps: 2230/9780 | Train Epoch: 3 [70144/250368 (28%)] | Loss: 0.454093 | Image2Text Acc: 85.94 | Text2Image Acc: 85.94 | Data Time: 0.029s | Batch Time: 0.918s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:26:21 | INFO | Rank 0 | Global Steps: 2240/9780 | Train Epoch: 3 [72704/250368 (29%)] | Loss: 0.379924 | Image2Text Acc: 86.72 | Text2Image Acc: 90.23 | Data Time: 0.028s | Batch Time: 0.914s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:26:31 | INFO | Rank 0 | Global Steps: 2250/9780 | Train Epoch: 3 [75264/250368 (30%)] | Loss: 0.504443 | Image2Text Acc: 83.98 | Text2Image Acc: 85.94 | Data Time: 0.026s | Batch Time: 0.933s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:26:40 | INFO | Rank 0 | Global Steps: 2260/9780 | Train Epoch: 3 [77824/250368 (31%)] | Loss: 0.421877 | Image2Text Acc: 87.50 | Text2Image Acc: 87.11 | Data Time: 0.027s | Batch Time: 0.901s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:26:49 | INFO | Rank 0 | Global Steps: 2270/9780 | Train Epoch: 3 [80384/250368 (32%)] | Loss: 0.370287 | Image2Text Acc: 88.28 | Text2Image Acc: 90.23 | Data Time: 0.026s | Batch Time: 0.908s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:26:58 | INFO | Rank 0 | Global Steps: 2280/9780 | Train Epoch: 3 [82944/250368 (33%)] | Loss: 0.435610 | Image2Text Acc: 84.77 | Text2Image Acc: 85.55 | Data Time: 0.028s | Batch Time: 0.923s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:27:07 | INFO | Rank 0 | Global Steps: 2290/9780 | Train Epoch: 3 [85504/250368 (34%)] | Loss: 0.450526 | Image2Text Acc: 83.98 | Text2Image Acc: 85.16 | Data Time: 0.032s | Batch Time: 0.908s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:27:16 | INFO | Rank 2 | Begin to eval on validation set (epoch 3 @ 2300 steps)...
2024-06-01,22:27:16 | INFO | Rank 1 | Begin to eval on validation set (epoch 3 @ 2300 steps)...
2024-06-01,22:27:16 | INFO | Rank 3 | Begin to eval on validation set (epoch 3 @ 2300 steps)...
2024-06-01,22:27:16 | INFO | Rank 0 | Global Steps: 2300/9780 | Train Epoch: 3 [88064/250368 (35%)] | Loss: 0.479587 | Image2Text Acc: 86.33 | Text2Image Acc: 89.06 | Data Time: 0.030s | Batch Time: 0.905s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:27:16 | INFO | Rank 0 | Begin to eval on validation set (epoch 3 @ 2300 steps)...
2024-06-01,22:29:42 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,22:29:42 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,22:29:42 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,22:29:43 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,22:30:12 | INFO | Rank 2 | Validation Result (epoch 3 @ 2300 steps) | Valid Loss: 0.183097 | Image2Text Acc: 94.66 | Text2Image Acc: 94.03 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:30:12 | INFO | Rank 3 | Validation Result (epoch 3 @ 2300 steps) | Valid Loss: 0.183097 | Image2Text Acc: 94.66 | Text2Image Acc: 94.03 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:30:12 | INFO | Rank 1 | Validation Result (epoch 3 @ 2300 steps) | Valid Loss: 0.183097 | Image2Text Acc: 94.66 | Text2Image Acc: 94.03 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:30:12 | INFO | Rank 0 | Validation Result (epoch 3 @ 2300 steps) | Valid Loss: 0.183097 | Image2Text Acc: 94.66 | Text2Image Acc: 94.03 | logit_scale: 4.605 | Valid Batch Size: 64
0.18309718370437622 0.17912136018276215
0.18309718370437622 0.17912136018276215
0.18309718370437622 0.17912136018276215
0.18309718370437622 0.17912136018276215
2024-06-01,22:30:22 | INFO | Rank 0 | Global Steps: 2310/9780 | Train Epoch: 3 [90624/250368 (36%)] | Loss: 0.402679 | Image2Text Acc: 87.89 | Text2Image Acc: 86.33 | Data Time: 0.033s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:30:31 | INFO | Rank 0 | Global Steps: 2320/9780 | Train Epoch: 3 [93184/250368 (37%)] | Loss: 0.374424 | Image2Text Acc: 86.72 | Text2Image Acc: 87.50 | Data Time: 0.028s | Batch Time: 0.926s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:30:40 | INFO | Rank 0 | Global Steps: 2330/9780 | Train Epoch: 3 [95744/250368 (38%)] | Loss: 0.423270 | Image2Text Acc: 84.77 | Text2Image Acc: 85.94 | Data Time: 0.032s | Batch Time: 0.916s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:30:49 | INFO | Rank 0 | Global Steps: 2340/9780 | Train Epoch: 3 [98304/250368 (39%)] | Loss: 0.498422 | Image2Text Acc: 85.55 | Text2Image Acc: 83.98 | Data Time: 0.030s | Batch Time: 0.914s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:30:58 | INFO | Rank 0 | Global Steps: 2350/9780 | Train Epoch: 3 [100864/250368 (40%)] | Loss: 0.447327 | Image2Text Acc: 89.06 | Text2Image Acc: 86.72 | Data Time: 0.029s | Batch Time: 0.917s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:31:07 | INFO | Rank 0 | Global Steps: 2360/9780 | Train Epoch: 3 [103424/250368 (41%)] | Loss: 0.371912 | Image2Text Acc: 89.06 | Text2Image Acc: 91.02 | Data Time: 0.031s | Batch Time: 0.906s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:31:16 | INFO | Rank 0 | Global Steps: 2370/9780 | Train Epoch: 3 [105984/250368 (42%)] | Loss: 0.420544 | Image2Text Acc: 90.23 | Text2Image Acc: 85.94 | Data Time: 0.030s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:31:26 | INFO | Rank 0 | Global Steps: 2380/9780 | Train Epoch: 3 [108544/250368 (43%)] | Loss: 0.443673 | Image2Text Acc: 82.81 | Text2Image Acc: 85.16 | Data Time: 0.030s | Batch Time: 0.904s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:31:35 | INFO | Rank 0 | Global Steps: 2390/9780 | Train Epoch: 3 [111104/250368 (44%)] | Loss: 0.322195 | Image2Text Acc: 89.84 | Text2Image Acc: 92.58 | Data Time: 0.035s | Batch Time: 0.916s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:31:44 | INFO | Rank 3 | Begin to eval on validation set (epoch 3 @ 2400 steps)...
2024-06-01,22:31:44 | INFO | Rank 2 | Begin to eval on validation set (epoch 3 @ 2400 steps)...
2024-06-01,22:31:44 | INFO | Rank 1 | Begin to eval on validation set (epoch 3 @ 2400 steps)...
2024-06-01,22:31:44 | INFO | Rank 0 | Global Steps: 2400/9780 | Train Epoch: 3 [113664/250368 (45%)] | Loss: 0.374114 | Image2Text Acc: 85.16 | Text2Image Acc: 88.67 | Data Time: 0.028s | Batch Time: 0.927s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:31:44 | INFO | Rank 0 | Begin to eval on validation set (epoch 3 @ 2400 steps)...
2024-06-01,22:34:09 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,22:34:09 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,22:34:09 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,22:34:10 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,22:34:40 | INFO | Rank 2 | Validation Result (epoch 3 @ 2400 steps) | Valid Loss: 0.183504 | Image2Text Acc: 94.53 | Text2Image Acc: 94.08 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:34:40 | INFO | Rank 1 | Validation Result (epoch 3 @ 2400 steps) | Valid Loss: 0.183504 | Image2Text Acc: 94.53 | Text2Image Acc: 94.08 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:34:40 | INFO | Rank 3 | Validation Result (epoch 3 @ 2400 steps) | Valid Loss: 0.183504 | Image2Text Acc: 94.53 | Text2Image Acc: 94.08 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:34:40 | INFO | Rank 0 | Validation Result (epoch 3 @ 2400 steps) | Valid Loss: 0.183504 | Image2Text Acc: 94.53 | Text2Image Acc: 94.08 | logit_scale: 4.605 | Valid Batch Size: 64
0.18350423872470856 0.17912136018276215
0.18350423872470856 0.17912136018276215
0.18350423872470856 0.17912136018276215
0.18350423872470856 0.17912136018276215
2024-06-01,22:34:49 | INFO | Rank 0 | Global Steps: 2410/9780 | Train Epoch: 3 [116224/250368 (46%)] | Loss: 0.588348 | Image2Text Acc: 85.55 | Text2Image Acc: 81.64 | Data Time: 0.030s | Batch Time: 0.905s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:34:58 | INFO | Rank 0 | Global Steps: 2420/9780 | Train Epoch: 3 [118784/250368 (47%)] | Loss: 0.344556 | Image2Text Acc: 90.62 | Text2Image Acc: 89.84 | Data Time: 0.030s | Batch Time: 0.914s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:35:07 | INFO | Rank 0 | Global Steps: 2430/9780 | Train Epoch: 3 [121344/250368 (48%)] | Loss: 0.510528 | Image2Text Acc: 85.16 | Text2Image Acc: 82.42 | Data Time: 0.027s | Batch Time: 0.921s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:35:17 | INFO | Rank 0 | Global Steps: 2440/9780 | Train Epoch: 3 [123904/250368 (49%)] | Loss: 0.378537 | Image2Text Acc: 87.11 | Text2Image Acc: 89.45 | Data Time: 0.029s | Batch Time: 0.906s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:35:26 | INFO | Rank 0 | Global Steps: 2450/9780 | Train Epoch: 3 [126464/250368 (51%)] | Loss: 0.497895 | Image2Text Acc: 83.59 | Text2Image Acc: 82.42 | Data Time: 0.029s | Batch Time: 0.915s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:35:35 | INFO | Rank 0 | Global Steps: 2460/9780 | Train Epoch: 3 [129024/250368 (52%)] | Loss: 0.332210 | Image2Text Acc: 89.45 | Text2Image Acc: 88.28 | Data Time: 0.034s | Batch Time: 0.917s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:35:44 | INFO | Rank 0 | Global Steps: 2470/9780 | Train Epoch: 3 [131584/250368 (53%)] | Loss: 0.276710 | Image2Text Acc: 90.62 | Text2Image Acc: 91.02 | Data Time: 0.026s | Batch Time: 0.906s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:35:53 | INFO | Rank 0 | Global Steps: 2480/9780 | Train Epoch: 3 [134144/250368 (54%)] | Loss: 0.372228 | Image2Text Acc: 87.89 | Text2Image Acc: 86.72 | Data Time: 0.030s | Batch Time: 0.932s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:36:02 | INFO | Rank 0 | Global Steps: 2490/9780 | Train Epoch: 3 [136704/250368 (55%)] | Loss: 0.427682 | Image2Text Acc: 85.94 | Text2Image Acc: 86.33 | Data Time: 0.027s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:36:11 | INFO | Rank 2 | Begin to eval on validation set (epoch 3 @ 2500 steps)...
2024-06-01,22:36:11 | INFO | Rank 3 | Begin to eval on validation set (epoch 3 @ 2500 steps)...
2024-06-01,22:36:11 | INFO | Rank 1 | Begin to eval on validation set (epoch 3 @ 2500 steps)...
2024-06-01,22:36:11 | INFO | Rank 0 | Global Steps: 2500/9780 | Train Epoch: 3 [139264/250368 (56%)] | Loss: 0.337527 | Image2Text Acc: 89.84 | Text2Image Acc: 89.06 | Data Time: 0.033s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:36:11 | INFO | Rank 0 | Begin to eval on validation set (epoch 3 @ 2500 steps)...
2024-06-01,22:38:36 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,22:38:37 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,22:38:37 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,22:38:37 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,22:39:07 | INFO | Rank 1 | Validation Result (epoch 3 @ 2500 steps) | Valid Loss: 0.182755 | Image2Text Acc: 94.64 | Text2Image Acc: 94.04 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:39:07 | INFO | Rank 2 | Validation Result (epoch 3 @ 2500 steps) | Valid Loss: 0.182755 | Image2Text Acc: 94.64 | Text2Image Acc: 94.04 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:39:07 | INFO | Rank 3 | Validation Result (epoch 3 @ 2500 steps) | Valid Loss: 0.182755 | Image2Text Acc: 94.64 | Text2Image Acc: 94.04 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:39:07 | INFO | Rank 0 | Validation Result (epoch 3 @ 2500 steps) | Valid Loss: 0.182755 | Image2Text Acc: 94.64 | Text2Image Acc: 94.04 | logit_scale: 4.605 | Valid Batch Size: 64
0.18275514245033264 0.17912136018276215
0.18275514245033264 0.17912136018276215
0.18275514245033264 0.17912136018276215
0.18275514245033264 0.17912136018276215
2024-06-01,22:39:16 | INFO | Rank 0 | Global Steps: 2510/9780 | Train Epoch: 3 [141824/250368 (57%)] | Loss: 0.435385 | Image2Text Acc: 87.50 | Text2Image Acc: 86.72 | Data Time: 0.031s | Batch Time: 0.908s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:39:25 | INFO | Rank 0 | Global Steps: 2520/9780 | Train Epoch: 3 [144384/250368 (58%)] | Loss: 0.327045 | Image2Text Acc: 90.23 | Text2Image Acc: 89.45 | Data Time: 0.028s | Batch Time: 0.913s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:39:34 | INFO | Rank 0 | Global Steps: 2530/9780 | Train Epoch: 3 [146944/250368 (59%)] | Loss: 0.269719 | Image2Text Acc: 91.80 | Text2Image Acc: 92.19 | Data Time: 0.027s | Batch Time: 0.908s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:39:44 | INFO | Rank 0 | Global Steps: 2540/9780 | Train Epoch: 3 [149504/250368 (60%)] | Loss: 0.324223 | Image2Text Acc: 90.62 | Text2Image Acc: 90.62 | Data Time: 0.029s | Batch Time: 0.906s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:39:53 | INFO | Rank 0 | Global Steps: 2550/9780 | Train Epoch: 3 [152064/250368 (61%)] | Loss: 0.360172 | Image2Text Acc: 88.67 | Text2Image Acc: 88.67 | Data Time: 0.033s | Batch Time: 0.908s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:40:02 | INFO | Rank 0 | Global Steps: 2560/9780 | Train Epoch: 3 [154624/250368 (62%)] | Loss: 0.366655 | Image2Text Acc: 88.28 | Text2Image Acc: 86.72 | Data Time: 0.029s | Batch Time: 0.917s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:40:11 | INFO | Rank 0 | Global Steps: 2570/9780 | Train Epoch: 3 [157184/250368 (63%)] | Loss: 0.401632 | Image2Text Acc: 86.72 | Text2Image Acc: 86.72 | Data Time: 0.033s | Batch Time: 0.909s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:40:20 | INFO | Rank 0 | Global Steps: 2580/9780 | Train Epoch: 3 [159744/250368 (64%)] | Loss: 0.456348 | Image2Text Acc: 83.20 | Text2Image Acc: 85.55 | Data Time: 0.030s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:40:29 | INFO | Rank 0 | Global Steps: 2590/9780 | Train Epoch: 3 [162304/250368 (65%)] | Loss: 0.365292 | Image2Text Acc: 88.67 | Text2Image Acc: 88.67 | Data Time: 0.029s | Batch Time: 0.905s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:40:39 | INFO | Rank 3 | Begin to eval on validation set (epoch 3 @ 2600 steps)...
2024-06-01,22:40:39 | INFO | Rank 2 | Begin to eval on validation set (epoch 3 @ 2600 steps)...
2024-06-01,22:40:39 | INFO | Rank 1 | Begin to eval on validation set (epoch 3 @ 2600 steps)...
2024-06-01,22:40:39 | INFO | Rank 0 | Global Steps: 2600/9780 | Train Epoch: 3 [164864/250368 (66%)] | Loss: 0.514560 | Image2Text Acc: 85.16 | Text2Image Acc: 84.38 | Data Time: 0.027s | Batch Time: 0.913s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:40:39 | INFO | Rank 0 | Begin to eval on validation set (epoch 3 @ 2600 steps)...
2024-06-01,22:43:04 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,22:43:04 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,22:43:04 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,22:43:05 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,22:43:34 | INFO | Rank 2 | Validation Result (epoch 3 @ 2600 steps) | Valid Loss: 0.183008 | Image2Text Acc: 94.62 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:43:34 | INFO | Rank 3 | Validation Result (epoch 3 @ 2600 steps) | Valid Loss: 0.183008 | Image2Text Acc: 94.62 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:43:34 | INFO | Rank 1 | Validation Result (epoch 3 @ 2600 steps) | Valid Loss: 0.183008 | Image2Text Acc: 94.62 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:43:34 | INFO | Rank 0 | Validation Result (epoch 3 @ 2600 steps) | Valid Loss: 0.183008 | Image2Text Acc: 94.62 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
0.1830080896615982 0.17912136018276215
0.1830080896615982 0.17912136018276215
0.1830080896615982 0.17912136018276215
0.1830080896615982 0.17912136018276215
2024-06-01,22:43:43 | INFO | Rank 0 | Global Steps: 2610/9780 | Train Epoch: 3 [167424/250368 (67%)] | Loss: 0.326980 | Image2Text Acc: 90.62 | Text2Image Acc: 90.23 | Data Time: 0.026s | Batch Time: 0.913s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:43:53 | INFO | Rank 0 | Global Steps: 2620/9780 | Train Epoch: 3 [169984/250368 (68%)] | Loss: 0.406919 | Image2Text Acc: 86.33 | Text2Image Acc: 88.28 | Data Time: 0.031s | Batch Time: 0.905s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:44:02 | INFO | Rank 0 | Global Steps: 2630/9780 | Train Epoch: 3 [172544/250368 (69%)] | Loss: 0.445961 | Image2Text Acc: 87.89 | Text2Image Acc: 86.72 | Data Time: 0.033s | Batch Time: 0.919s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:44:11 | INFO | Rank 0 | Global Steps: 2640/9780 | Train Epoch: 3 [175104/250368 (70%)] | Loss: 0.346259 | Image2Text Acc: 87.89 | Text2Image Acc: 88.67 | Data Time: 0.031s | Batch Time: 0.906s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:44:20 | INFO | Rank 0 | Global Steps: 2650/9780 | Train Epoch: 3 [177664/250368 (71%)] | Loss: 0.382522 | Image2Text Acc: 87.11 | Text2Image Acc: 85.16 | Data Time: 0.030s | Batch Time: 0.907s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:44:29 | INFO | Rank 0 | Global Steps: 2660/9780 | Train Epoch: 3 [180224/250368 (72%)] | Loss: 0.390408 | Image2Text Acc: 87.50 | Text2Image Acc: 88.28 | Data Time: 0.028s | Batch Time: 0.923s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:44:38 | INFO | Rank 0 | Global Steps: 2670/9780 | Train Epoch: 3 [182784/250368 (73%)] | Loss: 0.440938 | Image2Text Acc: 87.50 | Text2Image Acc: 86.72 | Data Time: 0.032s | Batch Time: 0.920s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:44:47 | INFO | Rank 0 | Global Steps: 2680/9780 | Train Epoch: 3 [185344/250368 (74%)] | Loss: 0.329412 | Image2Text Acc: 87.89 | Text2Image Acc: 89.84 | Data Time: 0.032s | Batch Time: 0.905s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:44:56 | INFO | Rank 0 | Global Steps: 2690/9780 | Train Epoch: 3 [187904/250368 (75%)] | Loss: 0.332045 | Image2Text Acc: 89.84 | Text2Image Acc: 89.84 | Data Time: 0.037s | Batch Time: 0.922s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:45:06 | INFO | Rank 2 | Begin to eval on validation set (epoch 3 @ 2700 steps)...
2024-06-01,22:45:06 | INFO | Rank 3 | Begin to eval on validation set (epoch 3 @ 2700 steps)...
2024-06-01,22:45:06 | INFO | Rank 1 | Begin to eval on validation set (epoch 3 @ 2700 steps)...
2024-06-01,22:45:06 | INFO | Rank 0 | Global Steps: 2700/9780 | Train Epoch: 3 [190464/250368 (76%)] | Loss: 0.480841 | Image2Text Acc: 87.50 | Text2Image Acc: 84.77 | Data Time: 0.028s | Batch Time: 0.915s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:45:06 | INFO | Rank 0 | Begin to eval on validation set (epoch 3 @ 2700 steps)...
2024-06-01,22:47:31 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,22:47:31 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,22:47:31 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,22:47:32 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,22:48:01 | INFO | Rank 3 | Validation Result (epoch 3 @ 2700 steps) | Valid Loss: 0.182804 | Image2Text Acc: 94.65 | Text2Image Acc: 94.14 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:48:01 | INFO | Rank 1 | Validation Result (epoch 3 @ 2700 steps) | Valid Loss: 0.182804 | Image2Text Acc: 94.65 | Text2Image Acc: 94.14 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:48:01 | INFO | Rank 2 | Validation Result (epoch 3 @ 2700 steps) | Valid Loss: 0.182804 | Image2Text Acc: 94.65 | Text2Image Acc: 94.14 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:48:01 | INFO | Rank 0 | Validation Result (epoch 3 @ 2700 steps) | Valid Loss: 0.182804 | Image2Text Acc: 94.65 | Text2Image Acc: 94.14 | logit_scale: 4.605 | Valid Batch Size: 64
0.18280352652072906 0.17912136018276215
0.18280352652072906 0.17912136018276215
0.18280352652072906 0.17912136018276215
0.18280352652072906 0.17912136018276215
2024-06-01,22:48:10 | INFO | Rank 0 | Global Steps: 2710/9780 | Train Epoch: 3 [193024/250368 (77%)] | Loss: 0.350972 | Image2Text Acc: 86.33 | Text2Image Acc: 89.45 | Data Time: 0.031s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:48:20 | INFO | Rank 0 | Global Steps: 2720/9780 | Train Epoch: 3 [195584/250368 (78%)] | Loss: 0.364281 | Image2Text Acc: 89.84 | Text2Image Acc: 86.33 | Data Time: 0.030s | Batch Time: 0.932s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:48:29 | INFO | Rank 0 | Global Steps: 2730/9780 | Train Epoch: 3 [198144/250368 (79%)] | Loss: 0.482635 | Image2Text Acc: 87.89 | Text2Image Acc: 85.94 | Data Time: 0.028s | Batch Time: 0.914s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:48:38 | INFO | Rank 0 | Global Steps: 2740/9780 | Train Epoch: 3 [200704/250368 (80%)] | Loss: 0.356786 | Image2Text Acc: 88.67 | Text2Image Acc: 89.45 | Data Time: 0.031s | Batch Time: 0.914s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:48:47 | INFO | Rank 0 | Global Steps: 2750/9780 | Train Epoch: 3 [203264/250368 (81%)] | Loss: 0.313592 | Image2Text Acc: 88.28 | Text2Image Acc: 87.50 | Data Time: 0.027s | Batch Time: 0.920s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:48:56 | INFO | Rank 0 | Global Steps: 2760/9780 | Train Epoch: 3 [205824/250368 (82%)] | Loss: 0.441973 | Image2Text Acc: 87.11 | Text2Image Acc: 82.81 | Data Time: 0.027s | Batch Time: 0.907s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:49:05 | INFO | Rank 0 | Global Steps: 2770/9780 | Train Epoch: 3 [208384/250368 (83%)] | Loss: 0.452276 | Image2Text Acc: 85.55 | Text2Image Acc: 86.72 | Data Time: 0.026s | Batch Time: 0.902s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:49:14 | INFO | Rank 0 | Global Steps: 2780/9780 | Train Epoch: 3 [210944/250368 (84%)] | Loss: 0.347489 | Image2Text Acc: 90.62 | Text2Image Acc: 89.06 | Data Time: 0.028s | Batch Time: 0.904s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:49:24 | INFO | Rank 0 | Global Steps: 2790/9780 | Train Epoch: 3 [213504/250368 (85%)] | Loss: 0.320876 | Image2Text Acc: 90.23 | Text2Image Acc: 89.45 | Data Time: 0.031s | Batch Time: 0.907s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:49:33 | INFO | Rank 2 | Begin to eval on validation set (epoch 3 @ 2800 steps)...
2024-06-01,22:49:33 | INFO | Rank 3 | Begin to eval on validation set (epoch 3 @ 2800 steps)...
2024-06-01,22:49:33 | INFO | Rank 1 | Begin to eval on validation set (epoch 3 @ 2800 steps)...
2024-06-01,22:49:33 | INFO | Rank 0 | Global Steps: 2800/9780 | Train Epoch: 3 [216064/250368 (86%)] | Loss: 0.373006 | Image2Text Acc: 89.84 | Text2Image Acc: 89.06 | Data Time: 0.028s | Batch Time: 0.922s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:49:33 | INFO | Rank 0 | Begin to eval on validation set (epoch 3 @ 2800 steps)...
2024-06-01,22:51:58 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,22:51:58 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,22:51:58 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,22:51:59 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,22:52:28 | INFO | Rank 3 | Validation Result (epoch 3 @ 2800 steps) | Valid Loss: 0.185311 | Image2Text Acc: 94.63 | Text2Image Acc: 94.06 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:52:28 | INFO | Rank 2 | Validation Result (epoch 3 @ 2800 steps) | Valid Loss: 0.185311 | Image2Text Acc: 94.63 | Text2Image Acc: 94.06 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:52:28 | INFO | Rank 1 | Validation Result (epoch 3 @ 2800 steps) | Valid Loss: 0.185311 | Image2Text Acc: 94.63 | Text2Image Acc: 94.06 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:52:28 | INFO | Rank 0 | Validation Result (epoch 3 @ 2800 steps) | Valid Loss: 0.185311 | Image2Text Acc: 94.63 | Text2Image Acc: 94.06 | logit_scale: 4.605 | Valid Batch Size: 64
0.18531055748462677 0.17912136018276215
0.18531055748462677 0.17912136018276215
0.18531055748462677 0.17912136018276215
0.18531055748462677 0.17912136018276215
2024-06-01,22:52:38 | INFO | Rank 0 | Global Steps: 2810/9780 | Train Epoch: 3 [218624/250368 (87%)] | Loss: 0.476401 | Image2Text Acc: 85.16 | Text2Image Acc: 83.59 | Data Time: 0.027s | Batch Time: 0.921s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:52:47 | INFO | Rank 0 | Global Steps: 2820/9780 | Train Epoch: 3 [221184/250368 (88%)] | Loss: 0.475512 | Image2Text Acc: 86.33 | Text2Image Acc: 83.59 | Data Time: 0.029s | Batch Time: 0.924s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:52:56 | INFO | Rank 0 | Global Steps: 2830/9780 | Train Epoch: 3 [223744/250368 (89%)] | Loss: 0.414153 | Image2Text Acc: 87.11 | Text2Image Acc: 87.50 | Data Time: 0.028s | Batch Time: 0.909s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:53:05 | INFO | Rank 0 | Global Steps: 2840/9780 | Train Epoch: 3 [226304/250368 (90%)] | Loss: 0.378644 | Image2Text Acc: 87.89 | Text2Image Acc: 88.28 | Data Time: 0.033s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:53:14 | INFO | Rank 0 | Global Steps: 2850/9780 | Train Epoch: 3 [228864/250368 (91%)] | Loss: 0.331762 | Image2Text Acc: 91.80 | Text2Image Acc: 88.67 | Data Time: 0.037s | Batch Time: 0.913s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:53:23 | INFO | Rank 0 | Global Steps: 2860/9780 | Train Epoch: 3 [231424/250368 (92%)] | Loss: 0.350938 | Image2Text Acc: 88.67 | Text2Image Acc: 86.33 | Data Time: 0.028s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:53:33 | INFO | Rank 0 | Global Steps: 2870/9780 | Train Epoch: 3 [233984/250368 (93%)] | Loss: 0.464401 | Image2Text Acc: 85.55 | Text2Image Acc: 87.11 | Data Time: 0.030s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:53:42 | INFO | Rank 0 | Global Steps: 2880/9780 | Train Epoch: 3 [236544/250368 (94%)] | Loss: 0.505065 | Image2Text Acc: 85.94 | Text2Image Acc: 85.55 | Data Time: 0.034s | Batch Time: 0.911s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:53:51 | INFO | Rank 0 | Global Steps: 2890/9780 | Train Epoch: 3 [239104/250368 (96%)] | Loss: 0.436413 | Image2Text Acc: 84.77 | Text2Image Acc: 85.94 | Data Time: 0.028s | Batch Time: 0.924s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:54:00 | INFO | Rank 2 | Begin to eval on validation set (epoch 3 @ 2900 steps)...
2024-06-01,22:54:00 | INFO | Rank 1 | Begin to eval on validation set (epoch 3 @ 2900 steps)...
2024-06-01,22:54:00 | INFO | Rank 3 | Begin to eval on validation set (epoch 3 @ 2900 steps)...
2024-06-01,22:54:00 | INFO | Rank 0 | Global Steps: 2900/9780 | Train Epoch: 3 [241664/250368 (97%)] | Loss: 0.410267 | Image2Text Acc: 86.33 | Text2Image Acc: 86.72 | Data Time: 0.028s | Batch Time: 0.916s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:54:00 | INFO | Rank 0 | Begin to eval on validation set (epoch 3 @ 2900 steps)...
2024-06-01,22:56:25 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,22:56:26 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,22:56:26 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,22:56:26 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,22:56:55 | INFO | Rank 3 | Validation Result (epoch 3 @ 2900 steps) | Valid Loss: 0.184351 | Image2Text Acc: 94.57 | Text2Image Acc: 94.08 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:56:55 | INFO | Rank 1 | Validation Result (epoch 3 @ 2900 steps) | Valid Loss: 0.184351 | Image2Text Acc: 94.57 | Text2Image Acc: 94.08 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:56:55 | INFO | Rank 2 | Validation Result (epoch 3 @ 2900 steps) | Valid Loss: 0.184351 | Image2Text Acc: 94.57 | Text2Image Acc: 94.08 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,22:56:55 | INFO | Rank 0 | Validation Result (epoch 3 @ 2900 steps) | Valid Loss: 0.184351 | Image2Text Acc: 94.57 | Text2Image Acc: 94.08 | logit_scale: 4.605 | Valid Batch Size: 64
0.18435095250606537 0.17912136018276215
0.18435095250606537 0.17912136018276215
0.18435095250606537 0.17912136018276215
0.18435095250606537 0.17912136018276215
2024-06-01,22:57:05 | INFO | Rank 0 | Global Steps: 2910/9780 | Train Epoch: 3 [244224/250368 (98%)] | Loss: 0.414358 | Image2Text Acc: 87.11 | Text2Image Acc: 86.72 | Data Time: 0.030s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:57:14 | INFO | Rank 0 | Global Steps: 2920/9780 | Train Epoch: 3 [246784/250368 (99%)] | Loss: 0.334592 | Image2Text Acc: 88.67 | Text2Image Acc: 88.28 | Data Time: 0.036s | Batch Time: 0.918s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:57:23 | INFO | Rank 0 | Global Steps: 2930/9780 | Train Epoch: 3 [249344/250368 (100%)] | Loss: 0.392155 | Image2Text Acc: 87.11 | Text2Image Acc: 88.28 | Data Time: 0.029s | Batch Time: 0.904s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,22:57:27 | INFO | Rank 2 | Begin to eval on validation set (epoch 3 @ 2934 steps)...
2024-06-01,22:57:27 | INFO | Rank 1 | Begin to eval on validation set (epoch 3 @ 2934 steps)...
2024-06-01,22:57:27 | INFO | Rank 3 | Begin to eval on validation set (epoch 3 @ 2934 steps)...
2024-06-01,22:57:27 | INFO | Rank 0 | Begin to eval on validation set (epoch 3 @ 2934 steps)...
2024-06-01,22:59:52 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,22:59:52 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,22:59:53 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,22:59:53 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,23:00:22 | INFO | Rank 3 | Validation Result (epoch 3 @ 2934 steps) | Valid Loss: 0.182032 | Image2Text Acc: 94.58 | Text2Image Acc: 94.12 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:00:22 | INFO | Rank 2 | Validation Result (epoch 3 @ 2934 steps) | Valid Loss: 0.182032 | Image2Text Acc: 94.58 | Text2Image Acc: 94.12 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:00:22 | INFO | Rank 1 | Validation Result (epoch 3 @ 2934 steps) | Valid Loss: 0.182032 | Image2Text Acc: 94.58 | Text2Image Acc: 94.12 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:00:22 | INFO | Rank 0 | Validation Result (epoch 3 @ 2934 steps) | Valid Loss: 0.182032 | Image2Text Acc: 94.58 | Text2Image Acc: 94.12 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:00:23 | INFO | Rank 3 | train LMDB file contains 129380 images and 250314 pairs.
2024-06-01,23:00:23 | INFO | Rank 1 | train LMDB file contains 129380 images and 250314 pairs.
2024-06-01,23:00:23 | INFO | Rank 0 | train LMDB file contains 129380 images and 250314 pairs.
2024-06-01,23:00:23 | INFO | Rank 2 | train LMDB file contains 129380 images and 250314 pairs.
2024-06-01,23:00:23 | INFO | Rank 2 | val LMDB file contains 29806 images and 30588 pairs.
2024-06-01,23:00:23 | INFO | Rank 3 | val LMDB file contains 29806 images and 30588 pairs.
2024-06-01,23:00:23 | INFO | Rank 1 | val LMDB file contains 29806 images and 30588 pairs.
2024-06-01,23:00:23 | INFO | Rank 0 | val LMDB file contains 29806 images and 30588 pairs.
2024-06-01,23:00:23 | INFO | Rank 2 | Start epoch 4
2024-06-01,23:00:23 | INFO | Rank 3 | Start epoch 4
2024-06-01,23:00:23 | INFO | Rank 1 | Start epoch 4
2024-06-01,23:01:05 | INFO | Rank 0 | Saved checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/epoch3.pt (epoch 3 @ 2934 steps) (writing took 41.99067139625549 seconds)
2024-06-01,23:01:46 | INFO | Rank 0 | Saved checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/epoch_latest.pt (epoch 3 @ 2934 steps) (writing took 40.69957613945007 seconds)
2024-06-01,23:01:52 | INFO | Rank 0 | Global Steps: 2940/9780 | Train Epoch: 4 [1536/250368 (1%)] | Loss: 0.323240 | Image2Text Acc: 88.28 | Text2Image Acc: 89.06 | Data Time: 0.024s | Batch Time: 0.909s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:02:02 | INFO | Rank 0 | Global Steps: 2950/9780 | Train Epoch: 4 [4096/250368 (2%)] | Loss: 0.348457 | Image2Text Acc: 88.67 | Text2Image Acc: 89.84 | Data Time: 0.023s | Batch Time: 0.904s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:02:11 | INFO | Rank 0 | Global Steps: 2960/9780 | Train Epoch: 4 [6656/250368 (3%)] | Loss: 0.458182 | Image2Text Acc: 86.72 | Text2Image Acc: 85.16 | Data Time: 0.032s | Batch Time: 0.922s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:02:20 | INFO | Rank 0 | Global Steps: 2970/9780 | Train Epoch: 4 [9216/250368 (4%)] | Loss: 0.280541 | Image2Text Acc: 90.23 | Text2Image Acc: 91.80 | Data Time: 0.025s | Batch Time: 0.904s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:02:29 | INFO | Rank 0 | Global Steps: 2980/9780 | Train Epoch: 4 [11776/250368 (5%)] | Loss: 0.334379 | Image2Text Acc: 89.45 | Text2Image Acc: 87.89 | Data Time: 0.030s | Batch Time: 0.915s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:02:38 | INFO | Rank 0 | Global Steps: 2990/9780 | Train Epoch: 4 [14336/250368 (6%)] | Loss: 0.367237 | Image2Text Acc: 86.72 | Text2Image Acc: 87.89 | Data Time: 0.034s | Batch Time: 0.914s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:02:47 | INFO | Rank 3 | Begin to eval on validation set (epoch 4 @ 3000 steps)...
2024-06-01,23:02:47 | INFO | Rank 2 | Begin to eval on validation set (epoch 4 @ 3000 steps)...
2024-06-01,23:02:48 | INFO | Rank 1 | Begin to eval on validation set (epoch 4 @ 3000 steps)...
2024-06-01,23:02:48 | INFO | Rank 0 | Global Steps: 3000/9780 | Train Epoch: 4 [16896/250368 (7%)] | Loss: 0.367884 | Image2Text Acc: 88.28 | Text2Image Acc: 88.67 | Data Time: 0.035s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:02:48 | INFO | Rank 0 | Begin to eval on validation set (epoch 4 @ 3000 steps)...
2024-06-01,23:05:13 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,23:05:13 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,23:05:13 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,23:05:14 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,23:05:43 | INFO | Rank 3 | Validation Result (epoch 4 @ 3000 steps) | Valid Loss: 0.187174 | Image2Text Acc: 94.54 | Text2Image Acc: 94.06 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:05:43 | INFO | Rank 1 | Validation Result (epoch 4 @ 3000 steps) | Valid Loss: 0.187174 | Image2Text Acc: 94.54 | Text2Image Acc: 94.06 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:05:43 | INFO | Rank 2 | Validation Result (epoch 4 @ 3000 steps) | Valid Loss: 0.187174 | Image2Text Acc: 94.54 | Text2Image Acc: 94.06 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:05:43 | INFO | Rank 0 | Validation Result (epoch 4 @ 3000 steps) | Valid Loss: 0.187174 | Image2Text Acc: 94.54 | Text2Image Acc: 94.06 | logit_scale: 4.605 | Valid Batch Size: 64
0.187173992395401 0.17912136018276215
0.187173992395401 0.17912136018276215
0.187173992395401 0.17912136018276215
0.187173992395401 0.17912136018276215
2024-06-01,23:05:53 | INFO | Rank 0 | Global Steps: 3010/9780 | Train Epoch: 4 [19456/250368 (8%)] | Loss: 0.299004 | Image2Text Acc: 90.23 | Text2Image Acc: 88.28 | Data Time: 0.030s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:06:02 | INFO | Rank 0 | Global Steps: 3020/9780 | Train Epoch: 4 [22016/250368 (9%)] | Loss: 0.379207 | Image2Text Acc: 88.28 | Text2Image Acc: 88.28 | Data Time: 0.034s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:06:11 | INFO | Rank 0 | Global Steps: 3030/9780 | Train Epoch: 4 [24576/250368 (10%)] | Loss: 0.268110 | Image2Text Acc: 91.80 | Text2Image Acc: 92.97 | Data Time: 0.033s | Batch Time: 0.921s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:06:20 | INFO | Rank 0 | Global Steps: 3040/9780 | Train Epoch: 4 [27136/250368 (11%)] | Loss: 0.401573 | Image2Text Acc: 87.50 | Text2Image Acc: 86.33 | Data Time: 0.033s | Batch Time: 0.929s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:06:29 | INFO | Rank 0 | Global Steps: 3050/9780 | Train Epoch: 4 [29696/250368 (12%)] | Loss: 0.250998 | Image2Text Acc: 89.45 | Text2Image Acc: 90.62 | Data Time: 0.033s | Batch Time: 0.928s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:06:39 | INFO | Rank 0 | Global Steps: 3060/9780 | Train Epoch: 4 [32256/250368 (13%)] | Loss: 0.389876 | Image2Text Acc: 88.67 | Text2Image Acc: 88.28 | Data Time: 0.030s | Batch Time: 0.915s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:06:48 | INFO | Rank 0 | Global Steps: 3070/9780 | Train Epoch: 4 [34816/250368 (14%)] | Loss: 0.356033 | Image2Text Acc: 88.67 | Text2Image Acc: 85.16 | Data Time: 0.034s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:06:57 | INFO | Rank 0 | Global Steps: 3080/9780 | Train Epoch: 4 [37376/250368 (15%)] | Loss: 0.420492 | Image2Text Acc: 89.06 | Text2Image Acc: 86.33 | Data Time: 0.034s | Batch Time: 0.920s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:07:06 | INFO | Rank 0 | Global Steps: 3090/9780 | Train Epoch: 4 [39936/250368 (16%)] | Loss: 0.394017 | Image2Text Acc: 86.72 | Text2Image Acc: 87.89 | Data Time: 0.039s | Batch Time: 0.916s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:07:15 | INFO | Rank 1 | Begin to eval on validation set (epoch 4 @ 3100 steps)...
2024-06-01,23:07:15 | INFO | Rank 2 | Begin to eval on validation set (epoch 4 @ 3100 steps)...
2024-06-01,23:07:15 | INFO | Rank 3 | Begin to eval on validation set (epoch 4 @ 3100 steps)...
2024-06-01,23:07:15 | INFO | Rank 0 | Global Steps: 3100/9780 | Train Epoch: 4 [42496/250368 (17%)] | Loss: 0.347480 | Image2Text Acc: 90.23 | Text2Image Acc: 87.11 | Data Time: 0.031s | Batch Time: 0.905s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:07:15 | INFO | Rank 0 | Begin to eval on validation set (epoch 4 @ 3100 steps)...
2024-06-01,23:09:40 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,23:09:40 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,23:09:41 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,23:09:42 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,23:10:11 | INFO | Rank 3 | Validation Result (epoch 4 @ 3100 steps) | Valid Loss: 0.188253 | Image2Text Acc: 94.51 | Text2Image Acc: 94.13 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:10:11 | INFO | Rank 1 | Validation Result (epoch 4 @ 3100 steps) | Valid Loss: 0.188253 | Image2Text Acc: 94.51 | Text2Image Acc: 94.13 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:10:11 | INFO | Rank 2 | Validation Result (epoch 4 @ 3100 steps) | Valid Loss: 0.188253 | Image2Text Acc: 94.51 | Text2Image Acc: 94.13 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:10:11 | INFO | Rank 0 | Validation Result (epoch 4 @ 3100 steps) | Valid Loss: 0.188253 | Image2Text Acc: 94.51 | Text2Image Acc: 94.13 | logit_scale: 4.605 | Valid Batch Size: 64
0.18825317919254303 0.17912136018276215
0.18825317919254303 0.17912136018276215
0.18825317919254303 0.17912136018276215
0.18825317919254303 0.17912136018276215
2024-06-01,23:10:21 | INFO | Rank 0 | Global Steps: 3110/9780 | Train Epoch: 4 [45056/250368 (18%)] | Loss: 0.396503 | Image2Text Acc: 87.50 | Text2Image Acc: 87.50 | Data Time: 0.037s | Batch Time: 0.916s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:10:30 | INFO | Rank 0 | Global Steps: 3120/9780 | Train Epoch: 4 [47616/250368 (19%)] | Loss: 0.356315 | Image2Text Acc: 91.02 | Text2Image Acc: 90.23 | Data Time: 0.035s | Batch Time: 0.927s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:10:39 | INFO | Rank 0 | Global Steps: 3130/9780 | Train Epoch: 4 [50176/250368 (20%)] | Loss: 0.459609 | Image2Text Acc: 85.94 | Text2Image Acc: 83.59 | Data Time: 0.032s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:10:48 | INFO | Rank 0 | Global Steps: 3140/9780 | Train Epoch: 4 [52736/250368 (21%)] | Loss: 0.291988 | Image2Text Acc: 89.84 | Text2Image Acc: 90.23 | Data Time: 0.027s | Batch Time: 0.907s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:10:57 | INFO | Rank 0 | Global Steps: 3150/9780 | Train Epoch: 4 [55296/250368 (22%)] | Loss: 0.273241 | Image2Text Acc: 89.45 | Text2Image Acc: 92.19 | Data Time: 0.033s | Batch Time: 0.909s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:11:06 | INFO | Rank 0 | Global Steps: 3160/9780 | Train Epoch: 4 [57856/250368 (23%)] | Loss: 0.292414 | Image2Text Acc: 92.97 | Text2Image Acc: 89.84 | Data Time: 0.038s | Batch Time: 0.912s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:11:16 | INFO | Rank 0 | Global Steps: 3170/9780 | Train Epoch: 4 [60416/250368 (24%)] | Loss: 0.385710 | Image2Text Acc: 89.06 | Text2Image Acc: 88.28 | Data Time: 0.034s | Batch Time: 0.920s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:11:25 | INFO | Rank 0 | Global Steps: 3180/9780 | Train Epoch: 4 [62976/250368 (25%)] | Loss: 0.351618 | Image2Text Acc: 86.72 | Text2Image Acc: 89.06 | Data Time: 0.029s | Batch Time: 0.919s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:11:34 | INFO | Rank 0 | Global Steps: 3190/9780 | Train Epoch: 4 [65536/250368 (26%)] | Loss: 0.240392 | Image2Text Acc: 92.97 | Text2Image Acc: 92.19 | Data Time: 0.031s | Batch Time: 0.918s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:11:43 | INFO | Rank 3 | Begin to eval on validation set (epoch 4 @ 3200 steps)...
2024-06-01,23:11:43 | INFO | Rank 2 | Begin to eval on validation set (epoch 4 @ 3200 steps)...
2024-06-01,23:11:43 | INFO | Rank 1 | Begin to eval on validation set (epoch 4 @ 3200 steps)...
2024-06-01,23:11:43 | INFO | Rank 0 | Global Steps: 3200/9780 | Train Epoch: 4 [68096/250368 (27%)] | Loss: 0.379928 | Image2Text Acc: 86.72 | Text2Image Acc: 87.11 | Data Time: 0.053s | Batch Time: 0.932s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:11:43 | INFO | Rank 0 | Begin to eval on validation set (epoch 4 @ 3200 steps)...
2024-06-01,23:14:08 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,23:14:09 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,23:14:09 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,23:14:09 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,23:14:38 | INFO | Rank 3 | Validation Result (epoch 4 @ 3200 steps) | Valid Loss: 0.189674 | Image2Text Acc: 94.46 | Text2Image Acc: 94.10 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:14:38 | INFO | Rank 1 | Validation Result (epoch 4 @ 3200 steps) | Valid Loss: 0.189674 | Image2Text Acc: 94.46 | Text2Image Acc: 94.10 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:14:38 | INFO | Rank 2 | Validation Result (epoch 4 @ 3200 steps) | Valid Loss: 0.189674 | Image2Text Acc: 94.46 | Text2Image Acc: 94.10 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:14:38 | INFO | Rank 0 | Validation Result (epoch 4 @ 3200 steps) | Valid Loss: 0.189674 | Image2Text Acc: 94.46 | Text2Image Acc: 94.10 | logit_scale: 4.605 | Valid Batch Size: 64
0.18967412412166595 0.17912136018276215
0.18967412412166595 0.17912136018276215
0.18967412412166595 0.17912136018276215
0.18967412412166595 0.17912136018276215
2024-06-01,23:14:48 | INFO | Rank 0 | Global Steps: 3210/9780 | Train Epoch: 4 [70656/250368 (28%)] | Loss: 0.363046 | Image2Text Acc: 85.94 | Text2Image Acc: 86.33 | Data Time: 0.030s | Batch Time: 0.907s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:14:57 | INFO | Rank 0 | Global Steps: 3220/9780 | Train Epoch: 4 [73216/250368 (29%)] | Loss: 0.259033 | Image2Text Acc: 92.58 | Text2Image Acc: 92.19 | Data Time: 0.032s | Batch Time: 0.914s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:15:06 | INFO | Rank 0 | Global Steps: 3230/9780 | Train Epoch: 4 [75776/250368 (30%)] | Loss: 0.442089 | Image2Text Acc: 87.11 | Text2Image Acc: 87.11 | Data Time: 0.032s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:15:15 | INFO | Rank 0 | Global Steps: 3240/9780 | Train Epoch: 4 [78336/250368 (31%)] | Loss: 0.310775 | Image2Text Acc: 91.41 | Text2Image Acc: 92.58 | Data Time: 0.033s | Batch Time: 0.913s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:15:25 | INFO | Rank 0 | Global Steps: 3250/9780 | Train Epoch: 4 [80896/250368 (32%)] | Loss: 0.368448 | Image2Text Acc: 89.06 | Text2Image Acc: 87.11 | Data Time: 0.036s | Batch Time: 0.925s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:15:34 | INFO | Rank 0 | Global Steps: 3260/9780 | Train Epoch: 4 [83456/250368 (33%)] | Loss: 0.353708 | Image2Text Acc: 86.72 | Text2Image Acc: 89.45 | Data Time: 0.031s | Batch Time: 0.907s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:15:43 | INFO | Rank 0 | Global Steps: 3270/9780 | Train Epoch: 4 [86016/250368 (34%)] | Loss: 0.329224 | Image2Text Acc: 87.50 | Text2Image Acc: 89.45 | Data Time: 0.047s | Batch Time: 0.920s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:15:52 | INFO | Rank 0 | Global Steps: 3280/9780 | Train Epoch: 4 [88576/250368 (35%)] | Loss: 0.389267 | Image2Text Acc: 87.11 | Text2Image Acc: 87.50 | Data Time: 0.036s | Batch Time: 0.917s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:16:01 | INFO | Rank 0 | Global Steps: 3290/9780 | Train Epoch: 4 [91136/250368 (36%)] | Loss: 0.314447 | Image2Text Acc: 87.89 | Text2Image Acc: 91.41 | Data Time: 0.034s | Batch Time: 0.907s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:16:10 | INFO | Rank 3 | Begin to eval on validation set (epoch 4 @ 3300 steps)...
2024-06-01,23:16:10 | INFO | Rank 1 | Begin to eval on validation set (epoch 4 @ 3300 steps)...
2024-06-01,23:16:10 | INFO | Rank 2 | Begin to eval on validation set (epoch 4 @ 3300 steps)...
2024-06-01,23:16:10 | INFO | Rank 0 | Global Steps: 3300/9780 | Train Epoch: 4 [93696/250368 (37%)] | Loss: 0.325041 | Image2Text Acc: 88.67 | Text2Image Acc: 89.84 | Data Time: 0.035s | Batch Time: 0.910s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:16:10 | INFO | Rank 0 | Begin to eval on validation set (epoch 4 @ 3300 steps)...
2024-06-01,23:18:35 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,23:18:36 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,23:18:36 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,23:18:36 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,23:19:06 | INFO | Rank 1 | Validation Result (epoch 4 @ 3300 steps) | Valid Loss: 0.189391 | Image2Text Acc: 94.52 | Text2Image Acc: 94.06 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:19:06 | INFO | Rank 3 | Validation Result (epoch 4 @ 3300 steps) | Valid Loss: 0.189391 | Image2Text Acc: 94.52 | Text2Image Acc: 94.06 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:19:06 | INFO | Rank 2 | Validation Result (epoch 4 @ 3300 steps) | Valid Loss: 0.189391 | Image2Text Acc: 94.52 | Text2Image Acc: 94.06 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:19:06 | INFO | Rank 0 | Validation Result (epoch 4 @ 3300 steps) | Valid Loss: 0.189391 | Image2Text Acc: 94.52 | Text2Image Acc: 94.06 | logit_scale: 4.605 | Valid Batch Size: 64
0.1893913596868515 0.17912136018276215
0.1893913596868515 0.17912136018276215
0.1893913596868515 0.17912136018276215
0.1893913596868515 0.17912136018276215
2024-06-01,23:19:15 | INFO | Rank 0 | Global Steps: 3310/9780 | Train Epoch: 4 [96256/250368 (38%)] | Loss: 0.386500 | Image2Text Acc: 88.28 | Text2Image Acc: 88.28 | Data Time: 0.036s | Batch Time: 0.979s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:19:24 | INFO | Rank 0 | Global Steps: 3320/9780 | Train Epoch: 4 [98816/250368 (39%)] | Loss: 0.444049 | Image2Text Acc: 85.55 | Text2Image Acc: 87.50 | Data Time: 0.039s | Batch Time: 0.914s | LR: 0.000002 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:19:34 | INFO | Rank 0 | Global Steps: 3330/9780 | Train Epoch: 4 [101376/250368 (40%)] | Loss: 0.391010 | Image2Text Acc: 86.33 | Text2Image Acc: 87.11 | Data Time: 0.029s | Batch Time: 0.917s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:19:43 | INFO | Rank 0 | Global Steps: 3340/9780 | Train Epoch: 4 [103936/250368 (42%)] | Loss: 0.323565 | Image2Text Acc: 89.06 | Text2Image Acc: 89.06 | Data Time: 0.034s | Batch Time: 0.912s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:19:52 | INFO | Rank 0 | Global Steps: 3350/9780 | Train Epoch: 4 [106496/250368 (43%)] | Loss: 0.351530 | Image2Text Acc: 87.11 | Text2Image Acc: 87.50 | Data Time: 0.029s | Batch Time: 0.903s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:20:01 | INFO | Rank 0 | Global Steps: 3360/9780 | Train Epoch: 4 [109056/250368 (44%)] | Loss: 0.273647 | Image2Text Acc: 91.80 | Text2Image Acc: 91.80 | Data Time: 0.032s | Batch Time: 0.919s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:20:10 | INFO | Rank 0 | Global Steps: 3370/9780 | Train Epoch: 4 [111616/250368 (45%)] | Loss: 0.457089 | Image2Text Acc: 83.98 | Text2Image Acc: 85.16 | Data Time: 0.027s | Batch Time: 0.901s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:20:19 | INFO | Rank 0 | Global Steps: 3380/9780 | Train Epoch: 4 [114176/250368 (46%)] | Loss: 0.316729 | Image2Text Acc: 92.19 | Text2Image Acc: 92.58 | Data Time: 0.035s | Batch Time: 0.930s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:20:29 | INFO | Rank 0 | Global Steps: 3390/9780 | Train Epoch: 4 [116736/250368 (47%)] | Loss: 0.324231 | Image2Text Acc: 90.23 | Text2Image Acc: 89.45 | Data Time: 0.034s | Batch Time: 0.909s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:20:38 | INFO | Rank 2 | Begin to eval on validation set (epoch 4 @ 3400 steps)...
2024-06-01,23:20:38 | INFO | Rank 3 | Begin to eval on validation set (epoch 4 @ 3400 steps)...
2024-06-01,23:20:38 | INFO | Rank 1 | Begin to eval on validation set (epoch 4 @ 3400 steps)...
2024-06-01,23:20:38 | INFO | Rank 0 | Global Steps: 3400/9780 | Train Epoch: 4 [119296/250368 (48%)] | Loss: 0.302675 | Image2Text Acc: 90.62 | Text2Image Acc: 89.45 | Data Time: 0.041s | Batch Time: 0.915s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:20:38 | INFO | Rank 0 | Begin to eval on validation set (epoch 4 @ 3400 steps)...
2024-06-01,23:23:03 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,23:23:03 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,23:23:03 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,23:23:04 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,23:23:33 | INFO | Rank 3 | Validation Result (epoch 4 @ 3400 steps) | Valid Loss: 0.190372 | Image2Text Acc: 94.52 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:23:33 | INFO | Rank 1 | Validation Result (epoch 4 @ 3400 steps) | Valid Loss: 0.190372 | Image2Text Acc: 94.52 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:23:33 | INFO | Rank 2 | Validation Result (epoch 4 @ 3400 steps) | Valid Loss: 0.190372 | Image2Text Acc: 94.52 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:23:33 | INFO | Rank 0 | Validation Result (epoch 4 @ 3400 steps) | Valid Loss: 0.190372 | Image2Text Acc: 94.52 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
0.1903723180294037 0.17912136018276215
0.1903723180294037 0.17912136018276215
0.1903723180294037 0.17912136018276215
0.1903723180294037 0.17912136018276215
2024-06-01,23:23:43 | INFO | Rank 0 | Global Steps: 3410/9780 | Train Epoch: 4 [121856/250368 (49%)] | Loss: 0.368379 | Image2Text Acc: 90.62 | Text2Image Acc: 87.50 | Data Time: 0.043s | Batch Time: 0.915s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:23:52 | INFO | Rank 0 | Global Steps: 3420/9780 | Train Epoch: 4 [124416/250368 (50%)] | Loss: 0.359945 | Image2Text Acc: 86.72 | Text2Image Acc: 87.50 | Data Time: 0.035s | Batch Time: 0.912s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:24:01 | INFO | Rank 0 | Global Steps: 3430/9780 | Train Epoch: 4 [126976/250368 (51%)] | Loss: 0.306377 | Image2Text Acc: 90.62 | Text2Image Acc: 90.62 | Data Time: 0.040s | Batch Time: 0.914s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:24:10 | INFO | Rank 0 | Global Steps: 3440/9780 | Train Epoch: 4 [129536/250368 (52%)] | Loss: 0.416855 | Image2Text Acc: 87.50 | Text2Image Acc: 85.94 | Data Time: 0.027s | Batch Time: 0.911s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:24:19 | INFO | Rank 0 | Global Steps: 3450/9780 | Train Epoch: 4 [132096/250368 (53%)] | Loss: 0.412501 | Image2Text Acc: 85.16 | Text2Image Acc: 85.94 | Data Time: 0.034s | Batch Time: 0.918s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:24:28 | INFO | Rank 0 | Global Steps: 3460/9780 | Train Epoch: 4 [134656/250368 (54%)] | Loss: 0.374692 | Image2Text Acc: 87.89 | Text2Image Acc: 89.06 | Data Time: 0.031s | Batch Time: 0.907s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:24:38 | INFO | Rank 0 | Global Steps: 3470/9780 | Train Epoch: 4 [137216/250368 (55%)] | Loss: 0.353664 | Image2Text Acc: 87.89 | Text2Image Acc: 87.50 | Data Time: 0.037s | Batch Time: 0.916s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:24:47 | INFO | Rank 0 | Global Steps: 3480/9780 | Train Epoch: 4 [139776/250368 (56%)] | Loss: 0.358585 | Image2Text Acc: 89.06 | Text2Image Acc: 89.06 | Data Time: 0.034s | Batch Time: 0.934s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:24:56 | INFO | Rank 0 | Global Steps: 3490/9780 | Train Epoch: 4 [142336/250368 (57%)] | Loss: 0.348051 | Image2Text Acc: 89.84 | Text2Image Acc: 89.06 | Data Time: 0.031s | Batch Time: 0.921s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:25:05 | INFO | Rank 3 | Begin to eval on validation set (epoch 4 @ 3500 steps)...
2024-06-01,23:25:05 | INFO | Rank 1 | Begin to eval on validation set (epoch 4 @ 3500 steps)...
2024-06-01,23:25:05 | INFO | Rank 2 | Begin to eval on validation set (epoch 4 @ 3500 steps)...
2024-06-01,23:25:05 | INFO | Rank 0 | Global Steps: 3500/9780 | Train Epoch: 4 [144896/250368 (58%)] | Loss: 0.320777 | Image2Text Acc: 89.06 | Text2Image Acc: 90.62 | Data Time: 0.036s | Batch Time: 0.910s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:25:05 | INFO | Rank 0 | Begin to eval on validation set (epoch 4 @ 3500 steps)...
2024-06-01,23:27:30 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,23:27:30 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,23:27:31 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,23:27:31 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,23:28:01 | INFO | Rank 3 | Validation Result (epoch 4 @ 3500 steps) | Valid Loss: 0.189152 | Image2Text Acc: 94.49 | Text2Image Acc: 94.09 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:28:01 | INFO | Rank 2 | Validation Result (epoch 4 @ 3500 steps) | Valid Loss: 0.189152 | Image2Text Acc: 94.49 | Text2Image Acc: 94.09 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:28:01 | INFO | Rank 1 | Validation Result (epoch 4 @ 3500 steps) | Valid Loss: 0.189152 | Image2Text Acc: 94.49 | Text2Image Acc: 94.09 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:28:01 | INFO | Rank 0 | Validation Result (epoch 4 @ 3500 steps) | Valid Loss: 0.189152 | Image2Text Acc: 94.49 | Text2Image Acc: 94.09 | logit_scale: 4.605 | Valid Batch Size: 64
0.18915162980556488 0.17912136018276215
0.18915162980556488 0.17912136018276215
0.18915162980556488 0.17912136018276215
0.18915162980556488 0.17912136018276215
2024-06-01,23:28:10 | INFO | Rank 0 | Global Steps: 3510/9780 | Train Epoch: 4 [147456/250368 (59%)] | Loss: 0.355037 | Image2Text Acc: 87.89 | Text2Image Acc: 88.67 | Data Time: 0.035s | Batch Time: 0.910s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:28:19 | INFO | Rank 0 | Global Steps: 3520/9780 | Train Epoch: 4 [150016/250368 (60%)] | Loss: 0.444848 | Image2Text Acc: 85.94 | Text2Image Acc: 86.33 | Data Time: 0.034s | Batch Time: 0.915s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:28:29 | INFO | Rank 0 | Global Steps: 3530/9780 | Train Epoch: 4 [152576/250368 (61%)] | Loss: 0.416109 | Image2Text Acc: 85.16 | Text2Image Acc: 85.16 | Data Time: 0.034s | Batch Time: 0.908s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:28:38 | INFO | Rank 0 | Global Steps: 3540/9780 | Train Epoch: 4 [155136/250368 (62%)] | Loss: 0.364862 | Image2Text Acc: 89.84 | Text2Image Acc: 89.45 | Data Time: 0.034s | Batch Time: 0.915s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:28:47 | INFO | Rank 0 | Global Steps: 3550/9780 | Train Epoch: 4 [157696/250368 (63%)] | Loss: 0.391825 | Image2Text Acc: 85.16 | Text2Image Acc: 87.50 | Data Time: 0.034s | Batch Time: 0.913s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:28:56 | INFO | Rank 0 | Global Steps: 3560/9780 | Train Epoch: 4 [160256/250368 (64%)] | Loss: 0.296437 | Image2Text Acc: 88.67 | Text2Image Acc: 90.62 | Data Time: 0.032s | Batch Time: 0.918s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:29:05 | INFO | Rank 0 | Global Steps: 3570/9780 | Train Epoch: 4 [162816/250368 (65%)] | Loss: 0.328780 | Image2Text Acc: 91.02 | Text2Image Acc: 89.45 | Data Time: 0.036s | Batch Time: 0.919s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:29:14 | INFO | Rank 0 | Global Steps: 3580/9780 | Train Epoch: 4 [165376/250368 (66%)] | Loss: 0.286914 | Image2Text Acc: 90.62 | Text2Image Acc: 91.41 | Data Time: 0.040s | Batch Time: 0.925s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:29:23 | INFO | Rank 0 | Global Steps: 3590/9780 | Train Epoch: 4 [167936/250368 (67%)] | Loss: 0.296624 | Image2Text Acc: 91.02 | Text2Image Acc: 91.02 | Data Time: 0.035s | Batch Time: 0.915s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:29:33 | INFO | Rank 3 | Begin to eval on validation set (epoch 4 @ 3600 steps)...
2024-06-01,23:29:33 | INFO | Rank 1 | Begin to eval on validation set (epoch 4 @ 3600 steps)...
2024-06-01,23:29:33 | INFO | Rank 2 | Begin to eval on validation set (epoch 4 @ 3600 steps)...
2024-06-01,23:29:33 | INFO | Rank 0 | Global Steps: 3600/9780 | Train Epoch: 4 [170496/250368 (68%)] | Loss: 0.363477 | Image2Text Acc: 87.50 | Text2Image Acc: 89.06 | Data Time: 0.039s | Batch Time: 0.915s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:29:33 | INFO | Rank 0 | Begin to eval on validation set (epoch 4 @ 3600 steps)...
2024-06-01,23:31:58 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,23:31:58 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,23:31:58 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,23:31:59 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,23:32:28 | INFO | Rank 1 | Validation Result (epoch 4 @ 3600 steps) | Valid Loss: 0.189569 | Image2Text Acc: 94.55 | Text2Image Acc: 94.06 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:32:28 | INFO | Rank 3 | Validation Result (epoch 4 @ 3600 steps) | Valid Loss: 0.189569 | Image2Text Acc: 94.55 | Text2Image Acc: 94.06 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:32:28 | INFO | Rank 2 | Validation Result (epoch 4 @ 3600 steps) | Valid Loss: 0.189569 | Image2Text Acc: 94.55 | Text2Image Acc: 94.06 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:32:28 | INFO | Rank 0 | Validation Result (epoch 4 @ 3600 steps) | Valid Loss: 0.189569 | Image2Text Acc: 94.55 | Text2Image Acc: 94.06 | logit_scale: 4.605 | Valid Batch Size: 64
0.1895686239004135 0.17912136018276215
0.1895686239004135 0.17912136018276215
0.1895686239004135 0.17912136018276215
0.1895686239004135 0.17912136018276215
2024-06-01,23:32:38 | INFO | Rank 0 | Global Steps: 3610/9780 | Train Epoch: 4 [173056/250368 (69%)] | Loss: 0.261316 | Image2Text Acc: 91.80 | Text2Image Acc: 91.80 | Data Time: 0.035s | Batch Time: 0.911s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:32:47 | INFO | Rank 0 | Global Steps: 3620/9780 | Train Epoch: 4 [175616/250368 (70%)] | Loss: 0.422355 | Image2Text Acc: 89.06 | Text2Image Acc: 87.50 | Data Time: 0.033s | Batch Time: 0.912s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:32:56 | INFO | Rank 0 | Global Steps: 3630/9780 | Train Epoch: 4 [178176/250368 (71%)] | Loss: 0.331180 | Image2Text Acc: 88.67 | Text2Image Acc: 89.45 | Data Time: 0.033s | Batch Time: 0.907s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:33:05 | INFO | Rank 0 | Global Steps: 3640/9780 | Train Epoch: 4 [180736/250368 (72%)] | Loss: 0.354688 | Image2Text Acc: 89.06 | Text2Image Acc: 88.67 | Data Time: 0.030s | Batch Time: 0.914s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:33:14 | INFO | Rank 0 | Global Steps: 3650/9780 | Train Epoch: 4 [183296/250368 (73%)] | Loss: 0.290070 | Image2Text Acc: 89.45 | Text2Image Acc: 89.45 | Data Time: 0.032s | Batch Time: 0.909s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:33:23 | INFO | Rank 0 | Global Steps: 3660/9780 | Train Epoch: 4 [185856/250368 (74%)] | Loss: 0.411926 | Image2Text Acc: 88.67 | Text2Image Acc: 85.16 | Data Time: 0.035s | Batch Time: 0.922s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:33:32 | INFO | Rank 0 | Global Steps: 3670/9780 | Train Epoch: 4 [188416/250368 (75%)] | Loss: 0.327031 | Image2Text Acc: 87.50 | Text2Image Acc: 90.62 | Data Time: 0.032s | Batch Time: 0.921s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:33:42 | INFO | Rank 0 | Global Steps: 3680/9780 | Train Epoch: 4 [190976/250368 (76%)] | Loss: 0.378947 | Image2Text Acc: 89.45 | Text2Image Acc: 88.67 | Data Time: 0.034s | Batch Time: 0.919s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:33:51 | INFO | Rank 0 | Global Steps: 3690/9780 | Train Epoch: 4 [193536/250368 (77%)] | Loss: 0.470249 | Image2Text Acc: 86.72 | Text2Image Acc: 85.55 | Data Time: 0.032s | Batch Time: 0.910s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:34:00 | INFO | Rank 2 | Begin to eval on validation set (epoch 4 @ 3700 steps)...
2024-06-01,23:34:00 | INFO | Rank 1 | Begin to eval on validation set (epoch 4 @ 3700 steps)...
2024-06-01,23:34:00 | INFO | Rank 3 | Begin to eval on validation set (epoch 4 @ 3700 steps)...
2024-06-01,23:34:00 | INFO | Rank 0 | Global Steps: 3700/9780 | Train Epoch: 4 [196096/250368 (78%)] | Loss: 0.484700 | Image2Text Acc: 84.77 | Text2Image Acc: 85.94 | Data Time: 0.033s | Batch Time: 0.911s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:34:00 | INFO | Rank 0 | Begin to eval on validation set (epoch 4 @ 3700 steps)...
2024-06-01,23:36:25 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,23:36:25 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,23:36:26 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,23:36:26 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,23:36:55 | INFO | Rank 3 | Validation Result (epoch 4 @ 3700 steps) | Valid Loss: 0.189717 | Image2Text Acc: 94.53 | Text2Image Acc: 94.05 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:36:55 | INFO | Rank 1 | Validation Result (epoch 4 @ 3700 steps) | Valid Loss: 0.189717 | Image2Text Acc: 94.53 | Text2Image Acc: 94.05 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:36:55 | INFO | Rank 2 | Validation Result (epoch 4 @ 3700 steps) | Valid Loss: 0.189717 | Image2Text Acc: 94.53 | Text2Image Acc: 94.05 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:36:55 | INFO | Rank 0 | Validation Result (epoch 4 @ 3700 steps) | Valid Loss: 0.189717 | Image2Text Acc: 94.53 | Text2Image Acc: 94.05 | logit_scale: 4.605 | Valid Batch Size: 64
0.18971720337867737 0.17912136018276215
0.18971720337867737 0.17912136018276215
0.18971720337867737 0.17912136018276215
0.18971720337867737 0.17912136018276215
2024-06-01,23:37:05 | INFO | Rank 0 | Global Steps: 3710/9780 | Train Epoch: 4 [198656/250368 (79%)] | Loss: 0.254563 | Image2Text Acc: 91.80 | Text2Image Acc: 91.02 | Data Time: 0.037s | Batch Time: 0.911s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:37:14 | INFO | Rank 0 | Global Steps: 3720/9780 | Train Epoch: 4 [201216/250368 (80%)] | Loss: 0.381938 | Image2Text Acc: 90.23 | Text2Image Acc: 86.72 | Data Time: 0.034s | Batch Time: 0.915s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:37:23 | INFO | Rank 0 | Global Steps: 3730/9780 | Train Epoch: 4 [203776/250368 (81%)] | Loss: 0.401361 | Image2Text Acc: 85.55 | Text2Image Acc: 89.06 | Data Time: 0.035s | Batch Time: 0.911s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:37:32 | INFO | Rank 0 | Global Steps: 3740/9780 | Train Epoch: 4 [206336/250368 (82%)] | Loss: 0.352864 | Image2Text Acc: 88.28 | Text2Image Acc: 84.77 | Data Time: 0.033s | Batch Time: 0.914s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:37:41 | INFO | Rank 0 | Global Steps: 3750/9780 | Train Epoch: 4 [208896/250368 (83%)] | Loss: 0.426843 | Image2Text Acc: 86.72 | Text2Image Acc: 87.50 | Data Time: 0.031s | Batch Time: 0.914s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:37:50 | INFO | Rank 0 | Global Steps: 3760/9780 | Train Epoch: 4 [211456/250368 (84%)] | Loss: 0.283668 | Image2Text Acc: 88.67 | Text2Image Acc: 91.41 | Data Time: 0.037s | Batch Time: 0.911s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:38:00 | INFO | Rank 0 | Global Steps: 3770/9780 | Train Epoch: 4 [214016/250368 (85%)] | Loss: 0.405428 | Image2Text Acc: 87.11 | Text2Image Acc: 85.55 | Data Time: 0.035s | Batch Time: 0.912s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:38:09 | INFO | Rank 0 | Global Steps: 3780/9780 | Train Epoch: 4 [216576/250368 (87%)] | Loss: 0.419025 | Image2Text Acc: 85.94 | Text2Image Acc: 86.33 | Data Time: 0.036s | Batch Time: 0.917s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:38:18 | INFO | Rank 0 | Global Steps: 3790/9780 | Train Epoch: 4 [219136/250368 (88%)] | Loss: 0.353459 | Image2Text Acc: 87.11 | Text2Image Acc: 88.28 | Data Time: 0.038s | Batch Time: 0.917s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:38:27 | INFO | Rank 2 | Begin to eval on validation set (epoch 4 @ 3800 steps)...
2024-06-01,23:38:27 | INFO | Rank 3 | Begin to eval on validation set (epoch 4 @ 3800 steps)...
2024-06-01,23:38:27 | INFO | Rank 1 | Begin to eval on validation set (epoch 4 @ 3800 steps)...
2024-06-01,23:38:27 | INFO | Rank 0 | Global Steps: 3800/9780 | Train Epoch: 4 [221696/250368 (89%)] | Loss: 0.214174 | Image2Text Acc: 92.97 | Text2Image Acc: 92.97 | Data Time: 0.039s | Batch Time: 0.913s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:38:27 | INFO | Rank 0 | Begin to eval on validation set (epoch 4 @ 3800 steps)...
2024-06-01,23:40:52 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,23:40:52 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,23:40:53 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,23:40:53 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,23:41:22 | INFO | Rank 3 | Validation Result (epoch 4 @ 3800 steps) | Valid Loss: 0.188184 | Image2Text Acc: 94.56 | Text2Image Acc: 94.10 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:41:22 | INFO | Rank 2 | Validation Result (epoch 4 @ 3800 steps) | Valid Loss: 0.188184 | Image2Text Acc: 94.56 | Text2Image Acc: 94.10 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:41:22 | INFO | Rank 1 | Validation Result (epoch 4 @ 3800 steps) | Valid Loss: 0.188184 | Image2Text Acc: 94.56 | Text2Image Acc: 94.10 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:41:22 | INFO | Rank 0 | Validation Result (epoch 4 @ 3800 steps) | Valid Loss: 0.188184 | Image2Text Acc: 94.56 | Text2Image Acc: 94.10 | logit_scale: 4.605 | Valid Batch Size: 64
0.18818360567092896 0.17912136018276215
0.18818360567092896 0.17912136018276215
0.18818360567092896 0.17912136018276215
0.18818360567092896 0.17912136018276215
2024-06-01,23:41:32 | INFO | Rank 0 | Global Steps: 3810/9780 | Train Epoch: 4 [224256/250368 (90%)] | Loss: 0.407725 | Image2Text Acc: 85.94 | Text2Image Acc: 86.33 | Data Time: 0.031s | Batch Time: 0.907s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:41:41 | INFO | Rank 0 | Global Steps: 3820/9780 | Train Epoch: 4 [226816/250368 (91%)] | Loss: 0.335422 | Image2Text Acc: 90.23 | Text2Image Acc: 86.33 | Data Time: 0.031s | Batch Time: 0.923s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:41:50 | INFO | Rank 0 | Global Steps: 3830/9780 | Train Epoch: 4 [229376/250368 (92%)] | Loss: 0.299471 | Image2Text Acc: 89.84 | Text2Image Acc: 89.06 | Data Time: 0.037s | Batch Time: 0.915s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:41:59 | INFO | Rank 0 | Global Steps: 3840/9780 | Train Epoch: 4 [231936/250368 (93%)] | Loss: 0.383050 | Image2Text Acc: 90.62 | Text2Image Acc: 88.67 | Data Time: 0.027s | Batch Time: 0.903s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:42:08 | INFO | Rank 0 | Global Steps: 3850/9780 | Train Epoch: 4 [234496/250368 (94%)] | Loss: 0.302214 | Image2Text Acc: 88.67 | Text2Image Acc: 91.41 | Data Time: 0.034s | Batch Time: 0.909s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:42:18 | INFO | Rank 0 | Global Steps: 3860/9780 | Train Epoch: 4 [237056/250368 (95%)] | Loss: 0.279741 | Image2Text Acc: 91.80 | Text2Image Acc: 90.62 | Data Time: 0.031s | Batch Time: 0.915s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:42:27 | INFO | Rank 0 | Global Steps: 3870/9780 | Train Epoch: 4 [239616/250368 (96%)] | Loss: 0.357047 | Image2Text Acc: 89.06 | Text2Image Acc: 88.28 | Data Time: 0.038s | Batch Time: 0.913s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:42:36 | INFO | Rank 0 | Global Steps: 3880/9780 | Train Epoch: 4 [242176/250368 (97%)] | Loss: 0.364989 | Image2Text Acc: 85.94 | Text2Image Acc: 86.33 | Data Time: 0.039s | Batch Time: 0.913s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:42:45 | INFO | Rank 0 | Global Steps: 3890/9780 | Train Epoch: 4 [244736/250368 (98%)] | Loss: 0.314717 | Image2Text Acc: 91.02 | Text2Image Acc: 89.84 | Data Time: 0.034s | Batch Time: 0.916s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:42:54 | INFO | Rank 3 | Begin to eval on validation set (epoch 4 @ 3900 steps)...
2024-06-01,23:42:54 | INFO | Rank 2 | Begin to eval on validation set (epoch 4 @ 3900 steps)...
2024-06-01,23:42:54 | INFO | Rank 1 | Begin to eval on validation set (epoch 4 @ 3900 steps)...
2024-06-01,23:42:54 | INFO | Rank 0 | Global Steps: 3900/9780 | Train Epoch: 4 [247296/250368 (99%)] | Loss: 0.417957 | Image2Text Acc: 87.11 | Text2Image Acc: 87.11 | Data Time: 0.027s | Batch Time: 0.913s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:42:54 | INFO | Rank 0 | Begin to eval on validation set (epoch 4 @ 3900 steps)...
2024-06-01,23:45:19 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,23:45:20 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,23:45:20 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,23:45:20 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,23:45:50 | INFO | Rank 3 | Validation Result (epoch 4 @ 3900 steps) | Valid Loss: 0.187631 | Image2Text Acc: 94.60 | Text2Image Acc: 94.07 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:45:50 | INFO | Rank 2 | Validation Result (epoch 4 @ 3900 steps) | Valid Loss: 0.187631 | Image2Text Acc: 94.60 | Text2Image Acc: 94.07 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:45:50 | INFO | Rank 1 | Validation Result (epoch 4 @ 3900 steps) | Valid Loss: 0.187631 | Image2Text Acc: 94.60 | Text2Image Acc: 94.07 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:45:50 | INFO | Rank 0 | Validation Result (epoch 4 @ 3900 steps) | Valid Loss: 0.187631 | Image2Text Acc: 94.60 | Text2Image Acc: 94.07 | logit_scale: 4.605 | Valid Batch Size: 64
0.1876310408115387 0.17912136018276215
0.1876310408115387 0.17912136018276215
0.1876310408115387 0.17912136018276215
0.1876310408115387 0.17912136018276215
2024-06-01,23:45:59 | INFO | Rank 0 | Global Steps: 3910/9780 | Train Epoch: 4 [249856/250368 (100%)] | Loss: 0.288919 | Image2Text Acc: 89.84 | Text2Image Acc: 88.28 | Data Time: 0.030s | Batch Time: 0.909s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:46:01 | INFO | Rank 2 | Begin to eval on validation set (epoch 4 @ 3912 steps)...
2024-06-01,23:46:01 | INFO | Rank 3 | Begin to eval on validation set (epoch 4 @ 3912 steps)...
2024-06-01,23:46:01 | INFO | Rank 1 | Begin to eval on validation set (epoch 4 @ 3912 steps)...
2024-06-01,23:46:01 | INFO | Rank 0 | Begin to eval on validation set (epoch 4 @ 3912 steps)...
2024-06-01,23:48:26 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,23:48:26 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,23:48:27 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,23:48:27 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,23:48:56 | INFO | Rank 2 | Validation Result (epoch 4 @ 3912 steps) | Valid Loss: 0.188046 | Image2Text Acc: 94.61 | Text2Image Acc: 94.08 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:48:56 | INFO | Rank 3 | Validation Result (epoch 4 @ 3912 steps) | Valid Loss: 0.188046 | Image2Text Acc: 94.61 | Text2Image Acc: 94.08 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:48:56 | INFO | Rank 1 | Validation Result (epoch 4 @ 3912 steps) | Valid Loss: 0.188046 | Image2Text Acc: 94.61 | Text2Image Acc: 94.08 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:48:56 | INFO | Rank 0 | Validation Result (epoch 4 @ 3912 steps) | Valid Loss: 0.188046 | Image2Text Acc: 94.61 | Text2Image Acc: 94.08 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:48:57 | INFO | Rank 2 | train LMDB file contains 129380 images and 250314 pairs.
2024-06-01,23:48:57 | INFO | Rank 1 | train LMDB file contains 129380 images and 250314 pairs.
2024-06-01,23:48:57 | INFO | Rank 3 | train LMDB file contains 129380 images and 250314 pairs.
2024-06-01,23:48:57 | INFO | Rank 0 | train LMDB file contains 129380 images and 250314 pairs.
2024-06-01,23:48:57 | INFO | Rank 1 | val LMDB file contains 29806 images and 30588 pairs.
2024-06-01,23:48:57 | INFO | Rank 3 | val LMDB file contains 29806 images and 30588 pairs.
2024-06-01,23:48:57 | INFO | Rank 0 | val LMDB file contains 29806 images and 30588 pairs.
2024-06-01,23:48:57 | INFO | Rank 3 | Start epoch 5
2024-06-01,23:48:57 | INFO | Rank 2 | val LMDB file contains 29806 images and 30588 pairs.
2024-06-01,23:48:57 | INFO | Rank 1 | Start epoch 5
2024-06-01,23:48:57 | INFO | Rank 2 | Start epoch 5
2024-06-01,23:49:40 | INFO | Rank 0 | Saved checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/epoch4.pt (epoch 4 @ 3912 steps) (writing took 42.43649411201477 seconds)
2024-06-01,23:50:20 | INFO | Rank 0 | Saved checkpoint /mnt/petrelfs/lijiaxing1/lijiaxing/Chinese-CLIP/data/experiments/li_finetune_6.1_2_vit-h-14_roberta-base_bs128_4gpu/checkpoints/epoch_latest.pt (epoch 4 @ 3912 steps) (writing took 40.144763708114624 seconds)
2024-06-01,23:50:28 | INFO | Rank 0 | Global Steps: 3920/9780 | Train Epoch: 5 [2048/250368 (1%)] | Loss: 0.229140 | Image2Text Acc: 93.36 | Text2Image Acc: 92.97 | Data Time: 0.027s | Batch Time: 0.910s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:50:37 | INFO | Rank 0 | Global Steps: 3930/9780 | Train Epoch: 5 [4608/250368 (2%)] | Loss: 0.311295 | Image2Text Acc: 91.02 | Text2Image Acc: 92.19 | Data Time: 0.027s | Batch Time: 0.911s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:50:46 | INFO | Rank 0 | Global Steps: 3940/9780 | Train Epoch: 5 [7168/250368 (3%)] | Loss: 0.330897 | Image2Text Acc: 88.67 | Text2Image Acc: 91.02 | Data Time: 0.027s | Batch Time: 0.911s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:50:55 | INFO | Rank 0 | Global Steps: 3950/9780 | Train Epoch: 5 [9728/250368 (4%)] | Loss: 0.324395 | Image2Text Acc: 90.62 | Text2Image Acc: 90.23 | Data Time: 0.031s | Batch Time: 0.911s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:51:05 | INFO | Rank 0 | Global Steps: 3960/9780 | Train Epoch: 5 [12288/250368 (5%)] | Loss: 0.294363 | Image2Text Acc: 91.02 | Text2Image Acc: 91.02 | Data Time: 0.028s | Batch Time: 0.914s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:51:14 | INFO | Rank 0 | Global Steps: 3970/9780 | Train Epoch: 5 [14848/250368 (6%)] | Loss: 0.337313 | Image2Text Acc: 89.06 | Text2Image Acc: 90.23 | Data Time: 0.027s | Batch Time: 0.911s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:51:23 | INFO | Rank 0 | Global Steps: 3980/9780 | Train Epoch: 5 [17408/250368 (7%)] | Loss: 0.342279 | Image2Text Acc: 89.06 | Text2Image Acc: 88.28 | Data Time: 0.030s | Batch Time: 0.911s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:51:32 | INFO | Rank 0 | Global Steps: 3990/9780 | Train Epoch: 5 [19968/250368 (8%)] | Loss: 0.319833 | Image2Text Acc: 91.02 | Text2Image Acc: 88.67 | Data Time: 0.034s | Batch Time: 0.919s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:51:41 | INFO | Rank 3 | Begin to eval on validation set (epoch 5 @ 4000 steps)...
2024-06-01,23:51:41 | INFO | Rank 1 | Begin to eval on validation set (epoch 5 @ 4000 steps)...
2024-06-01,23:51:41 | INFO | Rank 2 | Begin to eval on validation set (epoch 5 @ 4000 steps)...
2024-06-01,23:51:41 | INFO | Rank 0 | Global Steps: 4000/9780 | Train Epoch: 5 [22528/250368 (9%)] | Loss: 0.289998 | Image2Text Acc: 89.45 | Text2Image Acc: 88.67 | Data Time: 0.036s | Batch Time: 0.919s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:51:41 | INFO | Rank 0 | Begin to eval on validation set (epoch 5 @ 4000 steps)...
2024-06-01,23:54:06 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,23:54:07 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,23:54:07 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,23:54:07 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,23:54:37 | INFO | Rank 2 | Validation Result (epoch 5 @ 4000 steps) | Valid Loss: 0.192928 | Image2Text Acc: 94.47 | Text2Image Acc: 94.01 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:54:37 | INFO | Rank 1 | Validation Result (epoch 5 @ 4000 steps) | Valid Loss: 0.192928 | Image2Text Acc: 94.47 | Text2Image Acc: 94.01 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:54:37 | INFO | Rank 3 | Validation Result (epoch 5 @ 4000 steps) | Valid Loss: 0.192928 | Image2Text Acc: 94.47 | Text2Image Acc: 94.01 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:54:37 | INFO | Rank 0 | Validation Result (epoch 5 @ 4000 steps) | Valid Loss: 0.192928 | Image2Text Acc: 94.47 | Text2Image Acc: 94.01 | logit_scale: 4.605 | Valid Batch Size: 64
0.19292815029621124 0.17912136018276215
0.19292815029621124 0.17912136018276215
0.19292815029621124 0.17912136018276215
0.19292815029621124 0.17912136018276215
2024-06-01,23:54:46 | INFO | Rank 0 | Global Steps: 4010/9780 | Train Epoch: 5 [25088/250368 (10%)] | Loss: 0.283049 | Image2Text Acc: 91.02 | Text2Image Acc: 89.84 | Data Time: 0.033s | Batch Time: 0.909s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:54:56 | INFO | Rank 0 | Global Steps: 4020/9780 | Train Epoch: 5 [27648/250368 (11%)] | Loss: 0.224649 | Image2Text Acc: 93.36 | Text2Image Acc: 92.58 | Data Time: 0.035s | Batch Time: 0.907s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:55:05 | INFO | Rank 0 | Global Steps: 4030/9780 | Train Epoch: 5 [30208/250368 (12%)] | Loss: 0.276096 | Image2Text Acc: 90.23 | Text2Image Acc: 89.84 | Data Time: 0.030s | Batch Time: 0.922s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:55:14 | INFO | Rank 0 | Global Steps: 4040/9780 | Train Epoch: 5 [32768/250368 (13%)] | Loss: 0.261444 | Image2Text Acc: 90.23 | Text2Image Acc: 90.23 | Data Time: 0.029s | Batch Time: 0.905s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:55:23 | INFO | Rank 0 | Global Steps: 4050/9780 | Train Epoch: 5 [35328/250368 (14%)] | Loss: 0.307084 | Image2Text Acc: 89.84 | Text2Image Acc: 87.89 | Data Time: 0.031s | Batch Time: 0.916s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:55:32 | INFO | Rank 0 | Global Steps: 4060/9780 | Train Epoch: 5 [37888/250368 (15%)] | Loss: 0.210484 | Image2Text Acc: 93.75 | Text2Image Acc: 91.80 | Data Time: 0.030s | Batch Time: 0.912s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:55:41 | INFO | Rank 0 | Global Steps: 4070/9780 | Train Epoch: 5 [40448/250368 (16%)] | Loss: 0.247457 | Image2Text Acc: 90.23 | Text2Image Acc: 91.02 | Data Time: 0.033s | Batch Time: 0.910s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:55:50 | INFO | Rank 0 | Global Steps: 4080/9780 | Train Epoch: 5 [43008/250368 (17%)] | Loss: 0.334452 | Image2Text Acc: 86.72 | Text2Image Acc: 89.06 | Data Time: 0.037s | Batch Time: 0.917s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:55:59 | INFO | Rank 0 | Global Steps: 4090/9780 | Train Epoch: 5 [45568/250368 (18%)] | Loss: 0.285145 | Image2Text Acc: 88.67 | Text2Image Acc: 89.84 | Data Time: 0.032s | Batch Time: 0.916s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:56:09 | INFO | Rank 3 | Begin to eval on validation set (epoch 5 @ 4100 steps)...
2024-06-01,23:56:09 | INFO | Rank 1 | Begin to eval on validation set (epoch 5 @ 4100 steps)...
2024-06-01,23:56:09 | INFO | Rank 2 | Begin to eval on validation set (epoch 5 @ 4100 steps)...
2024-06-01,23:56:09 | INFO | Rank 0 | Global Steps: 4100/9780 | Train Epoch: 5 [48128/250368 (19%)] | Loss: 0.369691 | Image2Text Acc: 87.50 | Text2Image Acc: 87.50 | Data Time: 0.036s | Batch Time: 0.921s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:56:09 | INFO | Rank 0 | Begin to eval on validation set (epoch 5 @ 4100 steps)...
2024-06-01,23:58:34 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-01,23:58:34 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-01,23:58:34 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-01,23:58:34 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-01,23:59:04 | INFO | Rank 3 | Validation Result (epoch 5 @ 4100 steps) | Valid Loss: 0.192079 | Image2Text Acc: 94.48 | Text2Image Acc: 94.04 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:59:04 | INFO | Rank 1 | Validation Result (epoch 5 @ 4100 steps) | Valid Loss: 0.192079 | Image2Text Acc: 94.48 | Text2Image Acc: 94.04 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:59:04 | INFO | Rank 2 | Validation Result (epoch 5 @ 4100 steps) | Valid Loss: 0.192079 | Image2Text Acc: 94.48 | Text2Image Acc: 94.04 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-01,23:59:04 | INFO | Rank 0 | Validation Result (epoch 5 @ 4100 steps) | Valid Loss: 0.192079 | Image2Text Acc: 94.48 | Text2Image Acc: 94.04 | logit_scale: 4.605 | Valid Batch Size: 64
0.1920793503522873 0.17912136018276215
0.1920793503522873 0.17912136018276215
0.1920793503522873 0.17912136018276215
0.1920793503522873 0.17912136018276215
2024-06-01,23:59:13 | INFO | Rank 0 | Global Steps: 4110/9780 | Train Epoch: 5 [50688/250368 (20%)] | Loss: 0.308741 | Image2Text Acc: 89.06 | Text2Image Acc: 89.84 | Data Time: 0.034s | Batch Time: 0.917s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:59:22 | INFO | Rank 0 | Global Steps: 4120/9780 | Train Epoch: 5 [53248/250368 (21%)] | Loss: 0.288970 | Image2Text Acc: 91.41 | Text2Image Acc: 89.84 | Data Time: 0.027s | Batch Time: 0.903s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:59:32 | INFO | Rank 0 | Global Steps: 4130/9780 | Train Epoch: 5 [55808/250368 (22%)] | Loss: 0.353859 | Image2Text Acc: 87.11 | Text2Image Acc: 87.50 | Data Time: 0.028s | Batch Time: 0.908s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:59:41 | INFO | Rank 0 | Global Steps: 4140/9780 | Train Epoch: 5 [58368/250368 (23%)] | Loss: 0.296219 | Image2Text Acc: 90.23 | Text2Image Acc: 90.23 | Data Time: 0.029s | Batch Time: 0.910s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:59:50 | INFO | Rank 0 | Global Steps: 4150/9780 | Train Epoch: 5 [60928/250368 (24%)] | Loss: 0.332266 | Image2Text Acc: 89.06 | Text2Image Acc: 90.23 | Data Time: 0.031s | Batch Time: 0.916s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-01,23:59:59 | INFO | Rank 0 | Global Steps: 4160/9780 | Train Epoch: 5 [63488/250368 (25%)] | Loss: 0.281086 | Image2Text Acc: 91.02 | Text2Image Acc: 89.06 | Data Time: 0.030s | Batch Time: 0.904s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:00:08 | INFO | Rank 0 | Global Steps: 4170/9780 | Train Epoch: 5 [66048/250368 (26%)] | Loss: 0.224366 | Image2Text Acc: 92.58 | Text2Image Acc: 93.75 | Data Time: 0.030s | Batch Time: 0.914s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:00:17 | INFO | Rank 0 | Global Steps: 4180/9780 | Train Epoch: 5 [68608/250368 (27%)] | Loss: 0.282230 | Image2Text Acc: 91.80 | Text2Image Acc: 87.50 | Data Time: 0.027s | Batch Time: 0.907s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:00:26 | INFO | Rank 0 | Global Steps: 4190/9780 | Train Epoch: 5 [71168/250368 (28%)] | Loss: 0.266217 | Image2Text Acc: 90.62 | Text2Image Acc: 91.80 | Data Time: 0.027s | Batch Time: 0.918s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:00:35 | INFO | Rank 1 | Begin to eval on validation set (epoch 5 @ 4200 steps)...
2024-06-02,00:00:35 | INFO | Rank 2 | Begin to eval on validation set (epoch 5 @ 4200 steps)...
2024-06-02,00:00:35 | INFO | Rank 3 | Begin to eval on validation set (epoch 5 @ 4200 steps)...
2024-06-02,00:00:35 | INFO | Rank 0 | Global Steps: 4200/9780 | Train Epoch: 5 [73728/250368 (29%)] | Loss: 0.266151 | Image2Text Acc: 92.19 | Text2Image Acc: 89.84 | Data Time: 0.033s | Batch Time: 0.909s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:00:35 | INFO | Rank 0 | Begin to eval on validation set (epoch 5 @ 4200 steps)...
2024-06-02,00:03:01 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-02,00:03:01 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-02,00:03:01 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-02,00:03:01 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-02,00:03:31 | INFO | Rank 1 | Validation Result (epoch 5 @ 4200 steps) | Valid Loss: 0.192138 | Image2Text Acc: 94.48 | Text2Image Acc: 94.04 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-02,00:03:31 | INFO | Rank 3 | Validation Result (epoch 5 @ 4200 steps) | Valid Loss: 0.192138 | Image2Text Acc: 94.48 | Text2Image Acc: 94.04 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-02,00:03:31 | INFO | Rank 2 | Validation Result (epoch 5 @ 4200 steps) | Valid Loss: 0.192138 | Image2Text Acc: 94.48 | Text2Image Acc: 94.04 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-02,00:03:31 | INFO | Rank 0 | Validation Result (epoch 5 @ 4200 steps) | Valid Loss: 0.192138 | Image2Text Acc: 94.48 | Text2Image Acc: 94.04 | logit_scale: 4.605 | Valid Batch Size: 64
0.19213755428791046 0.17912136018276215
0.19213755428791046 0.17912136018276215
0.19213755428791046 0.17912136018276215
0.19213755428791046 0.17912136018276215
2024-06-02,00:03:40 | INFO | Rank 0 | Global Steps: 4210/9780 | Train Epoch: 5 [76288/250368 (30%)] | Loss: 0.260223 | Image2Text Acc: 91.80 | Text2Image Acc: 89.06 | Data Time: 0.031s | Batch Time: 0.909s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:03:50 | INFO | Rank 0 | Global Steps: 4220/9780 | Train Epoch: 5 [78848/250368 (31%)] | Loss: 0.365574 | Image2Text Acc: 87.50 | Text2Image Acc: 87.89 | Data Time: 0.029s | Batch Time: 0.919s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:03:59 | INFO | Rank 0 | Global Steps: 4230/9780 | Train Epoch: 5 [81408/250368 (33%)] | Loss: 0.307073 | Image2Text Acc: 89.45 | Text2Image Acc: 89.45 | Data Time: 0.032s | Batch Time: 0.905s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:04:08 | INFO | Rank 0 | Global Steps: 4240/9780 | Train Epoch: 5 [83968/250368 (34%)] | Loss: 0.317608 | Image2Text Acc: 90.23 | Text2Image Acc: 89.84 | Data Time: 0.027s | Batch Time: 0.901s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:04:17 | INFO | Rank 0 | Global Steps: 4250/9780 | Train Epoch: 5 [86528/250368 (35%)] | Loss: 0.270278 | Image2Text Acc: 90.23 | Text2Image Acc: 91.80 | Data Time: 0.030s | Batch Time: 0.905s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:04:26 | INFO | Rank 0 | Global Steps: 4260/9780 | Train Epoch: 5 [89088/250368 (36%)] | Loss: 0.314134 | Image2Text Acc: 90.23 | Text2Image Acc: 87.50 | Data Time: 0.026s | Batch Time: 0.909s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:04:35 | INFO | Rank 0 | Global Steps: 4270/9780 | Train Epoch: 5 [91648/250368 (37%)] | Loss: 0.289997 | Image2Text Acc: 89.45 | Text2Image Acc: 89.06 | Data Time: 0.031s | Batch Time: 0.915s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:04:44 | INFO | Rank 0 | Global Steps: 4280/9780 | Train Epoch: 5 [94208/250368 (38%)] | Loss: 0.361600 | Image2Text Acc: 87.50 | Text2Image Acc: 89.06 | Data Time: 0.030s | Batch Time: 0.906s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:04:54 | INFO | Rank 0 | Global Steps: 4290/9780 | Train Epoch: 5 [96768/250368 (39%)] | Loss: 0.317416 | Image2Text Acc: 89.45 | Text2Image Acc: 90.62 | Data Time: 0.031s | Batch Time: 0.913s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:05:03 | INFO | Rank 2 | Begin to eval on validation set (epoch 5 @ 4300 steps)...
2024-06-02,00:05:03 | INFO | Rank 3 | Begin to eval on validation set (epoch 5 @ 4300 steps)...
2024-06-02,00:05:03 | INFO | Rank 1 | Begin to eval on validation set (epoch 5 @ 4300 steps)...
2024-06-02,00:05:03 | INFO | Rank 0 | Global Steps: 4300/9780 | Train Epoch: 5 [99328/250368 (40%)] | Loss: 0.337905 | Image2Text Acc: 88.67 | Text2Image Acc: 89.84 | Data Time: 0.031s | Batch Time: 0.904s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:05:03 | INFO | Rank 0 | Begin to eval on validation set (epoch 5 @ 4300 steps)...
2024-06-02,00:07:28 | INFO | Rank 2 | Evaluated 100/120 batches...
2024-06-02,00:07:28 | INFO | Rank 1 | Evaluated 100/120 batches...
2024-06-02,00:07:28 | INFO | Rank 0 | Evaluated 100/120 batches...
2024-06-02,00:07:29 | INFO | Rank 3 | Evaluated 100/120 batches...
2024-06-02,00:07:58 | INFO | Rank 3 | Validation Result (epoch 5 @ 4300 steps) | Valid Loss: 0.192627 | Image2Text Acc: 94.42 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-02,00:07:58 | INFO | Rank 2 | Validation Result (epoch 5 @ 4300 steps) | Valid Loss: 0.192627 | Image2Text Acc: 94.42 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-02,00:07:58 | INFO | Rank 1 | Validation Result (epoch 5 @ 4300 steps) | Valid Loss: 0.192627 | Image2Text Acc: 94.42 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
2024-06-02,00:07:58 | INFO | Rank 0 | Validation Result (epoch 5 @ 4300 steps) | Valid Loss: 0.192627 | Image2Text Acc: 94.42 | Text2Image Acc: 94.02 | logit_scale: 4.605 | Valid Batch Size: 64
0.19262667000293732 0.17912136018276215
0.19262667000293732 0.17912136018276215
0.19262667000293732 0.17912136018276215
0.19262667000293732 0.17912136018276215
2024-06-02,00:08:08 | INFO | Rank 0 | Global Steps: 4310/9780 | Train Epoch: 5 [101888/250368 (41%)] | Loss: 0.316873 | Image2Text Acc: 89.45 | Text2Image Acc: 89.84 | Data Time: 0.033s | Batch Time: 0.914s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:08:17 | INFO | Rank 0 | Global Steps: 4320/9780 | Train Epoch: 5 [104448/250368 (42%)] | Loss: 0.343146 | Image2Text Acc: 91.02 | Text2Image Acc: 87.89 | Data Time: 0.027s | Batch Time: 0.903s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:08:26 | INFO | Rank 0 | Global Steps: 4330/9780 | Train Epoch: 5 [107008/250368 (43%)] | Loss: 0.327068 | Image2Text Acc: 91.02 | Text2Image Acc: 87.50 | Data Time: 0.031s | Batch Time: 0.910s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:08:35 | INFO | Rank 0 | Global Steps: 4340/9780 | Train Epoch: 5 [109568/250368 (44%)] | Loss: 0.337982 | Image2Text Acc: 89.45 | Text2Image Acc: 89.84 | Data Time: 0.030s | Batch Time: 0.911s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:08:44 | INFO | Rank 0 | Global Steps: 4350/9780 | Train Epoch: 5 [112128/250368 (45%)] | Loss: 0.203983 | Image2Text Acc: 93.36 | Text2Image Acc: 92.19 | Data Time: 0.033s | Batch Time: 0.914s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:08:53 | INFO | Rank 0 | Global Steps: 4360/9780 | Train Epoch: 5 [114688/250368 (46%)] | Loss: 0.285392 | Image2Text Acc: 90.62 | Text2Image Acc: 89.84 | Data Time: 0.029s | Batch Time: 0.918s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:09:03 | INFO | Rank 0 | Global Steps: 4370/9780 | Train Epoch: 5 [117248/250368 (47%)] | Loss: 0.337174 | Image2Text Acc: 89.45 | Text2Image Acc: 89.84 | Data Time: 0.033s | Batch Time: 0.910s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:09:12 | INFO | Rank 0 | Global Steps: 4380/9780 | Train Epoch: 5 [119808/250368 (48%)] | Loss: 0.283026 | Image2Text Acc: 93.36 | Text2Image Acc: 90.23 | Data Time: 0.030s | Batch Time: 0.921s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:09:21 | INFO | Rank 0 | Global Steps: 4390/9780 | Train Epoch: 5 [122368/250368 (49%)] | Loss: 0.336539 | Image2Text Acc: 88.67 | Text2Image Acc: 88.28 | Data Time: 0.033s | Batch Time: 0.906s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:09:30 | INFO | Rank 3 | Begin to eval on validation set (epoch 5 @ 4400 steps)...
2024-06-02,00:09:30 | INFO | Rank 1 | Begin to eval on validation set (epoch 5 @ 4400 steps)...
2024-06-02,00:09:30 | INFO | Rank 2 | Begin to eval on validation set (epoch 5 @ 4400 steps)...
2024-06-02,00:09:30 | INFO | Rank 0 | Global Steps: 4400/9780 | Train Epoch: 5 [124928/250368 (50%)] | Loss: 0.438245 | Image2Text Acc: 86.33 | Text2Image Acc: 85.55 | Data Time: 0.027s | Batch Time: 0.914s | LR: 0.000001 | logit_scale: 4.605 | Global Batch Size: 256
2024-06-02,00:09:30 | INFO | Rank 0 | Begin to eval on validation set (epoch 5 @ 4400 steps)...
srun: forcing job termination
srun: Job step aborted: Waiting up to 2 seconds for job step to finish.
srun: Easily find out why your job was killed by following the link below:
	https://docs.phoenix.sensetime.com/FAQ/SlurmFAQ/Find-out-why-my-job-was-killed/
slurmstepd: error: *** STEP 3522769.0 ON SH-IDC1-10-140-24-30 CANCELLED AT 2024-06-02T00:09:49 ***
srun: error: Timed out waiting for job step to complete
